function vgseStripHtml(e){return(new DOMParser).parseFromString(e,"text/html").body.textContent||""}function vgseRange(e,t){for(var o=[],a=e;a<=t;a++)o.push(a);return o}function vgseIsInViewport(e){var t=e.offset().top,o=(e.outerHeight(),jQuery(window).scrollTop()),a=o+jQuery(window).height();return o<t&&t<a}function vgseCountMatchingElements(e,t){var o=0;for(i=0;i<e.length;i++)-1!=t.indexOf(e[i])&&o++;return o}function vgseGetPostTypeColumnsOptions(i,d,e,l){var u=l?{}:[];return vgse_editor_settings?(jQuery.each(vgse_editor_settings.final_spreadsheet_columns_settings,function(e,t){if(vgse_editor_settings.exclude_non_visible_columns_from_tools&&void 0===vgse_editor_settings.columnsFormat[e])return!0;var o=!0;for(var a in i)if(Object.hasOwnProperty.call(i,a)&&i[a]!==t[a]){o=!1;break}if(o){var n=d?t.title+" ($"+e+"$)":t.title,r=d?"$"+e+"$":e;if(l)u[r]=n;else{var s=jQuery("<option />").attr({value:r,"data-value-type":t.value_type||"text"}).text(n);u.push(s.prop("outerHTML"))}}}),e?u.join(""):u):u}function vgseEscapeHTML(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(/[&<>"']/g,function(e){return t[e]})}function vgseToggleFullScreen(e){if("number"!=typeof e)e="block"===jQuery(".wpse-full-screen-notice-content.notice-on").css("display")||jQuery(window).scrollLeft()>jQuery("#adminmenuwrap").width();e?(jQuery(".wpse-full-screen-notice-content.notice-on").hide(),jQuery(".wpse-full-screen-notice-content.notice-off").show(),jQuery("html").removeClass("wpse-full-screen"),jQuery("html,body").scrollTop(0),jQuery("html,body").scrollLeft(0)):(jQuery(".wpse-full-screen-notice-content.notice-on").show(),jQuery(".wpse-full-screen-notice-content.notice-off").hide(),jQuery("html").addClass("wpse-full-screen"))}function vgseFormatDate(){var e=new Date,t=""+(e.getMonth()+1),o=""+e.getDate(),a=e.getFullYear();return t.length<2&&(t="0"+t),o.length<2&&(o="0"+o),[a,t,o].join("-")}function vgseGuidGenerator(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function vgseCustomTooltip(e,t,o,a,n){o=o||"down",e.attr({"data-wpse-tooltip":o,"aria-label":t,"data-wpse-visible":1,"data-wpse-tooltip-type":n}),e.on("hover",function(){e.removeAttr("data-wpse-visible")}),setTimeout(function(){a||e.removeAttr("data-wpse-tooltip"),e.removeAttr("data-wpse-visible")},8e3)}function vgseCleanObject(e){for(var t in e)e[t]||delete e[t]}function beParseParamsOld(e){for(var t={},o=e.split("&"),a=0;a<o.length;a++){var n=o[a].split("=");if(n[0]=decodeURIComponent(n[0]),void 0!==t[n[0]]&&vgseEndsWith(n[0],"[]"))if("string"==typeof t[n[0]]&&vgseEndsWith(n[0],"[]")){var r=[t[n[0]],n[1]];t[n[0]]=r}else t[n[0]].push(n[1]);else t[n[0]]=n[1]}return t}function beParseParams(e){e=e.substring(e.indexOf("?")+1);for(var t,o=/([^&=]+)=?([^&]*)/g,a=/\+/g,n=function(e){return decodeURIComponent(e.replace(a," "))},r={};t=o.exec(e);){var s=n(t[1]),i=n(t[2]);"[]"===s.substring(s.length-2)?(r[s=s.substring(0,s.length-2)]||(r[s]=[])).push(i):r[s]=i}var d=function(e,t,o){for(var a=t.length-1,n=0;n<a;++n){var r=t[n];r in e||(e[r]={}),e=e[r]}e[t[a]]=o};for(var l in r){var u=l.split("[");if(1<u.length){var c=[];u.forEach(function(e,t){var o=e.replace(/[?[\]\\ ]/g,"");c.push(o)}),d(r,c,r[l]),delete r[l]}}return r}function beGetRowsFilters(){return jQuery("body").data("be-filters")?jQuery.param(jQuery("body").data("be-filters")):""}function vgseEndsWith(e,t){return-1!==e.indexOf(t,e.length-t.length)}function vgseMergeDeep(e){var r=function(e){return e&&"object"==typeof e};return e.reduce(function(a,n){return Object.keys(n).forEach(function(e){var t=a[e],o=n[e];Array.isArray(t)&&Array.isArray(o)?a[e]=t.concat([o]):r(t)&&r(o)?a[e]=vgseMergeDeep([t,o]):a[e]=o}),a},{})}function vgseGoToModal(e){var t=jQuery(".remodal-is-opened > .remodal");t.length?(t.one("closed",function(){jQuery('[data-remodal-id="'+e+'"]').remodal().open()}),t.remodal().close()):jQuery('[data-remodal-id="'+e+'"]').remodal().open()}function vgseDecodeURIComponentSafe(e){return e?decodeURIComponent(e.replace(/%(?![0-9][0-9a-fA-F]+)/g,"%25")):e}function beAddRowsFilter(e){if(!e)return!1;var t=jQuery("body").data("be-filters");t=t||{};var o="string"==typeof e?beParseParams(e):e,a=vgseMergeDeep([t,o]);vgseCleanObject(a);var n=jQuery(".vgse-current-filters");return n.find(".button").remove(),n.each(function(){var d=jQuery(this);jQuery.each(a,function(e,t){if(t&&e.indexOf("meta_query")<0){var o="string"==typeof t?t:t.join(", ");20<(o=vgseDecodeURIComponentSafe(vgseStripHtml(o))).length&&(o=o.substring(0,20)+"...");var a=e.replace("[]","").replace(/_/g," ");d.append('<a href="#" class="button" data-filter-key="'+e+'"><i class="fa fa-remove"></i> '+a+": "+o+"</a>")}}),a.meta_query&&jQuery.each(a.meta_query,function(e,t){var o=t.key;if(o){var a="meta_query",n=t.value,r=t.compare;20<(n=vgseDecodeURIComponentSafe(vgseStripHtml(n))).length&&(n=n.substring(0,20)+"...");a="meta_query["+e+"][key]";d.find(".advanced-filter").filter(function(){return jQuery(this).data("filter-key")===a}).remove(),d.append('<a href="#" class="button advanced-filter" data-filter-key="'+a+'"><i class="fa fa-remove"></i> '+o+" "+r+" "+n+"</a>")}}),jQuery(".advanced-filters-list > li").each(function(){var e=jQuery(this),t=e.find(".wpse-advanced-filters-field-selector"),o=t.val();if(o){var a=t.attr("name"),n=e.find(".wpse-advanced-filters-value-selector").val(),r=e.find(".wpse-advanced-filters-operator-selector option:selected"),s=r.data("custom-label")||r.text();"ANY"===s&&(n=n.replace(";"," OR ").replace("  "," "));var i="string"==typeof n?n:n.join(", ");20<(i=vgseDecodeURIComponentSafe(vgseStripHtml(i))).length&&(i=i.substring(0,20)+"..."),d.find(".advanced-filter").filter(function(){return jQuery(this).data("filter-key")===a}).remove(),d.append('<a href="#" class="button advanced-filter" data-filter-key="'+a+'"><i class="fa fa-remove"></i> '+o+" "+s+" "+i+"</a>")}}),d.find(".button").length?d.css("display","inline-block"):d.hide()}),1<n.find(".button").length?n.append('<a href="#" class="button advanced-filter remove-all-filters"><i class="fa fa-remove"></i> '+vgse_editor_settings.texts.remove_all_filters+"</a>"):n.find(".remove-all-filters").remove(),jQuery("body").data("be-filters",a),a}function beAjaxLoop(e){var t={totalCalls:null,current:1,url:"",method:"GET",dataType:"json",data:{},prepareData:function(e,t){return e},onSuccess:function(e,t){},onError:function(e,t,o){},status:"running"},n=jQuery.extend(t,e);function r(){if(n.current<n.totalCalls+1){if("running"!==n.status)return!0;if(Array.isArray(n.data)){var o=!1,a=!1;n.data.forEach(function(e,t){"page"===e.name&&(n.data[t].value=n.current,o=!0),"totalCalls"===e.name&&(n.data[t].value=n.totalCalls,a=!0)}),o||n.data.push({name:"page",value:n.current}),a||n.data.push({name:"totalCalls",value:n.totalCalls})}else n.data.page=n.current,n.data.totalCalls=n.totalCalls;var e={url:n.url,dataType:n.dataType,data:n.prepareData(n.data,n),method:n.method};jQuery.ajax(e).done(function(e){n.onSuccess(e,n)&&(n.current++,setTimeout(function(){r()},1e3*parseInt(vgse_editor_settings.wait_between_batches)))}).fail(function(e,t){n.onError(e,t,n)&&(n.current++,setTimeout(function(){r()},1e3*parseInt(vgse_editor_settings.wait_between_batches)))})}}return r(),{pause:function(){n.status="paused"},resume:function(){n.status="running",r()}}}function loading_ajax(e){"boolean"==typeof e&&(e={estado:e});var t={estado:!0};jQuery.extend(t,e),1==t.estado?(jQuery("body").find(".sombra_popup").length||jQuery("body").append('<div class="sombra_popup be-ajax"><div class="sk-three-bounce"><div class="sk-child sk-bounce1"></div><div class="sk-child sk-bounce2"></div><div class="sk-child sk-bounce3"></div></div></div>'),jQuery(".sombra_popup").fadeIn(1e3)):jQuery(".sombra_popup").fadeOut(800,function(){})}function notification(e){var t={tipo:"success",mensaje:"",time:8600,position:"top"};jQuery.extend(t,e),setTimeout(function(){if("success"==t.tipo)var e="green";else if("error"==t.tipo)e="red";else if("warning"==t.tipo)e="orange";else e="blue";"bottom"===t.position?jQuery("#ohsnap").css({top:"auto",bottom:"5px"}):jQuery("#ohsnap").css({top:"",bottom:""}),jQuery("#ohsnap").css("z-index","1100000"),setTimeout(function(){jQuery("#ohsnap").css("z-index","-1")},t.time),jQuery("#ohsnap .alert").remove(),ohSnap(t.mensaje,{duration:t.time,color:e})},500)}function beLoadPosts(o,a,n,r){loading_ajax({estado:!0});var s=setTimeout(function(){jQuery(".wpse-stuck-loading").css("display","block")},5e3);jQuery(".automatic-loading-rows-disabled").remove(),n=n||!0,r=r||!1,o.action="vgse_load_data",o.wpse_source_suffix=vgse_editor_settings.wpse_source_suffix||"",o.paged||(o.paged=1),window.beCurrentPage=o.paged,o.filters=beGetRowsFilters(),window.beLastLoadRowsAjax=jQuery.ajax({url:vgse_editor_settings.ajax_url,dataType:"json",type:"POST",data:o,success:function(e){if(1===window.beCurrentPage&&0===window.location.hash.indexOf("#after_init:")&&(jQuery('[data-remodal-id="'+window.location.hash.replace("#after_init:","")+'"]').remodal().open(),window.location.hash=""),jQuery(".wpse-stuck-loading").hide(),clearTimeout(s),e.data.pagination&&(jQuery(".pagination-links").empty().append(e.data.pagination),jQuery(".pagination-jump input").attr("max",e.data.max_pages)),jQuery("#vgse-wrapper").css("min-width",jQuery("#post-data .wtHider").width()),jQuery("body").trigger("vgSheetEditor:beforeRowsInsert",[e,o,a,n,r]),"function"==typeof a&&(a(e),n))return!0;if(e.success){vgseAddFoundRowsCount(e.data.total),vgAddRowsToSheet(e.data.rows,null,r);var t=e.data.message||vgse_editor_settings.texts.posts_loaded;notification({mensaje:t,tipo:"info"}),loading_ajax({estado:!1})}else loading_ajax({estado:!1}),notification({mensaje:e.data.message,tipo:"info"}),vgseAddFoundRowsCount(0)},error:function(e,t){100<=vgse_editor_settings.posts_per_page&&(500<=e.status||"timeout"===t)&&(window.vgseDontNotifyServerError=!0,vgse_editor_settings.posts_per_page=10,o.wpse_reset_posts_per_page=vgse_editor_settings.posts_per_page,beLoadPosts(o,a,n,r),setTimeout(function(){loading_ajax({estado:!0})},200))}})}function vgseMd5(e){var a="0123456789abcdef";function t(e){var t,o="";for(t=0;t<=3;t++)o+=a.charAt(e>>8*t+4&15)+a.charAt(e>>8*t&15);return o}function s(e,t){var o=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(o>>16)<<16|65535&o}function i(e,t){return e<<t|e>>>32-t}function d(e,t,o,a,n,r){return s(i(s(s(t,e),s(a,r)),n),o)}function o(e,t,o,a,n,r,s){return d(t&o|~t&a,e,t,n,r,s)}function n(e,t,o,a,n,r,s){return d(t&a|o&~a,e,t,n,r,s)}function r(e,t,o,a,n,r,s){return d(t^o^a,e,t,n,r,s)}function l(e,t,o,a,n,r,s){return d(o^(t|~a),e,t,n,r,s)}function u(e){var t,o=1+(e.length+8>>6),a=new Array(16*o);for(t=0;t<16*o;t++)a[t]=0;for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<t%4*8;return a[t>>2]|=128<<t%4*8,a[16*o-2]=8*e.length,a}var c,p,g,f,y,m=u(e),h=1732584193,v=-271733879,_=-1732584194,w=271733878;for(c=0;c<m.length;c+=16)v=l(v=l(v=l(v=l(v=r(v=r(v=r(v=r(v=n(v=n(v=n(v=n(v=o(v=o(v=o(v=o(g=v,_=o(f=_,w=o(y=w,h=o(p=h,v,_,w,m[c+0],7,-680876936),v,_,m[c+1],12,-389564586),h,v,m[c+2],17,606105819),w,h,m[c+3],22,-1044525330),_=o(_,w=o(w,h=o(h,v,_,w,m[c+4],7,-176418897),v,_,m[c+5],12,1200080426),h,v,m[c+6],17,-1473231341),w,h,m[c+7],22,-45705983),_=o(_,w=o(w,h=o(h,v,_,w,m[c+8],7,1770035416),v,_,m[c+9],12,-1958414417),h,v,m[c+10],17,-42063),w,h,m[c+11],22,-1990404162),_=o(_,w=o(w,h=o(h,v,_,w,m[c+12],7,1804603682),v,_,m[c+13],12,-40341101),h,v,m[c+14],17,-1502002290),w,h,m[c+15],22,1236535329),_=n(_,w=n(w,h=n(h,v,_,w,m[c+1],5,-165796510),v,_,m[c+6],9,-1069501632),h,v,m[c+11],14,643717713),w,h,m[c+0],20,-373897302),_=n(_,w=n(w,h=n(h,v,_,w,m[c+5],5,-701558691),v,_,m[c+10],9,38016083),h,v,m[c+15],14,-660478335),w,h,m[c+4],20,-405537848),_=n(_,w=n(w,h=n(h,v,_,w,m[c+9],5,568446438),v,_,m[c+14],9,-1019803690),h,v,m[c+3],14,-187363961),w,h,m[c+8],20,1163531501),_=n(_,w=n(w,h=n(h,v,_,w,m[c+13],5,-1444681467),v,_,m[c+2],9,-51403784),h,v,m[c+7],14,1735328473),w,h,m[c+12],20,-1926607734),_=r(_,w=r(w,h=r(h,v,_,w,m[c+5],4,-378558),v,_,m[c+8],11,-2022574463),h,v,m[c+11],16,1839030562),w,h,m[c+14],23,-35309556),_=r(_,w=r(w,h=r(h,v,_,w,m[c+1],4,-1530992060),v,_,m[c+4],11,1272893353),h,v,m[c+7],16,-155497632),w,h,m[c+10],23,-1094730640),_=r(_,w=r(w,h=r(h,v,_,w,m[c+13],4,681279174),v,_,m[c+0],11,-358537222),h,v,m[c+3],16,-722521979),w,h,m[c+6],23,76029189),_=r(_,w=r(w,h=r(h,v,_,w,m[c+9],4,-640364487),v,_,m[c+12],11,-421815835),h,v,m[c+15],16,530742520),w,h,m[c+2],23,-995338651),_=l(_,w=l(w,h=l(h,v,_,w,m[c+0],6,-198630844),v,_,m[c+7],10,1126891415),h,v,m[c+14],15,-1416354905),w,h,m[c+5],21,-57434055),_=l(_,w=l(w,h=l(h,v,_,w,m[c+12],6,1700485571),v,_,m[c+3],10,-1894986606),h,v,m[c+10],15,-1051523),w,h,m[c+1],21,-2054922799),_=l(_,w=l(w,h=l(h,v,_,w,m[c+8],6,1873313359),v,_,m[c+15],10,-30611744),h,v,m[c+6],15,-1560198380),w,h,m[c+13],21,1309151649),_=l(_,w=l(w,h=l(h,v,_,w,m[c+4],6,-145523070),v,_,m[c+11],10,-1120210379),h,v,m[c+2],15,718787259),w,h,m[c+9],21,-343485551),h=s(h,p),v=s(v,g),_=s(_,f),w=s(w,y);return t(h)+t(v)+t(_)+t(w)}function vgseGetFiltersJson(){return jQuery("body").data("be-filters")?JSON.stringify(jQuery("body").data("be-filters")):""}function beSetSaveButtonStatus(e){var t=jQuery(".button-container.auto_saving_status-container a"),o=jQuery("#vg-header-toolbar .wpse-save, #vg-header-toolbar .wpse-save-later");e?(vgseAllowToClosePageWithoutWarning(!1),o.each(function(){jQuery(this).attr("data-remodal-target",jQuery(this).data("original-remodal-target"))}),o.removeClass("disabled"),jQuery(".wpse-disable-if-unsaved-changes").each(function(){jQuery(this).addClass("disabled"),jQuery(this).attr("data-remodal-target-original",jQuery(this).attr("data-remodal-target")),jQuery(this).removeAttr("data-remodal-target")}),vgse_editor_settings.enable_auto_saving&&t.text(t.data("unsaved-changes"))):(vgseAllowToClosePageWithoutWarning(!0),o.each(function(){jQuery(this).attr("data-original-remodal-target",jQuery(this).data("remodal-target")),jQuery(this).removeAttr("data-remodal-target")}),o.addClass("disabled"),jQuery(".wpse-disable-if-unsaved-changes").each(function(){jQuery(this).removeClass("disabled"),jQuery(this).attr("data-remodal-target",jQuery(this).attr("data-remodal-target-original"))}),vgse_editor_settings.enable_auto_saving&&t.text(t.data("saved-changes")))}function beDeduplicateItems(e){if(!e||!e.length)return e;var a={},n=e[0]instanceof Array?"array":"object";return jQuery.each(e,function(e,t){var o="array"===n?t[0]:t.ID;"string"==typeof o&&(o=parseInt(o)),a[o]||(a[o]=t)}),a}function beGetModifiedObjectProperties(t,o){var a={};return Object.keys(o).forEach(function(e){"0"===e||"wpseBulkSelector"===e||t&&void 0!==t[e]&&o[e]==t[e]||(a[e]=o[e])}),a}function beArraysIdenticalCheck(e,t){if(e.length!==t.length)return!1;for(var o=e.length;o--;)if(e[o]!==t[o])return!1;return!0}function beGetModifiedItems(n,r){if(!n)n=hot.getSourceData();if(!r)r=window.beOriginalData;n=beDeduplicateItems(n),r=beDeduplicateItems(r);var s=[];return jQuery.each(n,function(e,t){var o,a=beGetModifiedObjectProperties(r[e],n[e]);void 0!==r[e]&&jQuery.isEmptyObject(a)||(o=!r[e]||r[e].provider&&vgse_editor_settings.saveFullRowPostTypes&&-1<vgse_editor_settings.saveFullRowPostTypes.indexOf(r[e].provider)?n[e]:(a.ID=e,a),s.push(o))}),s}function beGetTinymceContent(){if("none"!==jQuery(".wp-editor-area").css("display"))var e=jQuery(".wp-editor-area").val()||"";else if(document.getElementById("editpost_ifr"))e=(document.getElementById("editpost_ifr").contentWindow.document||document.getElementById("editpost_ifr").contentDocument).body.innerHTML;else e="";return e}function vgseExecuteFunctionByName(e,t){e=e.trim();for(var o=[].slice.call(arguments).splice(2),a=e.split("."),n=a.pop(),r=0;r<a.length;r++)t=t[a[r]];return t[n].apply(t,o)}function vgObjectToArray(e){var t=[];for(var o in e)t.push(e[o]);return t}function _debounce(t,o,a){var n,r,s,i,d,l=function(){var e=_now()-i;e<o&&0<=e?n=setTimeout(l,o-e):(n=null,a||(d=t.apply(s,r),n||(s=r=null)))};return function(){s=this,r=arguments,i=_now();var e=a&&!n;return n=n||setTimeout(l,o),e&&(d=t.apply(s,r),s=r=null),d}}function _now(){return Date.now()||(new Date).getTime()}function _throttle(o,a,n){var r,s,i;a=a||300;var d=null,l=0;n=n||{};var u=function(){l=!1===n.leading?0:_now(),d=null,i=o.apply(r,s),d||(r=s=null)};return function(){var e=_now();l||!1!==n.leading||(l=e);var t=a-(e-l);return r=this,s=arguments,t<=0||a<t?(d&&(clearTimeout(d),d=null),l=e,i=o.apply(r,s),d||(r=s=null)):d||!1===n.trailing||(d=setTimeout(u,t)),i}}function vgseRemoveRowFromSheetByID(e,t){if(e.length){var o=hot.getSourceData();if(e.forEach(function(e){o=vgseRemoveRowFromArray(e,o)}),hot.loadData(o),t){var a=parseInt(jQuery(".be-total-rows .item-value").text());vgseAddFoundRowsCount(a-e.length)}}}function vgseRemoveRowFromArray(a,e){var n=[];return a=parseInt(a),e.forEach(function(e,t){var o=jQuery.extend(!0,{},e);"string"==typeof o.ID&&(o.ID=parseInt(o.ID)),a!==o.ID&&n.push(e)}),n}function vgAddRowsToSheet(e,t,o){window.beOriginalData||(window.beOriginalData=[]),e=e||[],"prepend"===(t=t||"append")&&(e=e.reverse());var a=hot.getSourceData();o&&e.forEach(function(e,t){var o=jQuery.extend(!0,{},e);o.ID=parseInt(o.ID),a=vgseRemoveRowFromArray(o.ID,a),window.beOriginalData=vgseRemoveRowFromArray(o.ID,window.beOriginalData)});var n=a.map(function(e){return e.ID});for(i=0;i<e.length;i++)n.indexOf(e[i].ID)<0&&("append"===t?a.push(jQuery.extend(!0,{},e[i])):a.unshift(jQuery.extend(!0,{},e[i])));hot.loadData(a),jQuery("body").trigger("vgSheetEditor:afterRowsInsert",[e,t,o]),window.beOriginalData=jQuery.merge(window.beOriginalData,e)}function wpsePrepareGalleryFilesForCellFormat(e,t){var o=hot.colToProp(t.col),a=vgse_editor_settings.final_spreadsheet_columns_settings[o],n=a&&void 0!==a.wp_media_multiple&&a.wp_media_multiple,r=hot.getDataAtCell(t.row,t.col),s=n&&r?r.split(","):[];jQuery.each(e,function(e,t){s.push(t.url+"?wpId="+t.id)}),hot.setDataAtCell(t.row,t.col,s.join(","))}function vgseInitSelect2(e){if(!e)e=jQuery("select.select2");e.each(function(){var e={placeholder:jQuery(this).data("placeholder"),minimumInputLength:jQuery(this).data("min-input-length")||0,allowClear:!0};jQuery(this).data("remote")&&(e.ajax={url:vgse_editor_settings.ajax_url,delay:1e3,data:function(e){return{search:e.term,page:e.page,action:jQuery(this).data("action"),global_search:jQuery(this).data("global-search")||"",output_format:jQuery(this).data("output-format"),taxonomies:jQuery(this).data("taxonomies"),post_type:jQuery(this).data("post-type")||jQuery("#post-data").data("post-type"),nonce:jQuery("#vgse-wrapper").data("nonce")}},processResults:function(e){return e.success?{results:e.data.data}:{results:[]}},cache:!0}),jQuery(this).select2(e)})}function vgseReloadSpreadsheet(e,t,o){if(e){t=t||vgse_editor_settings.texts.save_changes_reload_optional;var a=hot.getSourceData();if((a=beGetModifiedItems(a,window.beOriginalData)).length)return alert(t),!0}var n=jQuery(".remodal-bg").data("nonce"),r=jQuery("#post-data");window.beOriginalData=[],hot.loadData([]),beLoadPosts({post_type:r.data("post-type"),nonce:n,paged:o||1})}function vgseAddFoundRowsCount(e){window.beFoundRows=e,jQuery(".be-total-rows .item-value").text(e),window.wpseUpdateBulkEditRowsCount&&(jQuery(".modal-formula .rows-to-be-updated-total span").text(e),window.wpseUpdateBulkEditRowsCount=!1)}function vgseGetRowTitle(e){var t=window.vgseFormulasBulkSelectorExists?2:1;return vgse_editor_settings.is_post_type?hot.getDataAtRowProp(e,"post_title"):hot.getDataAtCell(e,t)}function vgseInputToFormattedColumnField(s,i,e){if(void 0!==vgse_editor_settings.final_spreadsheet_columns_settings[s]){var n=vgse_editor_settings.final_spreadsheet_columns_settings[s],t=i.find(e),o=t.attr("name"),a=t.attr("class");if(!t.is("input")&&!t.is("textarea")||t.attr("type")&&"text"!==t.attr("type"))return!0;if(void 0!==n.formatted.editor&&"select"===n.formatted.editor)t.replaceWith('<select class="'+a+'" name="'+o+'"><option value="">('+vgse_editor_settings.texts.empty+")</option></select>"),(r=i.find("select"+e)).each(function(){var o=jQuery(this);jQuery.each(n.formatted.selectOptions,function(e,t){jQuery.isNumeric(e)&&(e=t),o.append('<option value="'+e+'">'+t+"</option>")})});else if(void 0!==n.formatted.type&&"autocomplete"===n.formatted.type&&"string"==typeof n.formatted.source&&"searchUsers"===n.formatted.source)t.replaceWith('<input class="'+a+'" name="'+o+'" list="wpse-bulk-edit-users-list-'+s+'"><datalist class="'+a+'" id="wpse-bulk-edit-users-list-'+s+'"></datalist>'),i.find('input[list="wpse-bulk-edit-users-list-'+s+'"]').keyup(_throttle(function(e){var t=jQuery(this).val();if(!t)return!0;var o=jQuery(this);if(o.data("last-query")===t)return!0;o.data("last-query",t);var a=jQuery(".remodal-bg").data("nonce"),n=vgse_editor_settings.post_type,r=i.find("datalist#wpse-bulk-edit-users-list-"+s);jQuery.ajax({url:vgse_editor_settings.ajax_url,dataType:"json",data:{action:"vgse_find_users_by_keyword",search:t,nonce:a,post_type:n,wpse_source:"users_dropdown_column"},success:function(e){var t=[];e.success&&(t=e.data.data),r.empty(),t.forEach(function(e){r.append('<option value="'+e+'">'+e+"</option>")})}})},1500,{leading:!0,trailing:!0}));else if(void 0!==n.formatted.type&&"autocomplete"===n.formatted.type&&"object"==typeof n.formatted.source){t.replaceWith('<select class="'+a+'" name="'+o+'"><option value="">('+vgse_editor_settings.texts.empty+")</option></select>"),(r=i.find("select"+e)).each(function(){var o=jQuery(this);jQuery.each(n.formatted.source,function(e,t){jQuery.isNumeric(e)&&(e=t),o.append('<option value="'+e+'">'+t+"</option>")})})}else if(void 0!==n.formatted.type&&"checkbox"===n.formatted.type){t.replaceWith('<input type="checkbox" class="'+a+'" name="'+o+'">'),(r=i.find("input"+e+":checkbox")).on("change",function(){jQuery(this).is(":checked")?(jQuery(this).val(n.formatted.checkedTemplate),jQuery(this).data("checked-value",n.formatted.checkedTemplate)):(jQuery(this).val(n.formatted.uncheckedTemplate),jQuery(this).data("unchecked-value",n.formatted.uncheckedTemplate))}),r.trigger("change")}else if(void 0!==n.formatted.type&&"date"===n.formatted.type){var r;t.replaceWith('<input type="date" class="'+a+'">'),(r=i.find("input"+e)).after('<input type="hidden" name="'+o+'" class="wpse-hidden-timestamp '+a+'" />'),r.on("change",function(){var e=jQuery(this).val();if(e){var t=moment.utc(e+" 0:00:00","YYYY-MM-DD H:mm:ss");if(!(o=n.formatted.customDatabaseFormatJs||n.formatted.dateFormatJs))var o=n.formatted.customDatabaseFormat||n.formatted.dateFormat;var a=t.format(o)}else a="";i.find(".wpse-hidden-timestamp").val(a)}),r.trigger("change")}}}function vgseRemoveAllFilters(e){jQuery("body").data("be-filters",{}),jQuery(".vgse-current-filters .button").remove(),e&&vgseReloadSpreadsheet()}function vgseInitLazySelects(){jQuery("select[data-lazy-key]:not([data-already-lazy])").each(function(){vgseLazySelect(jQuery(this),jQuery(this).data("lazy-key"))})}function vgseLazySelect(a,n){if(a.attr("multiple"))return!0;vgse_editor_settings.lazy_loaded_select_options||(vgse_editor_settings.lazy_loaded_select_options={});var e={},t=function(){a.find("option").each(function(){jQuery(this).parent("optgroup").length?(void 0===e[jQuery(this).parent("optgroup").attr("label")]&&(e[jQuery(this).parent("optgroup").attr("label")]={}),e[jQuery(this).parent("optgroup").attr("label")][jQuery(this).val()]=jQuery(this).text()):e[jQuery(this).val()]=jQuery(this).text()}),vgse_editor_settings.lazy_loaded_select_options[n]=e},o=function(){var e=a.find("option:selected");e&&e.parent("optgroup").length&&e.parent("optgroup"),a.find("option").not(e).not(a.find('option[value=""]')).remove(),a.find("optgroup").each(function(){jQuery(this).children().length||jQuery(this).remove()})};vgse_editor_settings.lazy_loaded_select_options&&vgse_editor_settings.lazy_loaded_select_options[n]||t(),a.find("option").length||"string"!=typeof a.data("selected")||a.append('<option value="'+vgseStripHtml(a.data("selected"))+'">'+vgseStripHtml(vgse_editor_settings.lazy_loaded_select_options[n][a.data("selected")])+"</option>"),o(),a.on("focus",function(e){var t=vgse_editor_settings.lazy_loaded_select_options[n];if(t){var o=a.val();a.empty(),jQuery.each(t,function(o,e){"string"==typeof e?a.append('<option value="'+vgseStripHtml(o)+'">'+vgseStripHtml(e)+"</option>"):(a.append('<optgroup label="'+vgseStripHtml(o)+'"></optgroup>'),jQuery.each(e,function(e,t){a.find('optgroup[label="'+vgseStripHtml(o)+'"]').append('<option value="'+vgseStripHtml(e)+'">'+vgseStripHtml(t)+"</option>")}))}),a.val(o)}}),a.on("blur",function(e){o()})}function vgseSetSettings(e,t,o){e.push({name:"nonce",value:jQuery("#vgse-wrapper").data("nonce")}),e.push({name:"action",value:"vgse_set_settings"}),o||loading_ajax(!0),jQuery.ajax({url:ajaxurl,method:"POST",data:e,success:function(e){o||loading_ajax(!1),window.location.hash="",e.success&&t&&window.location.reload()}})}function vgseGetSelectedRowsCount(e){var t=window.beFoundRows;"selected"===e.find(".wpse-select-rows-options").val()&&(t=vgseGetSelectedIds().length);"previously_selected"===e.find(".wpse-select-rows-options").val()&&(t=(window.wpsePreviouslySelectedIds||[]).length);return t}function vgseGetSelectedIds(){var e=hot.getDataAtCol(0),o=[];return e.forEach(function(e,t){e&&o.push(hot.getDataAtRowProp(t,"ID"))}),o}function vgseDeleteRowsById(t){loading_ajax(!0),jQuery.post(vgse_editor_settings.ajax_url,{action:"vgse_delete_row_ids",nonce:jQuery("#vgse-wrapper").data("nonce"),post_type:vgse_editor_settings.post_type,ids:t},function(e){loading_ajax(!1),e.success?(notification({mensaje:e.data.message}),vgseRemoveRowFromSheetByID(t,!0)):notification({mensaje:e.data.message,tipo:"error",tiempo:6e4})})}void 0===Array.prototype.chunk&&Object.defineProperty(Array.prototype,"chunk",{value:function(o){var a=this;return[].concat.apply([],a.map(function(e,t){return t%o?[]:[a.slice(t,t+o)]}))}}),jQuery(document).ajaxError(function(e,t,o,a){loading_ajax({estado:!1}),"boolean"==typeof window.vgseDontNotifyServerError&&window.vgseDontNotifyServerError?window.vgseDontNotifyServerError=!1:"abort"!==t.statusText&&(400==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_400,tipo:"error",tiempo:6e4}):403==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_403,tipo:"error",tiempo:6e4}):500==t.status||502==t.status||505==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_500_502_505,tipo:"error",tiempo:6e4}):503==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_503,tipo:"error",tiempo:6e4}):509==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_509,tipo:"error",tiempo:6e4}):504==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_504,tipo:"error",tiempo:6e4}):notification({mensaje:vgse_editor_settings.texts.http_error_default,tipo:"error",tiempo:6e4}))}),jQuery(document).ajaxComplete(function(e,t,o,a){setTimeout(function(){"abort"!==t.statusText&&window.vgse_editor_settings&&("0"!==t.responseText&&0!==t.responseText&&!a||(loading_ajax({estado:!1}),"boolean"==typeof window.vgseDontNotifyServerError&&window.vgseDontNotifyServerError?window.vgseDontNotifyServerError=!1:notification({mensaje:vgse_editor_settings.texts.http_error_500_502_505,tipo:"error",tiempo:6e4})))},500)}),void 0===window.$&&(window.$=jQuery),jQuery(document).ready(function(e){if(window.wpseHasInitialized)return!0;if(window.wpseHasInitialized=!0,jQuery("body").on("click",".wpse-toggle-head",function(){jQuery(this).next(".wpse-toggle-content").slideToggle()}),!jQuery(".be-spreadsheet-wrapper").length)return!0;var u,h,c,g,l,p,f;window.vgseFormulasBulkSelectorExists=jQuery(".modal-formula").length,function(e){"use strict";var t=e.editors.PasswordEditor.prototype.extend();t.prototype.createElements=function(){e.editors.PasswordEditor.prototype.createElements.apply(this,arguments),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","datetime-local"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,jQuery(this.TEXTAREA_PARENT).empty(),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)},t.prototype.focus=function(){this.TEXTAREA.select()},e.editors.WPDateTimeEditor=t,e.editors.registerEditor("wp_datetime",t)}(Handsontable),(u=Handsontable).renderers.registerRenderer("wp_chosen_dropdown",function(e,t,o,a,n,r,s){var i=s.chosenOptions.data;if(void 0===i||void 0===i.length||!i.length)return u.renderers.TextRenderer.apply(this,arguments),t;var d=(r+"").split(vgse_editor_settings.taxonomy_terms_separator).map(function(e){return e.trim()});r=[];for(var l=0;l<i.length;l++)-1<d.indexOf(i[l].id+"")&&(i[l].id,r.push(i[l].label));return r=r.join(vgse_editor_settings.taxonomy_terms_separator+" "),u.renderers.TextRenderer.apply(this,arguments),t}),(h=Handsontable).renderers.registerRenderer("wp_media_gallery",function(e,t,o,a,n,r,s){h.renderers.BaseRenderer.apply(this,arguments),jQuery("#post-data").data("post-type");var i=vgse_editor_settings.final_spreadsheet_columns_settings[n],d=void 0!==i.wp_media_multiple&&i.wp_media_multiple,l=parseInt(v.getDataAtRowProp(o,"ID")),u=h.helper.stringify(r),c=[],p=[];u.split(",").forEach(function(e){c.push(e.replace(/.+wpId=(\d+)$/,"$1").trim());var t=e.split("/");p.push(t[t.length-1].replace(/(.+)\?wpId=(\d+)$/,"$1").trim())});var g="";if(u&&u.indexOf(",")<0){var f=u.replace(/\?.+/,"").split("."),y=f[f.length-1].toLowerCase();-1<u.indexOf("http")&&-1<["png","jpg","jpeg","gif","webp"].indexOf(y)&&(g+=vgse_editor_settings.media_cell_preview_template.replace("{url}",u))}if(i.formatted.readOnly||(g+='<button class="set_custom_images ',d&&(g+="multiple"),g+=' button" data-type="'+i.data_type+'" data-file="'+c.join(",")+'" data-key="'+n+'" data-id="'+l+'"><i class="fa fa-upload"></i></button>',d&&u&&(g+=' <a href="#image" data-remodal-target="image" class="view_custom_images multiple button" data-type="'+i.data_type+'" data-key="'+n+'" data-id="'+l+'"><i class="fa fa-image"></i></a>')),!vgse_editor_settings.dont_display_file_names_image_columns)if(r){var m=p.join(", ");g+=vgseStripHtml(m.substring(0,40)),40<m.length&&(g+="...")}else g+="("+vgse_editor_settings.texts.empty+")";return i.formatted.readOnly&&(g=(g='<i class="fa fa-lock vg-cell-blocked"></i> '+g).replace(/set_custom_images|view_custom_images/g,"")),t.innerHTML=g,t}),(c=Handsontable).renderers.registerRenderer("wp_tinymce",function(e,t,o,a,n,r,s){c.renderers.BaseRenderer.apply(this,arguments),jQuery("#post-data").data("post-type");var i=vgse_editor_settings.final_spreadsheet_columns_settings[n];void 0===i.formatted.wpse_template_key&&(i.formatted.wpse_template_key="tinymce_cell_template");var d=vgse_editor_settings[i.formatted.wpse_template_key],l=parseInt(v.getDataAtRowProp(o,"ID")),u=vgseGetRowTitle(o)||String(l);if(d=(d=(d=d.replace(/\{key\}/g,n)).replace(/\{type\}/g,i.data_type)).replace(/\{id\}/g,l),"string"==typeof u)d=d.replace(/\{post_title\}/g,u.replace(/"/g,""));if(r){d+=vgseStripHtml(r).substring(0,30),30<r.length&&(d+="...")}else d+="("+vgse_editor_settings.texts.empty+")";return i.formatted.readOnly&&(d=(d='<i class="fa fa-lock vg-cell-blocked"></i> '+d).replace(/btn-popup-content/g,"")),t.innerHTML=d,t}),(g=Handsontable).renderers.registerRenderer("wp_handsontable",function(e,t,o,a,n,r,s){g.renderers.BaseRenderer.apply(this,arguments),jQuery("#post-data").data("post-type");var i=vgse_editor_settings.final_spreadsheet_columns_settings[n],d=vgse_editor_settings.handsontable_cell_template,l=parseInt(v.getDataAtRowProp(o,"ID")),u=(d=(d=(d=d.replace(/\{key\}/g,n)).replace(/\{type\}/g,i.data_type)).replace(/\{id\}/g,l),vgseGetRowTitle(o)||String(l)),c=(d=d.replace(/\{post_title\}/g,u.replace(/"/g,"")),v.getSourceData()),p=jQuery.extend(!0,i,c[o]);return p.post_id=l,d=(d=(d=d.replace(/\{modal_settings\}/g,vgseEscapeHTML(JSON.stringify(p)))).replace(/\{value\}/g,vgseEscapeHTML(JSON.stringify(r)))).replace(/\{button_label\}/g,p.edit_button_label),d+=r&&"[]"!==r?" ...":" ("+vgse_editor_settings.texts.empty+")",i.formatted.readOnly&&(d=(d='<i class="fa fa-lock vg-cell-blocked"></i> '+d).replace(/(btn-popup-content|button-custom-modal-editor|button-handsontable)/g,"")),t.innerHTML=d,t}),(l=Handsontable).renderers.registerRenderer("wp_friendly_select",function(e,t,o,a,n,r,s){l.renderers.BaseRenderer.apply(this,arguments);var i=vgse_editor_settings.final_spreadsheet_columns_settings[n],d=r;if(r&&void 0!==i.formatted.selectOptions[r])d=i.formatted.selectOptions[r];return t.innerHTML=d,t}),(p=Handsontable).renderers.registerRenderer("wp_external_button",function(e,t,o,a,n,r,s){p.renderers.BaseRenderer.apply(this,arguments);var i=vgse_editor_settings.final_spreadsheet_columns_settings[n];if(r)var d='<a target="_blank" href="'+r+'" class="button"><i class="fa fa-external-link"></i> '+i.title+"</a>";else d="";return t.innerHTML=d,t}),(f=Handsontable).renderers.registerRenderer("wp_locked",function(e,t,o,a,n,r,s){f.renderers.BaseRenderer.apply(this,arguments);var i=jQuery("#post-data").data("post-type"),d=vgse_editor_settings.final_spreadsheet_columns_settings[n];if(d.lock_template_key||(d.lock_template_key="lock_cell_template"),"string"==typeof r){var l=vgse_editor_settings.max_value_length_locked_cells||55;(r=vgseStripHtml(r).substring(0,l)).length>l&&(r+="...")}if("string"==typeof r&&-1<r.indexOf("vg-cell-blocked"))var u=r;else u=(u=(u=(u=(u=vgse_editor_settings[d.lock_template_key]).replace(/\{key\}/g,n)).replace(/\{value\}/g,r)).replace(/\{post_type\}/g,i)).replace(/set_custom_images|view_custom_images|button-handsontable|button-custom-modal-editor|data-remodal-target="image"/g,"");return t.innerHTML=u,t}),jQuery(".wpse-full-screen-notice").length&&(vgseToggleFullScreen(parseInt(jQuery(".wpse-full-screen-notice").data("status"))),jQuery("body").on("click",".wpse-full-screen-toggle",function(e){e.preventDefault(),vgseToggleFullScreen()})),jQuery("body").on("click",".dismiss-review-tip",function(e){jQuery(this).attr("href")||e.preventDefault(),vgse_editor_settings.texts.ask_review="",jQuery(this).parent(".review-tip").remove();var t=jQuery(".remodal-bg").data("nonce");jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"vgse_dismiss_review_tip",nonce:t},dataType:"json"})}),jQuery(".wpse-stuck-loading").appendTo("body"),jQuery("body").on("click",".wpse-stuck-loading button",function(e){e.preventDefault(),loading_ajax(!1),window.beLastLoadRowsAjax&&window.beLastLoadRowsAjax.abort(),jQuery(".wpse-stuck-loading").hide()}),jQuery(".vi-preview-wrapper").appendTo("body"),jQuery("body").on("mouseleave",".vi-preview-img",function(e){jQuery(".vi-preview-wrapper").hide()}),jQuery("body").on("mouseenter",".vi-preview-img",function(e){var t=jQuery(this).first();jQuery(this)[0].outerHTML;if(-1<t.attr("src").indexOf("wpse_no_zoom"))return!0;var o='<img src="'+t.attr("src")+'" />',a=jQuery(".vi-preview-wrapper");jQuery(window).width()-a.width()<t.offset().left+t.width()-jQuery(document).scrollLeft()?a.css({right:"auto",left:"0px"}):a.css({right:"0px",left:"auto"}),a.empty(),a.show(),a.append(o)}),jQuery("#go-top").on("click",function(e){e.preventDefault(),jQuery("html, body").stop().animate({scrollTop:0},"300","swing",function(){})}),jQuery("body").append('<div id="ohsnap" style="z-index: -1"></div>');var t=jQuery("#vgse-wrapper");t.length&&t.find(".vg-toolbar input:checkbox").labelauty();var v,y=jQuery("#post-data"),o=(jQuery("#responseConsole"),jQuery("#vgse-wrapper"));jQuery("#formato").is(":checked")?format=!1:format=!0,setTimeout(function(){vgseInitSelect2()},2e3);var a={comments:vgse_editor_settings.allow_cell_comments,colWidths:vgObjectToArray(vgse_editor_settings.colWidths),colHeaders:vgObjectToArray(vgse_editor_settings.colHeaders),columns:m(format),rowHeaders:!0,startRows:vgse_editor_settings.startRows,startCols:vgse_editor_settings.startCols,currentRowClassName:"currentRow",currentColClassName:"currentCol",fillHandle:!1,columnSorting:!0,manualColumnFreeze:!0,manualColumnMove:!0,contextMenu:{items:{undo:{},redo:{},separator1:{name:"---------"},copy:{},cut:{},how_to_paste:{name:vgse_editor_settings.texts.how_to_paste},separator2:{name:"---------"},make_read_only:{},freeze_column:{},unfreeze_column:{},delete_row:{name:vgse_editor_settings.texts.delete_row,hidden:function(){return!v.getSelected()||!vgse_editor_settings.can_delete_row},callback:function(e,t,o){var a=[],n=[];if(t.forEach(function(e){e.start.row<e.end.row?vgseRange(e.start.row,e.end.row).forEach(function(e){n.push(e)}):n.push(e.start.row)}),n.forEach(function(e){a.push(v.getDataAtRowProp(e,"ID"))}),5<a.length){var r=jQuery(".confirm-bulk-delete-rows-modal");r.data("rowIds",a),r.remodal().open()}else{if(!confirm(vgse_editor_settings.texts.confirm_delete_row.replace("{rows_number}",a.length)))return!0;vgseDeleteRowsById(a),v.deselectCell()}}},resize_columns:{name:vgse_editor_settings.texts.auto_resize_columns,callback:function(e,t,o){v.updateSettings({colWidths:null}),v.updateSettings({autoColumnSize:!0});var a=v.getPlugin("autoColumnSize");a.recalculateAllColumnsWidth(),a.widths;var n=[];a.widths.forEach(function(e){n.push(e+25)}),v.updateSettings({colWidths:n,autoColumnSize:!1}),v.runHooks("afterColumnResize")}}}},autoWrapRow:!0,autoRowSize:!1,autoColumnSize:!1,viewportRowRenderingOffset:20,viewportColumnRenderingOffset:22<vgse_editor_settings.media_cell_preview_max_height?500:4,wordWrap:!0,minSpareCols:0,minSpareRows:0,width:null,height:null,copyPaste:{rowsLimit:999999,columnsLimit:999999},afterChange:_throttle(function(e){var t=!1;e&&e.length&&e.forEach(function(e){return!(!window.vgseFormulasBulkSelectorExists||0!==e[1]&&"wpseBulkSelector"!==e[1])||(e[2]!==e[3]?t=!0:void 0)}),t&&beSetSaveButtonStatus(!0)},3e3,{leading:!0,trailing:!0}),beforeCopy:function(a,e){return a.forEach(function(e,o){e.forEach(function(e,t){"string"==typeof e&&-1<e.indexOf("vg-cell-blocked")&&(a[o][t]=vgseStripHtml(e).trim())})}),a},afterDocumentKeyDown:function(e){var t=!1;if("ArrowDown"===e.key){var o=v.getSelected(),a=v.countRows()-1;o&&o[0][0]===a&&o[0][2]===a&&(t=!0)}"ArrowUp"===e.key&&(o=v.getSelected())&&0===o[0][0]&&0===o[0][2]&&(t=!0);if("ArrowRight"===e.key){var o=v.getSelected(),n=v.countCols()-1;o&&o[0][3]===n&&(t=!0)}"ArrowLeft"===e.key&&(o=v.getSelected())&&0===o[0][1]&&(t=!0);if(t)return e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),e}};vgse_editor_settings.is_premium&&(a.contextMenu.items.show_column_key={name:vgse_editor_settings.texts.show_column_key,callback:function(e,t,o){var a=v.colToProp(t[0].start.col);alert(vgse_editor_settings.texts.column_key_description+": $"+a+"$")}}),vgse_editor_settings.debug&&(a.debug=vgse_editor_settings.debug);var n=vgse_editor_settings.custom_handsontable_args?JSON.parse(vgse_editor_settings.custom_handsontable_args):{},r=jQuery.extend(a,n);("ontouchstart"in window||0<navigator.msMaxTouchPoints)&&(r.width=jQuery(window).width(),r.height=jQuery(window).height(),jQuery(window).width()<600&&(r.fixedColumnsLeft=!1)),v=new Handsontable(y[0],r),beSetSaveButtonStatus(!1),window.hot=v,window.beFoundRows=0,jQuery(".confirm-bulk-delete-rows-modal input").on("keyup",function(e){e.preventDefault();var t=jQuery(this);13===e.keyCode&&t.val()&&"delete"===t.val().toLowerCase()&&jQuery(".confirm-bulk-delete-rows-modal").data("rowIds")&&(vgseDeleteRowsById(jQuery(".confirm-bulk-delete-rows-modal").data("rowIds")),t.val(""),jQuery(".confirm-bulk-delete-rows-modal").data("rowIds",!1),jQuery(".confirm-bulk-delete-rows-modal").remodal().close())}),jQuery(document).on("opened",".confirm-bulk-delete-rows-modal",function(e){var t=jQuery(this).data("rowIds");jQuery(this).find(".contains-variable span").text(t.length)}),o.find("button[name=load]").on("click",function(){var e=jQuery(".remodal-bg").data("nonce");beLoadPosts({post_type:y.data("post-type"),nonce:e})}),vgse_editor_settings.disable_automatic_loading_rows||setTimeout(function(){jQuery("body").trigger("vgSheetEditor/beforeIntialLoadingRows"),o.find("button[name=load]").click()},400),jQuery("body").on("vgSheetEditor:beforeRowsInsert",function(e,t){t.success||vgseCustomTooltip(jQuery(".sheet-header .add_rows-container"),vgse_editor_settings.texts.add_posts_here,null,!1,"success")}),vgse_editor_settings.enable_auto_saving&&setInterval(function(){if(jQuery(".wpse-save.disabled").length||window.wpseAutoSavingInProgress)return!0;var e=jQuery(".button-container.auto_saving_status-container a");e.text(e.data("saving-changes")),jQuery("body").find(".be-start-saving").click(),window.wpseAutoSavingInProgress=!0},12e4),jQuery(".bulk-save.remodal").find(".remodal-cancel").on("click",function(e){jQuery('[data-remodal-id="bulk-save"]').remodal().close(),jQuery("html,body").scrollLeft(0)}),jQuery(".bulk-save.remodal .bulk-saving-screen").find(".remodal-cancel").on("click",function(e){jQuery("html,body").scrollLeft(0);var t=jQuery(this),o=t.parents(".remodal");o.find(".be-saving-warning").show(),o.find(".bulk-saving-screen").hide(),o.find("#be-nanobar-container").empty(),t.addClass("hidden"),o.find(".response").empty()}),jQuery(document).on("opening",'[data-remodal-id="bulk-save"]',function(){vgse_editor_settings.user_has_saved_sheet&&jQuery("body").find(".be-start-saving").click()}),document.addEventListener("keydown",function(e){"s"===e.key.toLowerCase()&&e.ctrlKey&&!jQuery(".remodal-is-opened").length&&(e.preventDefault(),v.deselectCell(),jQuery(".wpse-save").trigger("click"))}),jQuery("body").on("click",".wpse-save.disabled, .wpse-save-later.disabled",function(e){e.preventDefault(),notification({mensaje:vgse_editor_settings.texts.no_changes_to_save,tipo:"info"})}),jQuery(".bulk-save.remodal").find(".remodal-confirm").on("click",function(e){var t=jQuery(this).parents(".remodal");t.find(".be-saving-warning").show(),t.find(".bulk-saving-screen").hide(),t.find("#be-nanobar-container").empty(),t.find(".response").empty()}),jQuery("body").find(".be-start-saving").on("click",function(e){e.preventDefault(),vgse_editor_settings.user_has_saved_sheet=1;var t=jQuery(this).parents(".be-saving-warning"),s=t.next();s.find(".be-loading-anim").show(),t.fadeOut(),s.fadeIn();var i=v.getSourceData();if(!(i=beGetModifiedItems(i,window.beOriginalData)).length)return jQuery(s).find(".response").append("<p>"+vgse_editor_settings.texts.no_changes_to_save+"</p>"),loading_ajax({estado:!1}),s.find(".remodal-cancel").removeClass("hidden"),s.find(".be-loading-anim").hide(),vgseAllowToClosePageWithoutWarning(!0),setTimeout(function(){beSetSaveButtonStatus(!1),s.find(".remodal-cancel").click()},500),notification({mensaje:vgse_editor_settings.texts.no_changes_to_save,tipo:"info"}),!0;var o=jQuery(".remodal-bg").data("nonce"),a={classname:"be-progress-bar",id:"be-progress-bar",target:document.getElementById("be-nanobar-container")},d=new Nanobar(a);d.go(1);var n=Math.ceil(i.length/parseInt(vgse_editor_settings.save_posts_per_page));jQuery(".saving-now-message").show(),1<n&&setTimeout(function(){jQuery(".saving-complete-message").length||jQuery(".tip-saving-speed-message").show()},5500);var r=jQuery(".button-container.auto_saving_status-container a");beAjaxLoop({totalCalls:n,url:vgse_editor_settings.ajax_url,dataType:"json",method:"POST",data:{data:[],post_type:y.data("post-type"),action:"vgse_save_data",nonce:o,filters:beGetRowsFilters(),wpse_source_suffix:vgse_editor_settings.wpse_source_suffix||""},prepareData:function(e,t){var o=i.chunk(parseInt(vgse_editor_settings.save_posts_per_page));return e.data=o[t.current-1],e},onSuccess:function(e,t){if(e&&(!0===e.success||e.data)||(e={data:{message:vgse_editor_settings.texts.http_error_try_now},success:!1,allowRetry:!0}),!e.success)return jQuery(".tip-saving-speed-message").hide(),jQuery(s).find(".response").append("<p>"+e.data.message+"</p>"),!!e.allowRetry&&confirm(e.data.message)?(t.current--,jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight),!0):(vgse_editor_settings.enable_auto_saving?jQuery(s).find(".response").append(vgse_editor_settings.texts.auto_saving_stop_error):jQuery(s).find(".response").append(vgse_editor_settings.texts.saving_stop_error),s.find(".remodal-cancel").removeClass("hidden"),s.find(".be-loading-anim").hide(),jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight),vgse_editor_settings.enable_auto_saving&&(r.text(r.data("unsaved-changes")),jQuery('[data-remodal-id="bulk-save"]').is(":visible")||jQuery('[data-remodal-id="bulk-save"]').remodal().open()),!1);d.go(t.current/t.totalCalls*100),e.data.deleted.length&&vgseRemoveRowFromSheetByID(e.data.deleted);var o=parseInt(vgse_editor_settings.save_posts_per_page)*t.current>i.length?i.length:parseInt(vgse_editor_settings.save_posts_per_page)*t.current,a=(a=vgse_editor_settings.texts.paged_batch_saved.replace("{updated}",o)).replace("{total}",i.length);if(jQuery(s).find(".response").append("<p>"+a+"</p>"),t.current===t.totalCalls){jQuery(".tip-saving-speed-message, .saving-now-message").hide();var n=vgse_editor_settings.texts.everything_saved;if(vgse_editor_settings.texts.ask_review&&(n+="<br>"+vgse_editor_settings.texts.ask_review),jQuery(s).find(".response").empty().append('<p class="saving-complete-message">'+n+"</p>"),loading_ajax({estado:!1}),notification({mensaje:vgse_editor_settings.texts.everything_saved}),s.find(".remodal-cancel").removeClass("hidden"),s.find(".be-loading-anim").hide(),jQuery("body").trigger("vgSheetEditor/afterSavingChanges"),vgseAllowToClosePageWithoutWarning(!0),beSetSaveButtonStatus(!1),window.beOriginalData=jQuery.extend(!0,[],v.getSourceData()),v.getSourceData().forEach(function(e,t){void 0!==e.post_status&&"delete"===e.post_status&&v.alter("remove_row",t)}),1===t.totalCalls&&setTimeout(function(){jQuery('[data-remodal-id="bulk-save"]').remodal().close()},500),vgse_editor_settings.enable_auto_saving){var r=jQuery(".button-container.auto_saving_status-container a");r.text(r.data("saved-changes"))}}return setTimeout(function(){jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight)},600),!0},onError:function(e,t,o){var a=vgse_editor_settings.enable_auto_saving?vgse_editor_settings.texts.auto_saving_http_error_try_now:vgse_editor_settings.texts.http_error_try_now,n=confirm(a);return s.find(".be-loading-anim").hide(),n?(window.vgseDontNotifyServerError=!0,o.current--,d.go(o.current/o.totalCalls*100),jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight),!0):(vgse_editor_settings.enable_auto_saving?jQuery(s).find(".response").append(vgse_editor_settings.texts.auto_saving_stop_error):jQuery(s).find(".response").append(vgse_editor_settings.texts.saving_stop_error),s.find(".remodal-cancel").removeClass("hidden"),jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight),vgse_editor_settings.enable_auto_saving&&r.text(r.data("unsaved-changes")),!1)}})}),"undefined"!=typeof wp&&wp.media&&jQuery("body").on("click",".set_custom_images:not(.multiple)",function(e){e.preventDefault(),loading_ajax({estado:!0});var a=jQuery(this),t=a.parent("td"),n=v.getCoords(t[0]),r=jQuery("html,body").scrollLeft(),o=(a.data("id"),a.data("key"),a.data("type"),a.data("file")),s=[],i=jQuery(document).scrollTop(),d=jQuery("#infinito").prop("checked");return jQuery("#infinito").prop("checked",!1),media_uploader=wp.media({frame:"post",state:"insert",multiple:!1}),media_uploader.state("embed").on("select",function(){var e=media_uploader.state(),t=e.get("type"),o=e.props.toJSON();o.url=o.url||"","image"===t&&o.url&&wpsePrepareGalleryFilesForCellFormat([{url:o.url,id:o.url}],n)}),media_uploader.on("open",function(){var e=media_uploader.state().get("selection"),t=o;t&&e.add(wp.media.attachment(t))}),media_uploader.on("close",function(){jQuery("html,body").scrollLeft(r),jQuery(window).scrollTop(i),jQuery("#infinito").prop("checked",d)}),media_uploader.on("insert",function(){jQuery("html,body").scrollLeft(r);var e=media_uploader.state().get("selection").length,t=media_uploader.state().get("selection").models;if(!t.length)return!0;for(var o=0;o<e;o++)s.push({url:t[o].attributes.url,id:t[o].id});a.data("file",t[0].id),wpsePrepareGalleryFilesForCellFormat(s,n)}),media_uploader.open(),loading_ajax({estado:!1}),!1}),"undefined"!=typeof wp&&wp.media&&jQuery("body").on("click",".set_custom_images.multiple",function(e){e.preventDefault(),loading_ajax({estado:!0});var t=jQuery(this),o=t.parent("td"),a=v.getCoords(o[0]),n=jQuery("html,body").scrollLeft(),r=(t.data("id"),t.data("key"),t.data("type"),[]),s=jQuery(document).scrollTop(),i=jQuery("#infinito").prop("checked");return jQuery("#infinito").prop("checked",!1),media_uploader=wp.media({frame:"post",state:"insert",multiple:!0}),media_uploader.state("embed").on("select",function(){var e=media_uploader.state(),t=e.get("type"),o=e.props.toJSON();o.url=o.url||"","image"===t&&o.url&&wpsePrepareGalleryFilesForCellFormat([{url:o.url,id:o.url}],a)}),media_uploader.on("close",function(){jQuery("html,body").scrollLeft(n),jQuery(window).scrollTop(s),jQuery("#infinito").prop("checked",i)}),media_uploader.on("insert",function(){jQuery("html,body").scrollLeft(n);for(var e=media_uploader.state().get("selection").length,t=media_uploader.state().get("selection").models,o=0;o<e;o++)r.push({url:t[o].attributes.url,id:t[o].id});wpsePrepareGalleryFilesForCellFormat(r,a)}),media_uploader.open(),loading_ajax({estado:!1}),!1}),jQuery("body").on("click",".view_custom_images",function(){var e=jQuery(this).parent("td"),t=v.getCoords(e[0]),o=v.getDataAtCell(t.row,t.col),a="";o.split(",").forEach(function(e){a+='<div><img src="'+e.trim()+'" width="425px" /></div>'}),jQuery("div[data-remodal-id=image] .modal-content").html(a),jQuery("[data-remodal-id=image]").remodal()}),jQuery("button.siguiente").on("click",function(){var e=jQuery(this),t=e.data("pos"),o=e.parents(".remodal").data("column-key"),a=jQuery(v.getCell(t,v.propToCol(o)));e.data("delay")?setTimeout(function(){a.find(".button").click()},parseInt(e.data("delay"))):a.find(".button").trigger("click")}),jQuery("button.anterior").on("click",function(){var e=jQuery(this),t=e.data("pos"),o=e.parents(".remodal").data("column-key"),a=jQuery(v.getCell(t,v.propToCol(o)));e.data("delay")?setTimeout(function(){a.find(".button").trigger("click")},parseInt(e.data("delay"))):a.find(".button").trigger("click")}),jQuery("body").on("click",".btn-popup-content",function(){var e=jQuery(this),t=e.data("id"),o=e.data("key"),a=e.data("type"),n=v.countRows(),r=jQuery(this).parent("td"),s=v.getCoords(r[0]),i=v.getDataAtCell(s.row,s.col),d=vgseGetRowTitle(s.row),l=s.row;window.tinymceAutoResized||(window.tinymceAutoResized=!0,jQuery("#editpost_ifr").height(200));var u=jQuery(".modal-tinymce-editor");0===l?(u.find("button.anterior").hide(),u.find("button.anterior").next("[data-wpse-tooltip]").hide()):(u.find("button.anterior").show(),u.find("button.anterior").next("[data-wpse-tooltip]").show()),l===n-1?(u.find("button.siguiente").hide(),u.find("button.siguiente").next("[data-wpse-tooltip]").hide()):(u.find("button.siguiente").show(),u.find("button.siguiente").next("[data-wpse-tooltip]").show()),u.find("button.anterior").data("pos",l-1),u.find("button.siguiente").data("pos",l+1),d?jQuery(".modal-tinymce-editor .post-title-modal span").text(d).show():jQuery(".modal-tinymce-editor .post-title-modal").hide(),setTimeout(function(){jQuery("#editpost-html").click(),jQuery(".wp-editor-area").empty(),jQuery(".wp-editor-area").val(i),jQuery("#editpost-tmce").click(),window.originalTinyMCEData=beGetTinymceContent(),jQuery(".modal-tinymce-editor .remodal-confirm").data("post_id",t),jQuery(".modal-tinymce-editor").data("column-key",o),jQuery(".modal-tinymce-editor .remodal-confirm").data("type",a),jQuery(".modal-tinymce-editor .remodal-confirm").data("cellCoords",s),jQuery('[data-remodal-id="editor"]').remodal().open()},500)}),jQuery(".guardar-popup-tinymce").on("click",function(e){var t=jQuery(".modal-tinymce-editor .remodal-confirm").data("cellCoords"),o=beGetTinymceContent();v.setDataAtCell(t.row,t.col,o)}),jQuery("body").on("click",".wpse-disable-if-unsaved-changes.disabled",function(e){alert(vgse_editor_settings.texts.save_changes_before_using_tool)}),jQuery(".pagination-jump input").on("keyup",function(e){var t=parseInt(jQuery(this).val()),o=parseInt(jQuery(this).attr("max"));if(13==e.keyCode&&t!==window.beCurrentPage&&1<=t&&t<=o)return vgseReloadSpreadsheet(!0,null,t),jQuery(this).blur(),!0}),jQuery("body").on("click",".load-more",function(){jQuery("#formato").is(":checked")?format=!0:format=!1;var e=jQuery(".remodal-bg").data("nonce");if(jQuery(this).data("pagination")){var t=parseInt(jQuery(this).data("pagination"));return t&&t!==window.beCurrentPage&&vgseReloadSpreadsheet(!0,null,t),!0}var o=window.beCurrentPage+1;beLoadPosts({post_type:y.data("post-type"),paged:o,nonce:e},function(e){if(e.success){vgseAddFoundRowsCount(e.data.total),vgAddRowsToSheet(e.data.rows),loading_ajax({estado:!1});var t=e.data.message||vgse_editor_settings.texts.posts_loaded;notification({mensaje:t}),window.scrroll=!0,e.data&&e.data.rows.length||(window.scrroll=!1)}else loading_ajax({estado:!1}),notification({mensaje:e.data.message,tipo:"info",time:3e4}),window.scrroll=!1})});jQuery("#post-data").offset();window.scrroll=!0,window.isAddColumnNotified=!1;v.countRows();var s=jQuery(".ht_clone_top").width()>jQuery(window).width(),i=jQuery(document).width()+200>jQuery(window).width(),d=jQuery("#infinito");function m(e){if(!0===e)var t=vgse_editor_settings.columnsFormat;else t=vgse_editor_settings.columnsUnformat;var a=vgObjectToArray(t);return a.forEach(function(o,e){"string"==typeof o.source&&("loadTaxonomyTerms"===o.source&&(a[e].source=_throttle(function(e,t){return function(e,t){var o=jQuery(".remodal-bg").data("nonce"),a=jQuery("#post_type_new_row").val(),n=v.colToProp(v.getSelected()[0][1]),r=vgse_editor_settings.columnsFormat[n].taxonomy_key||n;void 0===window.wpseTaxonomyTerms&&(window.wpseTaxonomyTerms={});void 0===window.wpseTaxonomyTerms[r]?(window.wpseTaxonomyTerms[r]=[],jQuery.ajax({url:vgse_editor_settings.ajax_url,dataType:"json",data:{action:"vgse_get_taxonomy_terms",taxonomy_key:r,nonce:o,post_type:a,wpse_source:"taxonomy_column"},success:function(e){window.wpseTaxonomyTerms[r]=e.data,t(e.data)}})):t(window.wpseTaxonomyTerms[r])}(0,t)},1500,{leading:!0,trailing:!0})),"searchPostByKeyword"===o.source&&(a[e].source=_throttle(function(e,t){return function(e,o,t){if(!e)return o([]);var a=jQuery(".remodal-bg").data("nonce"),n=t||jQuery("#post_type_new_row").val();jQuery.ajax({url:vgse_editor_settings.ajax_url,dataType:"json",data:{action:"vgse_find_post_by_name",search:e,nonce:a,post_type:n,wpse_source:"post_dropdown_column"},success:function(e){var t=[];e.success&&e.data.data.forEach(function(e){t.push(e.title)}),o(t)}})}(e,t,o.searchPostType)},1500,{leading:!0,trailing:!0})),"searchUsers"===o.source&&(a[e].source=_throttle(function(e,t){return function(e,o){var t=jQuery(".remodal-bg").data("nonce"),a=vgse_editor_settings.post_type;jQuery.ajax({url:vgse_editor_settings.ajax_url,dataType:"json",data:{action:"vgse_find_users_by_keyword",search:e,nonce:t,post_type:a,wpse_source:"users_dropdown_column"},success:function(e){var t=[];e.success&&(t=e.data.data),o(t)}})}(e,t)},1500,{leading:!0,trailing:!0})))}),a}function _(e,t,o,a,n,r,s){var i=jQuery(window).scrollTop(),d=scrollDown(a+e),l=jQuery(window).scrollLeft();d&&"top"===e&&(n<i?(t.removeClass("sticky-left"),t.css({left:"",width:""}),t.removeClass("sticky-left"),t.css("top",""),t.addClass("sticky"),jQuery("#wpadminbar").hide(),o.height(r)):(jQuery("#wpadminbar").show(),t.removeClass("sticky"),o.height(0))),d||"top"===e||(0===i&&(jQuery("#wpadminbar").show(),t.removeClass("sticky"),o.height(0)),t.hasClass("sticky")?(t.css({left:"",width:""}),t.removeClass("sticky-left")):s+20<l?(o.height(r),t.addClass("sticky-left"),t.css({left:l-jQuery("#vgse-wrapper").offset().left,width:jQuery(window).width()})):(o.height(0),t.css({left:"",width:""}),t.removeClass("sticky-left")))}if(jQuery(window).on("scroll",_throttle(function(){var e=scrollDown("infiniteLoad");d.length&&d.is(":checked")&&jQuery(document).height()>jQuery(window).height()&&void 0!==window.beOriginalData&&parseInt(jQuery(window).scrollTop()+jQuery(window).height())==jQuery(document).height()&&!0===window.scrroll&&e&&(jQuery(".load-more").trigger("click"),window.scrroll=!1);var t=jQuery(window).scrollLeft()+jQuery(window).width()>=jQuery(document).width()-400;s&&vgse_editor_settings.texts.hint_missing_column_on_scroll&&i&&t&&!window.isAddColumnNotified&&!e&&(window.isAddColumnNotified=!0,notification({mensaje:vgse_editor_settings.texts.hint_missing_column_on_scroll,tipo:"info",time:8e4,position:"bottom"}))},500,{leading:!0,trailing:!0})),jQuery("body").on("click",".show-column-missing-tips",function(e){e.preventDefault(),setTimeout(function(){jQuery(".modal-columns-visibility").parent().scrollTop(jQuery(".missing-column-tips").offset().top)},250)}),jQuery("body").on("click",".wpse-enable-locked-cell",function(e){e.preventDefault();var t=v.colToProp(v.getSelected()[0][1]);vgse_editor_settings.lockedColumnsManuallyEnabled.push(t);var o=v.propToCol(t),a=v.getDataAtCell(1,o);v.setDataAtCell(1,o,a)}),jQuery("#formato").on("change",function(){jQuery(this).is(":checked")?format=!1:format=!0;var e=m(format);"function"==typeof vgseColumnsVisibilityUpdateHOT&&window.vgseColumnsVisibilityUsed?vgseColumnsVisibilityUpdateHOT(e,vgse_editor_settings.colHeaders,vgse_editor_settings.colWidth,"softUpdate"):v.updateSettings({columns:e})}),jQuery("#addrow").on("click",function(){var e=jQuery(".remodal-bg").data("nonce"),o=jQuery("#post_type_new_row").val(),a=jQuery(this).next(".number_rows").length&&jQuery(this).next(".number_rows").val()?parseInt(jQuery(this).next(".number_rows").val()):1,t=void 0!==window.wpseAddRowExtraData?window.wpseAddRowExtraData:null;loading_ajax({estado:!0}),jQuery.ajax({type:"POST",url:vgse_editor_settings.ajax_url,data:{action:"vgse_insert_individual_post",nonce:e,post_type:o,rows:a,extra_data:t},dataType:"json",success:function(e){if(e.success){vgseAddFoundRowsCount(window.beFoundRows+parseInt(a)),vgAddRowsToSheet(e.data.message,"prepend"),loading_ajax({estado:!1}),notification({mensaje:vgse_editor_settings.texts.new_rows_added});var t=jQuery(".be-spreadsheet-wrapper").offset().top-jQuery("#vg-header-toolbar").height()-20;vgseIsInViewport(jQuery(".be-spreadsheet-wrapper"))||jQuery(window).scrollTop(t)}else loading_ajax({estado:!1}),notification({mensaje:e.data.message,tipo:"error",tiempo:6e4});jQuery("body").trigger("vgSheetEditor:afterNewRowsInsert",[e,o,a])}})}),jQuery("#addrow2").on("click",function(){jQuery("#addrow").trigger("click")}),jQuery("#vg-header-toolbar").length&&window.location.href.indexOf("wpse_no_sticky_toolbar")<0){var w=jQuery("#vg-header-toolbar").outerHeight(),j=jQuery("#vg-header-toolbar").offset().left,b=jQuery("#vg-header-toolbar-placeholder").offset().top,Q=jQuery("#vg-header-toolbar.js-sticky-top"),x=jQuery("#vg-header-toolbar-placeholder");Q.hasClass("js-sticky-top")&&(jQuery(window).on("scroll",_throttle(function(){_("top",Q,x,"menu",b,w,j)},20)),_("top",Q,x,"menu",b,w,j)),Q.hasClass("js-sticky-left")&&(jQuery(window).on("scroll",_throttle(function(){_("left",Q,x,"menu",b,w,j)},5)),_("left",Q,x,"menu",b,w,j))}var k=jQuery("#vg-footer-toolbar.js-sticky");if(k.length){var C=k.outerHeight(),T=k.offset().left,E=k.offset().top,S=k,A=jQuery("#vg-footer-toolbar-placeholder");jQuery(window).on("scroll",_throttle(function(){_("left",S,A,"footer",E,C,T)},5)),_("left",S,A,"footer",E,C,T)}jQuery("body").trigger("vgSheetEditor:afterInit"),jQuery(window).width()<1200&&50<jQuery("#vg-header-toolbar > .vg-header-toolbar-inner").height()&&jQuery(".vg-secondary-toolbar .vg-header-toolbar-inner div.clear").before(jQuery("#vg-header-toolbar > .vg-header-toolbar-inner > .button-container:gt(-3)"))});var lastScrollTop={};function scrollDown(e){lastScrollTop[e]||(lastScrollTop[e]=0);var t=jQuery(window).scrollTop();return t!==lastScrollTop[e]?down=!0:down=!1,lastScrollTop[e]=t,down}var vgseClosePageWithoutWarning=!1,vgseAllowToClosePageWithoutWarning=function(e){vgseClosePageWithoutWarning=e,window.wpseAutoSavingInProgress=!e};function initHandsontableForPopup(e,r){if("handsontable"===r.type){"string"==typeof e&&(e=JSON.parse(e)),e=e||[];var t,o=r.handsontable_column_widths[r.post_type],a=r.handsontable_column_names[r.post_type],n=r.handsontable_columns[r.post_type],s=document.getElementById("handsontable-in-modal");window.hotAttr&&!window.hotAttr.isDestroyed&&window.hotAttr.destroy(),!(t=e.custom_handsontable_args?e.data:e).length&&window.wpseCurrentPopupSourceCoords.cellValue&&(t=window.wpseCurrentPopupSourceCoords.cellValue);var i={data:t,minSpareRows:1,wordWrap:!0,colWidths:o,allowInsertRow:!0,columnSorting:!0,colHeaders:a,columns:n,afterColumnSort:function(e,t){if("_vgse_create_attribute"===r.key){var o=window.hotAttr.getSourceData(),a=window.hotAttr.getDataAtProp("name"),n=[];o.forEach(function(e){n[e.name]=e}),a.forEach(function(e,t){n[e].position=t})}}},d=jQuery.extend(i,e.custom_handsontable_args);window.hotAttr=new Handsontable(s,d)}else"metabox"===r.type&&initEditorIframe(r);loading_ajax({estado:!1})}function initEditorIframe(s){window.$iframeWrappers=jQuery(".vgca-iframe-wrapper");var e=window.$iframeWrappers;e.show(),e.find("iframe").remove();var t=e.find(".iframe-template").prop("outerHTML").replace(/div/g,"iframe"),o=jQuery(t);o.removeClass("iframe-template"),o.attr("src",o.data("src")+s.post_id+"&wpse_column="+s.key),e.append(o),jQuery(".custom-modal-editor").addClass("modal-editor-"+s.key),window.vgcaIsFrontendSession=[],$iframeWrappers.each(function(){var n=jQuery(this),r=n.find("iframe");window.location.hash;r.data("lastPage",r.contents().get(0).location.href),window.vgcaIsFrontendSession.push(setInterval(function(){var e=r.contents().get(0).location.href;e!==r.data("lastPage")&&($iframeWrappers.css("height",""),r.css("height",""),r.data("lastPage",e));var t=null;try{t=r.contents()}catch(e){}if(t){var o=700;r.height(o),n.height(o);var a=t.find(s.metabox_show_selector);a.removeClass("acf-hidden").removeClass("hidden").attr("hidden","").attr("style","display: block !important; visibility: 1 !important; opacity: 1 !important;"),a.siblings().filter(function(){return!(jQuery(this).hasClass("mce-container")||jQuery(this).hasClass("ui-autocomplete")||jQuery(this).attr("id")&&-1<jQuery(this).attr("id").indexOf("__wp-uploader-id"))}).attr("style","display: none !important"),a.parents().each(function(){jQuery(this).siblings().filter(function(){return!(jQuery(this).hasClass("mce-container")||jQuery(this).hasClass("ui-autocomplete")||jQuery(this).attr("id")&&-1<jQuery(this).attr("id").indexOf("__wp-uploader-id"))}).attr("style","display: none !important")})}},1e3))})}function vgsePostTypeSaved(e){e.response.success&&(jQuery(".post-types-form .post-type-field").first().before('<div class="post-type-field"><input type="radio" name="post_types[]" value="'+e.response.data.slug+'" id="'+e.response.data.slug+'"> <label for="'+e.response.data.slug+'">'+e.response.data.label+"</label></div>"),jQuery(".post-types-form input:radio").first().prop("checked",!0),jQuery(".post-types-form .save-trigger").trigger("click"))}function vgsePostTypeSetupPostTypesSaved(e){var t=e.form.parents("li");t.hide();var o=t.next();o.show(),o.hasClass("setup_columns")&&jQuery.get(ajaxurl,{action:"vgse_post_type_setup_columns_visibility",nonce:jQuery(".post-type-setup-wizard").data("nonce"),post_type:jQuery(".post-types-form input:radio:checked").val()},function(e){o.append(e.data.html),o.find('[name="save_post_type_settings"]').prop("checked",!0),"undefined"!=typeof vgseColumnsVisibilityInit&&vgseColumnsVisibilityInit()})}function vgsePostTypeSetupColumnSaved(e){jQuery("#vgse-columns-enabled").append('<li><span class="handle">::</span> '+e.response.data.label+' <input type="hidden" name="columns[]" class="js-column-key" value="'+e.response.data.key+'"><input type="hidden" name="columns_names[]" class="js-column-title" value="'+e.response.data.label+'"></li>')}function vgsePostTypeSetupColumnsVisibilitySaved(e){window.location.href=e.response.data.post_type_editor_url}function vgseStripHtml(e){return(new DOMParser).parseFromString(e,"text/html").body.textContent||""}function vgseRange(e,t){for(var o=[],a=e;a<=t;a++)o.push(a);return o}function vgseIsInViewport(e){var t=e.offset().top,o=(e.outerHeight(),jQuery(window).scrollTop()),a=o+jQuery(window).height();return o<t&&t<a}function vgseCountMatchingElements(e,t){var o=0;for(i=0;i<e.length;i++)-1!=t.indexOf(e[i])&&o++;return o}function vgseGetPostTypeColumnsOptions(i,d,e,l){var u=l?{}:[];return vgse_editor_settings?(jQuery.each(vgse_editor_settings.final_spreadsheet_columns_settings,function(e,t){if(vgse_editor_settings.exclude_non_visible_columns_from_tools&&void 0===vgse_editor_settings.columnsFormat[e])return!0;var o=!0;for(var a in i)if(Object.hasOwnProperty.call(i,a)&&i[a]!==t[a]){o=!1;break}if(o){var n=d?t.title+" ($"+e+"$)":t.title,r=d?"$"+e+"$":e;if(l)u[r]=n;else{var s=jQuery("<option />").attr({value:r,"data-value-type":t.value_type||"text"}).text(n);u.push(s.prop("outerHTML"))}}}),e?u.join(""):u):u}function vgseEscapeHTML(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(/[&<>"']/g,function(e){return t[e]})}function vgseToggleFullScreen(e){"number"!=typeof e&&(e="block"===jQuery(".wpse-full-screen-notice-content.notice-on").css("display")||jQuery(window).scrollLeft()>jQuery("#adminmenuwrap").width()),e?(jQuery(".wpse-full-screen-notice-content.notice-on").hide(),jQuery(".wpse-full-screen-notice-content.notice-off").show(),jQuery("html").removeClass("wpse-full-screen"),jQuery("html,body").scrollTop(0),jQuery("html,body").scrollLeft(0)):(jQuery(".wpse-full-screen-notice-content.notice-on").show(),jQuery(".wpse-full-screen-notice-content.notice-off").hide(),jQuery("html").addClass("wpse-full-screen"))}function vgseFormatDate(){var e=new Date,t=""+(e.getMonth()+1),o=""+e.getDate(),a=e.getFullYear();return t.length<2&&(t="0"+t),o.length<2&&(o="0"+o),[a,t,o].join("-")}function vgseGuidGenerator(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function vgseCustomTooltip(e,t,o,a,n){o=o||"down",e.attr({"data-wpse-tooltip":o,"aria-label":t,"data-wpse-visible":1,"data-wpse-tooltip-type":n}),e.on("hover",function(){e.removeAttr("data-wpse-visible")}),setTimeout(function(){a||e.removeAttr("data-wpse-tooltip"),e.removeAttr("data-wpse-visible")},8e3)}function vgseCleanObject(e){for(var t in e)e[t]||delete e[t]}function beParseParamsOld(e){for(var t={},o=e.split("&"),a=0;a<o.length;a++){var n=o[a].split("=");if(n[0]=decodeURIComponent(n[0]),void 0!==t[n[0]]&&vgseEndsWith(n[0],"[]"))if("string"==typeof t[n[0]]&&vgseEndsWith(n[0],"[]")){var r=[t[n[0]],n[1]];t[n[0]]=r}else t[n[0]].push(n[1]);else t[n[0]]=n[1]}return t}function beParseParams(e){function t(e){return decodeURIComponent(e.replace(n," "))}e=e.substring(e.indexOf("?")+1);for(var o,a=/([^&=]+)=?([^&]*)/g,n=/\+/g,r={};o=a.exec(e);){var s=t(o[1]),i=t(o[2]);"[]"===s.substring(s.length-2)?(r[s=s.substring(0,s.length-2)]||(r[s]=[])).push(i):r[s]=i}function d(e,t,o){for(var a=t.length-1,n=0;n<a;++n){var r=t[n];r in e||(e[r]={}),e=e[r]}e[t[a]]=o}for(var l in r){var u=l.split("[");if(1<u.length){var c=[];u.forEach(function(e,t){var o=e.replace(/[?[\]\\ ]/g,"");c.push(o)}),d(r,c,r[l]),delete r[l]}}return r}function beGetRowsFilters(){return jQuery("body").data("be-filters")?jQuery.param(jQuery("body").data("be-filters")):""}function vgseEndsWith(e,t){return-1!==e.indexOf(t,e.length-t.length)}function vgseMergeDeep(e){function r(e){return e&&"object"==typeof e}return e.reduce(function(a,n){return Object.keys(n).forEach(function(e){var t=a[e],o=n[e];Array.isArray(t)&&Array.isArray(o)?a[e]=t.concat([o]):r(t)&&r(o)?a[e]=vgseMergeDeep([t,o]):a[e]=o}),a},{})}function vgseGoToModal(e){var t=jQuery(".remodal-is-opened > .remodal");t.length?(t.one("closed",function(){jQuery('[data-remodal-id="'+e+'"]').remodal().open()}),t.remodal().close()):jQuery('[data-remodal-id="'+e+'"]').remodal().open()}function vgseDecodeURIComponentSafe(e){return e?decodeURIComponent(e.replace(/%(?![0-9][0-9a-fA-F]+)/g,"%25")):e}function beAddRowsFilter(e){if(!e)return!1;var t=jQuery("body").data("be-filters"),o=vgseMergeDeep([t=t||{},"string"==typeof e?beParseParams(e):e]);vgseCleanObject(o);var a=jQuery(".vgse-current-filters");return a.find(".button").remove(),a.each(function(){var d=jQuery(this);jQuery.each(o,function(e,t){if(t&&e.indexOf("meta_query")<0){var o="string"==typeof t?t:t.join(", ");20<(o=vgseDecodeURIComponentSafe(vgseStripHtml(o))).length&&(o=o.substring(0,20)+"...");var a=e.replace("[]","").replace(/_/g," ");d.append('<a href="#" class="button" data-filter-key="'+e+'"><i class="fa fa-remove"></i> '+a+": "+o+"</a>")}}),o.meta_query&&jQuery.each(o.meta_query,function(e,t){var o=t.key;if(o){var a=t.value,n=t.compare;20<(a=vgseDecodeURIComponentSafe(vgseStripHtml(a))).length&&(a=a.substring(0,20)+"...");var r="meta_query["+e+"][key]";d.find(".advanced-filter").filter(function(){return jQuery(this).data("filter-key")===r}).remove(),d.append('<a href="#" class="button advanced-filter" data-filter-key="'+r+'"><i class="fa fa-remove"></i> '+o+" "+n+" "+a+"</a>")}}),jQuery(".advanced-filters-list > li").each(function(){var e=jQuery(this),t=e.find(".wpse-advanced-filters-field-selector"),o=t.val();if(o){var a=t.attr("name"),n=e.find(".wpse-advanced-filters-value-selector").val(),r=e.find(".wpse-advanced-filters-operator-selector option:selected"),s=r.data("custom-label")||r.text();"ANY"===s&&(n=n.replace(";"," OR ").replace("  "," "));var i="string"==typeof n?n:n.join(", ");20<(i=vgseDecodeURIComponentSafe(vgseStripHtml(i))).length&&(i=i.substring(0,20)+"..."),d.find(".advanced-filter").filter(function(){return jQuery(this).data("filter-key")===a}).remove(),d.append('<a href="#" class="button advanced-filter" data-filter-key="'+a+'"><i class="fa fa-remove"></i> '+o+" "+s+" "+i+"</a>")}}),d.find(".button").length?d.css("display","inline-block"):d.hide()}),1<a.find(".button").length?a.append('<a href="#" class="button advanced-filter remove-all-filters"><i class="fa fa-remove"></i> '+vgse_editor_settings.texts.remove_all_filters+"</a>"):a.find(".remove-all-filters").remove(),jQuery("body").data("be-filters",o),o}function beAjaxLoop(e){var n=jQuery.extend({totalCalls:null,current:1,url:"",method:"GET",dataType:"json",data:{},prepareData:function(e,t){return e},onSuccess:function(e,t){},onError:function(e,t,o){},status:"running"},e);function r(){if(n.current<n.totalCalls+1){if("running"!==n.status)return 1;if(Array.isArray(n.data)){var o=!1,a=!1;n.data.forEach(function(e,t){"page"===e.name&&(n.data[t].value=n.current,o=!0),"totalCalls"===e.name&&(n.data[t].value=n.totalCalls,a=!0)}),o||n.data.push({name:"page",value:n.current}),a||n.data.push({name:"totalCalls",value:n.totalCalls})}else n.data.page=n.current,n.data.totalCalls=n.totalCalls;var e={url:n.url,dataType:n.dataType,data:n.prepareData(n.data,n),method:n.method};jQuery.ajax(e).done(function(e){n.onSuccess(e,n)&&(n.current++,setTimeout(function(){r()},1e3*parseInt(vgse_editor_settings.wait_between_batches)))}).fail(function(e,t){n.onError(e,t,n)&&(n.current++,setTimeout(function(){r()},1e3*parseInt(vgse_editor_settings.wait_between_batches)))})}}return r(),{pause:function(){n.status="paused"},resume:function(){n.status="running",r()}}}function loading_ajax(e){"boolean"==typeof e&&(e={estado:e});var t={estado:!0};jQuery.extend(t,e),1==t.estado?(jQuery("body").find(".sombra_popup").length||jQuery("body").append('<div class="sombra_popup be-ajax"><div class="sk-three-bounce"><div class="sk-child sk-bounce1"></div><div class="sk-child sk-bounce2"></div><div class="sk-child sk-bounce3"></div></div></div>'),jQuery(".sombra_popup").fadeIn(1e3)):jQuery(".sombra_popup").fadeOut(800,function(){})}function notification(e){var t={tipo:"success",mensaje:"",time:8600,position:"top"};jQuery.extend(t,e),setTimeout(function(){if("success"==t.tipo)var e="green";else e="error"==t.tipo?"red":"warning"==t.tipo?"orange":"blue";"bottom"===t.position?jQuery("#ohsnap").css({top:"auto",bottom:"5px"}):jQuery("#ohsnap").css({top:"",bottom:""}),jQuery("#ohsnap").css("z-index","1100000"),setTimeout(function(){jQuery("#ohsnap").css("z-index","-1")},t.time),jQuery("#ohsnap .alert").remove(),ohSnap(t.mensaje,{duration:t.time,color:e})},500)}function beLoadPosts(o,a,n,r){loading_ajax({estado:!0});var t=setTimeout(function(){jQuery(".wpse-stuck-loading").css("display","block")},5e3);jQuery(".automatic-loading-rows-disabled").remove(),n=n||!0,r=r||!1,o.action="vgse_load_data",o.wpse_source_suffix=vgse_editor_settings.wpse_source_suffix||"",o.paged||(o.paged=1),window.beCurrentPage=o.paged,o.filters=beGetRowsFilters(),window.beLastLoadRowsAjax=jQuery.ajax({url:vgse_editor_settings.ajax_url,dataType:"json",type:"POST",data:o,success:function(e){if(1===window.beCurrentPage&&0===window.location.hash.indexOf("#after_init:")&&(jQuery('[data-remodal-id="'+window.location.hash.replace("#after_init:","")+'"]').remodal().open(),window.location.hash=""),jQuery(".wpse-stuck-loading").hide(),clearTimeout(t),e.data.pagination&&(jQuery(".pagination-links").empty().append(e.data.pagination),jQuery(".pagination-jump input").attr("max",e.data.max_pages)),jQuery("#vgse-wrapper").css("min-width",jQuery("#post-data .wtHider").width()),jQuery("body").trigger("vgSheetEditor:beforeRowsInsert",[e,o,a,n,r]),"function"==typeof a&&(a(e),n))return!0;e.success?(vgseAddFoundRowsCount(e.data.total),vgAddRowsToSheet(e.data.rows,null,r),notification({mensaje:e.data.message||vgse_editor_settings.texts.posts_loaded,tipo:"info"}),loading_ajax({estado:!1})):(loading_ajax({estado:!1}),notification({mensaje:e.data.message,tipo:"info"}),vgseAddFoundRowsCount(0))},error:function(e,t){100<=vgse_editor_settings.posts_per_page&&(500<=e.status||"timeout"===t)&&(window.vgseDontNotifyServerError=!0,vgse_editor_settings.posts_per_page=10,o.wpse_reset_posts_per_page=vgse_editor_settings.posts_per_page,beLoadPosts(o,a,n,r),setTimeout(function(){loading_ajax({estado:!0})},200))}})}function vgseMd5(e){var a="0123456789abcdef";function t(e){var t,o="";for(t=0;t<=3;t++)o+=a.charAt(e>>8*t+4&15)+a.charAt(e>>8*t&15);return o}function d(e,t){var o=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(o>>16)<<16|65535&o}function i(e,t,o,a,n,r){return d((s=d(d(t,e),d(a,r)))<<(i=n)|s>>>32-i,o);var s,i}function o(e,t,o,a,n,r,s){return i(t&o|~t&a,e,t,n,r,s)}function n(e,t,o,a,n,r,s){return i(t&a|o&~a,e,t,n,r,s)}function r(e,t,o,a,n,r,s){return i(t^o^a,e,t,n,r,s)}function s(e,t,o,a,n,r,s){return i(o^(t|~a),e,t,n,r,s)}var l,u,c,p,g,f=function(e){var t,o=1+(e.length+8>>6),a=new Array(16*o);for(t=0;t<16*o;t++)a[t]=0;for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<t%4*8;return a[t>>2]|=128<<t%4*8,a[16*o-2]=8*e.length,a}(e),y=1732584193,m=-271733879,h=-1732584194,v=271733878;for(l=0;l<f.length;l+=16)y=s(y=r(y=r(y=r(y=r(y=n(y=n(y=n(y=n(y=o(y=o(y=o(y=o(u=y,c=m,p=h,g=v,f[l+0],7,-680876936),m=o(m,h=o(h,v=o(v,y,m,h,f[l+1],12,-389564586),y,m,f[l+2],17,606105819),v,y,f[l+3],22,-1044525330),h,v,f[l+4],7,-176418897),m=o(m,h=o(h,v=o(v,y,m,h,f[l+5],12,1200080426),y,m,f[l+6],17,-1473231341),v,y,f[l+7],22,-45705983),h,v,f[l+8],7,1770035416),m=o(m,h=o(h,v=o(v,y,m,h,f[l+9],12,-1958414417),y,m,f[l+10],17,-42063),v,y,f[l+11],22,-1990404162),h,v,f[l+12],7,1804603682),m=o(m,h=o(h,v=o(v,y,m,h,f[l+13],12,-40341101),y,m,f[l+14],17,-1502002290),v,y,f[l+15],22,1236535329),h,v,f[l+1],5,-165796510),m=n(m,h=n(h,v=n(v,y,m,h,f[l+6],9,-1069501632),y,m,f[l+11],14,643717713),v,y,f[l+0],20,-373897302),h,v,f[l+5],5,-701558691),m=n(m,h=n(h,v=n(v,y,m,h,f[l+10],9,38016083),y,m,f[l+15],14,-660478335),v,y,f[l+4],20,-405537848),h,v,f[l+9],5,568446438),m=n(m,h=n(h,v=n(v,y,m,h,f[l+14],9,-1019803690),y,m,f[l+3],14,-187363961),v,y,f[l+8],20,1163531501),h,v,f[l+13],5,-1444681467),m=n(m,h=n(h,v=n(v,y,m,h,f[l+2],9,-51403784),y,m,f[l+7],14,1735328473),v,y,f[l+12],20,-1926607734),h,v,f[l+5],4,-378558),m=r(m,h=r(h,v=r(v,y,m,h,f[l+8],11,-2022574463),y,m,f[l+11],16,1839030562),v,y,f[l+14],23,-35309556),h,v,f[l+1],4,-1530992060),m=r(m,h=r(h,v=r(v,y,m,h,f[l+4],11,1272893353),y,m,f[l+7],16,-155497632),v,y,f[l+10],23,-1094730640),h,v,f[l+13],4,681279174),m=r(m,h=r(h,v=r(v,y,m,h,f[l+0],11,-358537222),y,m,f[l+3],16,-722521979),v,y,f[l+6],23,76029189),h,v,f[l+9],4,-640364487),m=r(m,h=r(h,v=r(v,y,m,h,f[l+12],11,-421815835),y,m,f[l+15],16,530742520),v,y,f[l+2],23,-995338651),h,v,f[l+0],6,-198630844),m=s(m=s(m=s(m=s(m,h=s(h,v=s(v,y,m,h,f[l+7],10,1126891415),y,m,f[l+14],15,-1416354905),v,y,f[l+5],21,-57434055),h=s(h,v=s(v,y=s(y,m,h,v,f[l+12],6,1700485571),m,h,f[l+3],10,-1894986606),y,m,f[l+10],15,-1051523),v,y,f[l+1],21,-2054922799),h=s(h,v=s(v,y=s(y,m,h,v,f[l+8],6,1873313359),m,h,f[l+15],10,-30611744),y,m,f[l+6],15,-1560198380),v,y,f[l+13],21,1309151649),h=s(h,v=s(v,y=s(y,m,h,v,f[l+4],6,-145523070),m,h,f[l+11],10,-1120210379),y,m,f[l+2],15,718787259),v,y,f[l+9],21,-343485551),y=d(y,u),m=d(m,c),h=d(h,p),v=d(v,g);return t(y)+t(m)+t(h)+t(v)}function vgseGetFiltersJson(){return jQuery("body").data("be-filters")?JSON.stringify(jQuery("body").data("be-filters")):""}function beSetSaveButtonStatus(e){var t=jQuery(".button-container.auto_saving_status-container a"),o=jQuery("#vg-header-toolbar .wpse-save, #vg-header-toolbar .wpse-save-later");e?(vgseAllowToClosePageWithoutWarning(!1),o.each(function(){jQuery(this).attr("data-remodal-target",jQuery(this).data("original-remodal-target"))}),o.removeClass("disabled"),jQuery(".wpse-disable-if-unsaved-changes").each(function(){jQuery(this).addClass("disabled"),jQuery(this).attr("data-remodal-target-original",jQuery(this).attr("data-remodal-target")),jQuery(this).removeAttr("data-remodal-target")}),vgse_editor_settings.enable_auto_saving&&t.text(t.data("unsaved-changes"))):(vgseAllowToClosePageWithoutWarning(!0),o.each(function(){jQuery(this).attr("data-original-remodal-target",jQuery(this).data("remodal-target")),jQuery(this).removeAttr("data-remodal-target")}),o.addClass("disabled"),jQuery(".wpse-disable-if-unsaved-changes").each(function(){jQuery(this).removeClass("disabled"),jQuery(this).attr("data-remodal-target",jQuery(this).attr("data-remodal-target-original"))}),vgse_editor_settings.enable_auto_saving&&t.text(t.data("saved-changes")))}function beDeduplicateItems(e){if(!e||!e.length)return e;var a={},n=e[0]instanceof Array?"array":"object";return jQuery.each(e,function(e,t){var o="array"==n?t[0]:t.ID;"string"==typeof o&&(o=parseInt(o)),a[o]||(a[o]=t)}),a}function beGetModifiedObjectProperties(t,o){var a={};return Object.keys(o).forEach(function(e){"0"===e||"wpseBulkSelector"===e||t&&void 0!==t[e]&&o[e]==t[e]||(a[e]=o[e])}),a}function beArraysIdenticalCheck(e,t){if(e.length!==t.length)return!1;for(var o=e.length;o--;)if(e[o]!==t[o])return!1;return!0}function beGetModifiedItems(n,r){n=n||hot.getSourceData(),r=r||window.beOriginalData,n=beDeduplicateItems(n),r=beDeduplicateItems(r);var s=[];return jQuery.each(n,function(e,t){var o,a=beGetModifiedObjectProperties(r[e],n[e]);void 0!==r[e]&&jQuery.isEmptyObject(a)||(o=!r[e]||r[e].provider&&vgse_editor_settings.saveFullRowPostTypes&&-1<vgse_editor_settings.saveFullRowPostTypes.indexOf(r[e].provider)?n[e]:(a.ID=e,a),s.push(o))}),s}function beGetTinymceContent(){if("none"!==jQuery(".wp-editor-area").css("display"))var e=jQuery(".wp-editor-area").val()||"";else e=document.getElementById("editpost_ifr")?(document.getElementById("editpost_ifr").contentWindow.document||document.getElementById("editpost_ifr").contentDocument).body.innerHTML:"";return e}function vgseExecuteFunctionByName(e,t){e=e.trim();for(var o=[].slice.call(arguments).splice(2),a=e.split("."),n=a.pop(),r=0;r<a.length;r++)t=t[a[r]];return t[n].apply(t,o)}function vgObjectToArray(e){var t=[];for(var o in e)t.push(e[o]);return t}function _debounce(t,o,a){var n,r,s,i,d,l=function(){var e=_now()-i;e<o&&0<=e?n=setTimeout(l,o-e):(n=null,a||(d=t.apply(s,r),n||(s=r=null)))};return function(){s=this,r=arguments,i=_now();var e=a&&!n;return n=n||setTimeout(l,o),e&&(d=t.apply(s,r),s=r=null),d}}function _now(){return Date.now()||(new Date).getTime()}function _throttle(o,a,n){var r,s,i;a=a||300;var d=null,l=0;function u(){l=!1===n.leading?0:_now(),d=null,i=o.apply(r,s),d||(r=s=null)}return n=n||{},function(){var e=_now();l||!1!==n.leading||(l=e);var t=a-(e-l);return r=this,s=arguments,t<=0||a<t?(d&&(clearTimeout(d),d=null),l=e,i=o.apply(r,s),d||(r=s=null)):d||!1===n.trailing||(d=setTimeout(u,t)),i}}function vgseRemoveRowFromSheetByID(e,t){if(e.length){var o=hot.getSourceData();e.forEach(function(e){o=vgseRemoveRowFromArray(e,o)}),hot.loadData(o),t&&vgseAddFoundRowsCount(parseInt(jQuery(".be-total-rows .item-value").text())-e.length)}}function vgseRemoveRowFromArray(a,e){var n=[];return a=parseInt(a),e.forEach(function(e,t){var o=jQuery.extend(!0,{},e);"string"==typeof o.ID&&(o.ID=parseInt(o.ID)),a!==o.ID&&n.push(e)}),n}function vgAddRowsToSheet(e,t,o){window.beOriginalData||(window.beOriginalData=[]),e=e||[],"prepend"===(t=t||"append")&&(e=e.reverse());var a=hot.getSourceData();o&&e.forEach(function(e,t){var o=jQuery.extend(!0,{},e);o.ID=parseInt(o.ID),a=vgseRemoveRowFromArray(o.ID,a),window.beOriginalData=vgseRemoveRowFromArray(o.ID,window.beOriginalData)});var n=a.map(function(e){return e.ID});for(i=0;i<e.length;i++)n.indexOf(e[i].ID)<0&&("append"===t?a.push(jQuery.extend(!0,{},e[i])):a.unshift(jQuery.extend(!0,{},e[i])));hot.loadData(a),jQuery("body").trigger("vgSheetEditor:afterRowsInsert",[e,t,o]),window.beOriginalData=jQuery.merge(window.beOriginalData,e)}function wpsePrepareGalleryFilesForCellFormat(e,t){var o=hot.colToProp(t.col),a=vgse_editor_settings.final_spreadsheet_columns_settings[o],n=a&&void 0!==a.wp_media_multiple&&a.wp_media_multiple,r=hot.getDataAtCell(t.row,t.col),s=n&&r?r.split(","):[];jQuery.each(e,function(e,t){s.push(t.url+"?wpId="+t.id)}),hot.setDataAtCell(t.row,t.col,s.join(","))}function vgseInitSelect2(e){(e=e||jQuery("select.select2")).each(function(){var e={placeholder:jQuery(this).data("placeholder"),minimumInputLength:jQuery(this).data("min-input-length")||0,allowClear:!0};jQuery(this).data("remote")&&(e.ajax={url:vgse_editor_settings.ajax_url,delay:1e3,data:function(e){return{search:e.term,page:e.page,action:jQuery(this).data("action"),global_search:jQuery(this).data("global-search")||"",output_format:jQuery(this).data("output-format"),taxonomies:jQuery(this).data("taxonomies"),post_type:jQuery(this).data("post-type")||jQuery("#post-data").data("post-type"),nonce:jQuery("#vgse-wrapper").data("nonce")}},processResults:function(e){return e.success?{results:e.data.data}:{results:[]}},cache:!0}),jQuery(this).select2(e)})}function vgseReloadSpreadsheet(e,t,o){if(e){t=t||vgse_editor_settings.texts.save_changes_reload_optional;var a=hot.getSourceData();if((a=beGetModifiedItems(a,window.beOriginalData)).length)return alert(t),!0}var n=jQuery(".remodal-bg").data("nonce"),r=jQuery("#post-data");window.beOriginalData=[],hot.loadData([]),beLoadPosts({post_type:r.data("post-type"),nonce:n,paged:o||1})}function vgseAddFoundRowsCount(e){window.beFoundRows=e,jQuery(".be-total-rows .item-value").text(e),window.wpseUpdateBulkEditRowsCount&&(jQuery(".modal-formula .rows-to-be-updated-total span").text(e),window.wpseUpdateBulkEditRowsCount=!1)}function vgseGetRowTitle(e){var t=window.vgseFormulasBulkSelectorExists?2:1;return vgse_editor_settings.is_post_type?hot.getDataAtRowProp(e,"post_title"):hot.getDataAtCell(e,t)}function vgseInputToFormattedColumnField(s,i,e){if(void 0!==vgse_editor_settings.final_spreadsheet_columns_settings[s]){var n=vgse_editor_settings.final_spreadsheet_columns_settings[s],t=i.find(e),o=t.attr("name"),a=t.attr("class");if(!t.is("input")&&!t.is("textarea")||t.attr("type")&&"text"!==t.attr("type"))return!0;if(void 0!==n.formatted.editor&&"select"===n.formatted.editor)t.replaceWith('<select class="'+a+'" name="'+o+'"><option value="">('+vgse_editor_settings.texts.empty+")</option></select>"),(r=i.find("select"+e)).each(function(){var o=jQuery(this);jQuery.each(n.formatted.selectOptions,function(e,t){jQuery.isNumeric(e)&&(e=t),o.append('<option value="'+e+'">'+t+"</option>")})});else if(void 0!==n.formatted.type&&"autocomplete"===n.formatted.type&&"string"==typeof n.formatted.source&&"searchUsers"===n.formatted.source)t.replaceWith('<input class="'+a+'" name="'+o+'" list="wpse-bulk-edit-users-list-'+s+'"><datalist class="'+a+'" id="wpse-bulk-edit-users-list-'+s+'"></datalist>'),i.find('input[list="wpse-bulk-edit-users-list-'+s+'"]').keyup(_throttle(function(e){var t=jQuery(this).val();if(!t)return!0;var o=jQuery(this);if(o.data("last-query")===t)return!0;o.data("last-query",t);var a=jQuery(".remodal-bg").data("nonce"),n=vgse_editor_settings.post_type,r=i.find("datalist#wpse-bulk-edit-users-list-"+s);jQuery.ajax({url:vgse_editor_settings.ajax_url,dataType:"json",data:{action:"vgse_find_users_by_keyword",search:t,nonce:a,post_type:n,wpse_source:"users_dropdown_column"},success:function(e){var t=[];e.success&&(t=e.data.data),r.empty(),t.forEach(function(e){r.append('<option value="'+e+'">'+e+"</option>")})}})},1500,{leading:!0,trailing:!0}));else if(void 0!==n.formatted.type&&"autocomplete"===n.formatted.type&&"object"==typeof n.formatted.source)t.replaceWith('<select class="'+a+'" name="'+o+'"><option value="">('+vgse_editor_settings.texts.empty+")</option></select>"),(r=i.find("select"+e)).each(function(){var o=jQuery(this);jQuery.each(n.formatted.source,function(e,t){jQuery.isNumeric(e)&&(e=t),o.append('<option value="'+e+'">'+t+"</option>")})});else if(void 0!==n.formatted.type&&"checkbox"===n.formatted.type)t.replaceWith('<input type="checkbox" class="'+a+'" name="'+o+'">'),(r=i.find("input"+e+":checkbox")).on("change",function(){jQuery(this).is(":checked")?(jQuery(this).val(n.formatted.checkedTemplate),jQuery(this).data("checked-value",n.formatted.checkedTemplate)):(jQuery(this).val(n.formatted.uncheckedTemplate),jQuery(this).data("unchecked-value",n.formatted.uncheckedTemplate))}),r.trigger("change");else if(void 0!==n.formatted.type&&"date"===n.formatted.type){var r;t.replaceWith('<input type="date" class="'+a+'">'),(r=i.find("input"+e)).after('<input type="hidden" name="'+o+'" class="wpse-hidden-timestamp '+a+'" />'),r.on("change",function(){var e=jQuery(this).val();if(e){var t=moment.utc(e+" 0:00:00","YYYY-MM-DD H:mm:ss");if(!(o=n.formatted.customDatabaseFormatJs||n.formatted.dateFormatJs))var o=n.formatted.customDatabaseFormat||n.formatted.dateFormat;var a=t.format(o)}else a="";i.find(".wpse-hidden-timestamp").val(a)}),r.trigger("change")}}}function vgseRemoveAllFilters(e){jQuery("body").data("be-filters",{}),jQuery(".vgse-current-filters .button").remove(),e&&vgseReloadSpreadsheet()}function vgseInitLazySelects(){jQuery("select[data-lazy-key]:not([data-already-lazy])").each(function(){vgseLazySelect(jQuery(this),jQuery(this).data("lazy-key"))})}function vgseLazySelect(a,n){if(a.attr("multiple"))return!0;function t(){var e=a.find("option:selected");e&&e.parent("optgroup").length&&e.parent("optgroup"),a.find("option").not(e).not(a.find('option[value=""]')).remove(),a.find("optgroup").each(function(){jQuery(this).children().length||jQuery(this).remove()})}vgse_editor_settings.lazy_loaded_select_options||(vgse_editor_settings.lazy_loaded_select_options={});var e={};vgse_editor_settings.lazy_loaded_select_options&&vgse_editor_settings.lazy_loaded_select_options[n]||(a.find("option").each(function(){jQuery(this).parent("optgroup").length?(void 0===e[jQuery(this).parent("optgroup").attr("label")]&&(e[jQuery(this).parent("optgroup").attr("label")]={}),e[jQuery(this).parent("optgroup").attr("label")][jQuery(this).val()]=jQuery(this).text()):e[jQuery(this).val()]=jQuery(this).text()}),vgse_editor_settings.lazy_loaded_select_options[n]=e),a.find("option").length||"string"!=typeof a.data("selected")||a.append('<option value="'+vgseStripHtml(a.data("selected"))+'">'+vgseStripHtml(vgse_editor_settings.lazy_loaded_select_options[n][a.data("selected")])+"</option>"),t(),a.on("focus",function(e){var t=vgse_editor_settings.lazy_loaded_select_options[n];if(t){var o=a.val();a.empty(),jQuery.each(t,function(o,e){"string"==typeof e?a.append('<option value="'+vgseStripHtml(o)+'">'+vgseStripHtml(e)+"</option>"):(a.append('<optgroup label="'+vgseStripHtml(o)+'"></optgroup>'),jQuery.each(e,function(e,t){a.find('optgroup[label="'+vgseStripHtml(o)+'"]').append('<option value="'+vgseStripHtml(e)+'">'+vgseStripHtml(t)+"</option>")}))}),a.val(o)}}),a.on("blur",function(e){t()})}function vgseSetSettings(e,t,o){e.push({name:"nonce",value:jQuery("#vgse-wrapper").data("nonce")}),e.push({name:"action",value:"vgse_set_settings"}),o||loading_ajax(!0),jQuery.ajax({url:ajaxurl,method:"POST",data:e,success:function(e){o||loading_ajax(!1),window.location.hash="",e.success&&t&&window.location.reload()}})}function vgseGetSelectedRowsCount(e){var t=window.beFoundRows;return"selected"===e.find(".wpse-select-rows-options").val()&&(t=vgseGetSelectedIds().length),"previously_selected"===e.find(".wpse-select-rows-options").val()&&(t=(window.wpsePreviouslySelectedIds||[]).length),t}function vgseGetSelectedIds(){var e=hot.getDataAtCol(0),o=[];return e.forEach(function(e,t){e&&o.push(hot.getDataAtRowProp(t,"ID"))}),o}function vgseDeleteRowsById(t){loading_ajax(!0),jQuery.post(vgse_editor_settings.ajax_url,{action:"vgse_delete_row_ids",nonce:jQuery("#vgse-wrapper").data("nonce"),post_type:vgse_editor_settings.post_type,ids:t},function(e){loading_ajax(!1),e.success?(notification({mensaje:e.data.message}),vgseRemoveRowFromSheetByID(t,!0)):notification({mensaje:e.data.message,tipo:"error",tiempo:6e4})})}jQuery(window).on("beforeunload",function(){if(jQuery(".be-spreadsheet-wrapper").length)var e=beGetModifiedItems(hot.getSourceData(),window.beOriginalData);else e=[];if(jQuery(".be-spreadsheet-wrapper").length&&e.length&&!vgseClosePageWithoutWarning)return vgse_editor_settings.texts.save_changes_on_leave}),jQuery(document).ready(function(){var e=jQuery(".quick-setup-page-content");if(!e.length)return!0;function r(){jQuery(".setup-step.active").removeClass("active").next().addClass("active"),jQuery(" #vgse-wrapper .progressbar li.active").removeClass("active").next().addClass("active")}e.find(".step-back").on("click",function(e){e.preventDefault(),jQuery(".setup-step.active").removeClass("active").prev().addClass("active"),jQuery(" #vgse-wrapper .progressbar li.active").removeClass("active").prev().addClass("active")}),e.find(".save-all-trigger").on("click",function(e){e.preventDefault();var t=jQuery(this).parents(".setup-step"),o=t.find("form");if(loading_ajax({estado:!0}),!o.length)return r(),loading_ajax({estado:!1}),!0;t.find(".save-trigger").each(function(){jQuery(this).trigger("click")});var a=t.find(".save-trigger").length,n=setInterval(function(){t.find(".save-trigger").filter(function(){return"yes"===jQuery(this).data("saved")}).length===a&&(clearInterval(n),r(),loading_ajax({estado:!1}))},800)}),e.find(".save-trigger").on("click",function(e){e.preventDefault();var t=jQuery(this),o=t.parents("form"),a=o.data("callback");jQuery.post(o.attr("action"),o.serializeArray(),function(e){t.data("saved","yes"),a&&vgseExecuteFunctionByName(a,window,{response:e,form:o})})})}),jQuery(document).ready(function(){jQuery("body").on("click",".form-submit-outside",function(e){e.preventDefault(),jQuery(this).parents(".remodal").find("form .form-submit-inside").trigger("click")}),jQuery(document).on("opened",".remodal",function(e){var t=jQuery(document).scrollTop(),o=jQuery("#infinito").prop("checked");jQuery("#infinito").prop("checked",!1),jQuery("body").data("temp-status",o).data("temp-scrolltop",t);var a=jQuery("html,body").scrollLeft();jQuery("body").data("temp-scrollleft",a)}),jQuery(document).on("closed",".remodal",function(){var e=jQuery("body").data("temp-scrolltop"),t=jQuery("body").data("temp-scrollleft"),o=jQuery("body").data("temp-status");e&&jQuery(window).scrollTop(e),t&&jQuery("html,body").scrollLeft(t),o&&jQuery("#infinito").prop("checked",o)}),jQuery("body").on("click","[data-wpse-remodal-target]",function(){vgseGoToModal(jQuery(this).data("wpse-remodal-target"))})}),jQuery(document).ready(function(){jQuery("body").on("click",".button-custom-modal-editor",function(e){e.preventDefault();var t=jQuery(this),o=t.data(),a=t.parent("td");if(a.length){var n=hot.getCoords(a[0]);if(window.wpseCurrentPopupSourceCoords=n,o.modalSettings.use_new_handsontable_renderer){var r=hot.getDataAtCell(window.wpseCurrentPopupSourceCoords.row,window.wpseCurrentPopupSourceCoords.col);window.wpseCurrentPopupSourceCoords.cellValue=r?JSON.parse(r):{}}}window.hotModalCache||(window.hotModalCache={}),window.hotModalCache[o.modalSettings.post_id]||(window.hotModalCache[o.modalSettings.post_id]={});var s=jQuery(".custom-modal-editor");if(a.length){var i=hot.countRows(),d=n.row;0===d?s.find("button.anterior").hide():s.find("button.anterior").show(),d===i-1?s.find("button.siguiente").hide():s.find("button.siguiente").show(),s.find("button.anterior").data("pos",d-1),s.find("button.siguiente").data("pos",d+1)}if("metabox"===o.modalSettings.type)var l=null;else"string"==typeof(l=window.hotModalCache&&window.hotModalCache[o.modalSettings.post_id][o.modalSettings.edit_modal_save_action]?window.hotModalCache[o.modalSettings.post_id][o.modalSettings.edit_modal_save_action]:o.existing)&&(l=l||"{}",l=JSON.parse(l));var u={button:t,modalSettings:o.modalSettings,existing:l};window.vgseWCAttsCurrent=u,setTimeout(function(){s.remodal().open()},500),s.addClass("modal-editor-"+o.modalSettings.key)}),jQuery("body").on("click",".custom-modal-editor .remodal-cancel",function(e){var t=jQuery(this).parents(".custom-modal-editor"),o=window.vgseWCAttsCurrent;o.modalSettings.edit_modal_cancel_action&&(loading_ajax({estado:!0}),o.modalSettings.edit_modal_cancel_action.replace("js_function_name:","").split(",").forEach(function(e){vgseExecuteFunctionByName(e,t.find("iframe")[0].contentWindow)}),loading_ajax(!1))}),jQuery("body").on("click",".custom-modal-editor .save-changes-handsontable",function(e){var o=jQuery(this).parents(".custom-modal-editor"),a=jQuery(".remodal-bg").data("nonce"),n=window.vgseWCAttsCurrent;if(loading_ajax({estado:!0}),"handsontable"===n.modalSettings.type)var r=hotAttr.getSourceData();else if("metabox"===n.modalSettings.type)if(-1<n.modalSettings.metabox_value_selector.indexOf("js_function_name:")){var t=n.modalSettings.metabox_value_selector.replace("js_function_name:","");r=vgseExecuteFunctionByName(t,o.find("iframe")[0].contentWindow)}else{var s=o.find("iframe").contents().find(n.modalSettings.metabox_value_selector);r=1===s.length?s.val():beParseParams(s.serialize())}window.hotModalCache||(window.hotModalCache={}),window.hotModalCache[n.modalSettings.post_id]||(window.hotModalCache[n.modalSettings.post_id]={}),n.modalSettings.edit_modal_get_action||(n.button.data("existing",r),window.hotModalCache[n.modalSettings.post_id][n.modalSettings.edit_modal_save_action]=r),"handsontable"===n.modalSettings.type&&n.modalSettings.use_new_handsontable_renderer&&hot.setDataAtCell(window.wpseCurrentPopupSourceCoords.row,window.wpseCurrentPopupSourceCoords.col,JSON.stringify(r)),n.modalSettings.edit_modal_save_action.split(",").forEach(function(e){if(-1<e.indexOf("js_function_name:")){var t=e.replace("js_function_name:","");vgseExecuteFunctionByName(t,o.find("iframe")[0].contentWindow)}else jQuery.post(vgse_editor_settings.ajax_url,{action:e,nonce:a,postId:n.modalSettings.post_id,postType:n.modalSettings.post_type,modalSettings:n.modalSettings,data:r},function(e){})}),jQuery(".custom-modal-editor").remodal().close(),loading_ajax({estado:!1})}),jQuery(document).on("closed",".custom-modal-editor",function(){var e=window.vgseWCAttsCurrent,t=jQuery(".custom-modal-editor");"metabox"===e.modalSettings.type&&void 0!==window.vgcaIsFrontendSession&&window.vgcaIsFrontendSession.length&&(t.find("iframe").remove(),t.find(".vgca-iframe-wrapper ").hide(),window.vgcaIsFrontendSession.forEach(function(e,t){clearInterval(e)})),"handsontable"===e.modalSettings.type&&window.hotAttr&&!window.hotAttr.isDestroyed&&window.hotAttr.destroy(),t.find(".modal-general-title, .modal-description").hide(),jQuery(".custom-modal-editor").removeClass("modal-editor-"+e.modalSettings.key),loading_ajax({estado:!1})}),jQuery(document).on("opened",".custom-modal-editor",function(){var t=window.vgseWCAttsCurrent;if(!t)return!0;loading_ajax({estado:!0});var e=jQuery(".custom-modal-editor");if(e.data("column-key",t.modalSettings.key),e.find(".modal-post-title").length||e.find(".modal-general-title").after('<span class="modal-post-title"></span>'),e.find(".modal-post-title").html(t.modalSettings.post_title),t.modalSettings.edit_modal_title&&e.find(".modal-general-title").html(t.modalSettings.edit_modal_title+": "),t.modalSettings.edit_modal_description&&e.find(".modal-description").html(t.modalSettings.edit_modal_description),e.find(".modal-general-title, .modal-description").show(),window.hotModalCache||(window.hotModalCache={}),window.hotModalCache[t.modalSettings.post_id]||(window.hotModalCache[t.modalSettings.post_id]={}),t.modalSettings.edit_modal_get_action){var o=jQuery(".remodal-bg").data("nonce");jQuery.get(vgse_editor_settings.ajax_url,{action:t.modalSettings.edit_modal_get_action,nonce:o,postId:t.modalSettings.post_id}).done(function(e){initHandsontableForPopup(e.data,t.modalSettings)})}else{if(window.hotModalCache&&window.hotModalCache[t.modalSettings.post_id][t.modalSettings.edit_modal_save_action])var a=window.hotModalCache[t.modalSettings.post_id][t.modalSettings.edit_modal_save_action];else a=t.existing;initHandsontableForPopup(a,t.modalSettings)}}),jQuery("body").on("click","button.remodal-confirm, a.remodal-cancel, .media-button-insert",function(e){"submit"===jQuery(this).attr("type")||jQuery(this).hasClass("submit")||e.preventDefault()})}),jQuery(document).ready(function(){jQuery(".vgse-current-filters").on("click",".button",function(e){e.preventDefault();var t=jQuery(this),o=hot.getSourceData();if((o=beGetModifiedItems(o,window.beOriginalData)).length)return alert(vgse_editor_settings.texts.save_changes_before_remove_filter),!0;var a=[];t.hasClass("remove-all-filters")?(jQuery(".vgse-current-filters .button:not(.remove-all-filters)").each(function(){a.push(jQuery(this).data("filter-key"))}),jQuery(".vgse-current-filters .button").remove(),jQuery("body").data("be-filters",{})):(a.push(t.data("filter-key")),t.remove()),a.forEach(function(e){e&&(jQuery("#be-filters").find("input,select,textarea").filter(function(){return jQuery(this).attr("name")===e&&"checkbox"!==jQuery(this).attr("type")}).val("").trigger("change"),jQuery("#be-filters").find("input:checkbox").filter(function(){return jQuery(this).attr("name")===e}).prop("checked",!1).trigger("change"),beAddRowsFilter(e+"="))}),vgseReloadSpreadsheet()})}),jQuery(document).ready(function(){var o=jQuery(".post-type-setup-wizard");if(!o.length)return!1;o.find("form.inline-add").on("submit",function(e){var t=jQuery(this),o=t.data("callback");return jQuery.ajax({method:t.attr("method"),url:t.attr("action"),data:t.serialize()+"&current_post_type="+jQuery(".post-types-form input:radio:checked").val()}).done(function(e){t.find("input:text").val(""),t.find("input:text").first().focus(),vgseExecuteFunctionByName(o,window,{response:e,form:t})}),!1});var e=o.find(".post-types-form").data("custom-post-types").split(",");jQuery.each(e,function(e,t){o.find(".post-types-form .post-type-"+t).append('<button class="button vgse-delete-post-type" data-post-type="'+t+'"><i class="fa fa-remove"></i></button>')}),o.on("click",".vgse-delete-post-type",function(e){e.preventDefault();var t=jQuery(this).data("post-type");if(!confirm(o.find(".post-types-form").data("confirm-delete")))return!0;jQuery.post(ajaxurl,{post_type:t,action:"vgse_delete_post_type",nonce:jQuery(".post-type-setup-wizard").data("nonce")},function(e){e.success&&(notification({mensaje:e.data.message,tipo:"success",tiempo:3e3}),o.find(".post-types-form .post-type-"+t).remove())})})}),jQuery(document).ready(function(){var t=jQuery(".quick-setup-page-content .post-type-field input");if(!t.length)return!1;var a=jQuery(".quick-setup-page-content .post-types-enabled");t.on("change",function(e){a.empty(),t.each(function(){var e=jQuery(this).val();if(jQuery(this).is(":checked")){var t=jQuery(this).siblings("label").text(),o='<a class="button post-type-'+vgseStripHtml(e)+'" href="admin.php?page=vgse-bulk-edit-'+vgseStripHtml(e)+'">Edit '+vgseStripHtml(t)+"</a> - ";a.append(o)}})})}),jQuery(document).ready(function(){jQuery("body").on("change","input.wpse-set-settings, textarea.wpse-set-settings, select.wpse-set-settings",function(e){e.preventDefault();var t=jQuery(this).attr("name"),o=jQuery(this).val(),a=parseInt(jQuery(this).data("reload-after-success")),n=parseInt(jQuery(this).data("silent-action"));if(!t)return!0;vgseSetSettings([{name:"settings["+t+"]",value:o}],a,n)}),jQuery("body").on("click","a.wpse-set-settings",function(e){e.preventDefault();var t=jQuery(this).data("name"),o=jQuery(this).data("value"),a=parseInt(jQuery(this).data("reload-after-success")),n=parseInt(jQuery(this).data("silent-action"));if(!t)return!0;vgseSetSettings([{name:"settings["+t+"]",value:o}],a,n)}),jQuery("body").on("submit","form.wpse-set-settings",function(e){var t=parseInt(jQuery(this).data("reload-after-success")),o=parseInt(jQuery(this).data("silent-action"));return vgseSetSettings(jQuery(this).serializeArray(),t,o),!1}),jQuery(".tabs-links a").on("click",function(e){e.preventDefault(),jQuery(".tabs-links a").removeClass("tab-active"),jQuery(this).addClass("tab-active");var t=jQuery(this).attr("href").replace("#",""),o=jQuery(this).parents(".tabs-links"),a=o.next().find("."+t);o.next().find(".tab-content").hide(),a.show()}),jQuery(".tabs-links").each(function(){jQuery(this).find("a").first().click()})}),jQuery(document).ready(function(){jQuery(".toolbar-submenu [data-saved-item]").each(function(){jQuery(this).after('<button type="button" class="wpse-delete-saved-item wpse-delete-saved-search">x</button>')}),jQuery("body").on("click",".wpse-delete-saved-item",function(e){e.preventDefault();var t=jQuery(this),o="confirm_delete_"+t.prev().data("saved-type")+"_item";if(vgse_editor_settings.texts[o]&&!confirm(vgse_editor_settings.texts[o]))return!1;var a={nonce:jQuery("#vgse-wrapper").data("nonce"),post_type:jQuery("#post-data").data("post-type"),action:"vgse_delete_saved_"+t.prev().data("saved-type"),search_name:t.prev().data("item-name")},n=t.prev().data("reload");t.parent().remove(),jQuery.post(ajaxurl,a,function(e){n&&window.location.reload()})})}),jQuery(document).ready(function(){if(!jQuery(".vg-toolbar .button-container.require-click-to-expand").length)return!0;jQuery(".vg-toolbar .require-click-to-expand > button").on("click",function(e){var t=jQuery(this).parent();jQuery(".vg-toolbar .require-click-to-expand.expand-submenu").not(t).removeClass("expand-submenu"),t.toggleClass("expand-submenu")}),jQuery("body").on("click",function(e){var t=jQuery(e.target);!jQuery(".button-container.expand-submenu").length||t.parents(".require-click-to-expand").length||t.parents(".select2-container").length||jQuery(".vg-toolbar .button-container.require-click-to-expand.expand-submenu").removeClass("expand-submenu")})}),jQuery(document).ready(function(){vgseInitLazySelects()}),jQuery(document).ready(function(){if(jQuery(window).width()<768)return!0;var e=jQuery(".remodal.remodal-draggable");if(!e.length)return!0;e.each(function(){var e=jQuery(this);e.append('<i class="fa fa-arrows drag-modal"></i>'),function(e,t){var o=0,a=0,n=0,r=0;document.getElementById(e.id+"header")?document.getElementById(e.id+"header").onmousedown=s:e.onmousedown=s;function s(e){(e=e||window.event).preventDefault(),n=e.clientX,r=e.clientY,document.onmouseup=d,document.onmousemove=i}function i(e){(e=e||window.event).preventDefault(),o=n-e.clientX,a=r-e.clientY,n=e.clientX,r=e.clientY,t.style.top=t.offsetTop-a+"px",t.style.left=t.offsetLeft-o+"px"}function d(){document.onmouseup=null,document.onmousemove=null}}(e.find(".drag-modal")[0],e[0])}),jQuery(document).on("opened",".remodal",function(e){var t=jQuery(this);t.hasClass("remodal-draggable")&&t.css({left:t[0].offsetLeft,position:"absolute",top:t[0].offsetTop})}),jQuery(document).on("closed",".remodal",function(e){var t=jQuery(this);t.hasClass("remodal-draggable")&&t.css({left:"",position:"",top:""})})}),jQuery(document).ready(function(){var $=jQuery;function n(a){$.get(ajaxurl,{action:a.data("ajax-action"),nonce:jQuery(".remodal-bg").data("nonce"),postType:vgse_editor_settings.post_type,is_editor_page:!0},function(e){if(e.success){var t=jQuery(e.data.html);if(a.find(".modal-content").replaceWith(t.find(".modal-content")),a.removeClass("lazy-modal-content"),a.trigger("vgSheetEditor:remodal:ajaxContentInserted",e),$("body").trigger("vgSheetEditor:remodal:ajaxContentInserted",e),a.data("live-refresh")&&!a.data("intervalId")){var o=setInterval(function(){a.data("pauseAutoReload")||n(a)},1e3*parseInt(a.data("live-refresh")));a.data("intervalId",o)}}})}jQuery(document).on("opening",".remodal[data-ajax-action]",function(){n(jQuery(this))}),jQuery(document).on("closed",".remodal[data-ajax-action]",function(){var e=parseInt(jQuery(this).data("intervalId"));e&&(clearInterval(e),jQuery(this).data("intervalId",!1))}),jQuery(document).on("vgSheetEditor:refreshRemodalContent",".remodal[data-ajax-action]",function(){jQuery(this).is(":visible")&&n(jQuery(this))})}),jQuery(document).ready(function(){if("undefined"==typeof hot)return!0;hot.updateSettings({cells:function(e,t,o){var a=this.instance.toVisualRow(e),n={};"object"==typeof vgse_editor_settings.columnsBackgroundColors&&"string"==typeof vgse_editor_settings.columnsBackgroundColors[o]&&vgse_editor_settings.columnsBackgroundColors[o]?n.className="bg-"+vgse_editor_settings.columnsBackgroundColors[o].replace("#",""):n.className&&-1<n.className.indexOf("bg-")&&delete n.className;var r=vgse_editor_settings.final_spreadsheet_columns_settings[o];if(r){if(!r.is_locked&&(vgse_editor_settings.watch_cells_to_lock||"post_status"===o))if((i=hot.getDataAtCell(a,t))&&"string"==typeof i&&-1<i.indexOf("vg-cell-blocked"))if(n.renderer="wp_locked",n.readOnly=!0,n.editor=!1,n.fillHandle=!1,vgse_editor_settings.allow_cell_comments)"product_variation"===(s=hot.getDataAtRowProp(a,"post_type"))&&vgse_editor_settings.texts.column_for_parent_products_only?n.comment={value:vgse_editor_settings.texts.column_for_parent_products_only}:"product"===s&&vgse_editor_settings.texts.column_for_variations_only&&(n.comment={value:vgse_editor_settings.texts.column_for_variations_only});if(r.is_locked&&r.allow_to_save&&-1<vgse_editor_settings.lockedColumnsManuallyEnabled.indexOf(o)&&((n=r.formatted).readOnly=!1,n.fillHandle=!0,n.renderer=r.formatted.renderer||"text"),vgse_editor_settings.post_type===vgse_editor_settings.woocommerce_product_post_type_key&&"post_status"===o){n.selectOptions=r.formatted.selectOptions;var s,i=hot.getDataAtCell(a,t);"product_variation"===(s=hot.getDataAtRowProp(a,"post_type"))&&(n.selectOptions={publish:n.selectOptions.publish,delete:n.selectOptions.delete})}}return n}})}),function(s){"use strict";var e=s.editors.SelectEditor.prototype.extend();e.prototype.prepare=function(e,t,o,a,n,r){s.editors.SelectEditor.prototype.prepare.apply(this,arguments),this.options={},this.cellProperties.chosenOptions&&(this.options=jQuery.extend(this.options,r.chosenOptions)),r.chosenOptions=jQuery.extend({},r.chosenOptions)},e.prototype.init=function(){s.editors.SelectEditor.prototype.init.apply(this,arguments),this.createElements()},e.prototype.createElements=function(){this.$body=jQuery(document.body),this.select.setAttribute("multiple","multiple"),this.$select=jQuery(this.select),this.TEXTAREA_PARENT=document.createElement("DIV"),s.dom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.textareaParentStyle.width="200px",this.TEXTAREA_PARENT.appendChild(this.select),this.$parent=jQuery(this.TEXTAREA_PARENT),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var e=this;this.instance._registerTimeout(setTimeout(function(){e.refreshDimensions()},0))},e.prototype.open=function(o){this.instance.addHook("beforeKeyDown",r),s.editors.SelectEditor.prototype.open.apply(this,arguments),this.$parent.css({display:"block",top:this.$select.css("top"),left:this.$select.css("left"),margin:this.$select.css("margin")}),this.$select.css({height:jQuery(this.TD).height()+4,"min-width":jQuery(this.TD).outerWidth()-4}),this.$select.hide();var e=jQuery.extend({},this.options,{width:"100%",search_contains:!0});jQuery(this.TEXTAREA_PARENT).find(".chosen-container").length&&this.$select.chosen("destroy"),this.$select.chosen(e);var a=this;this.options.ajaxParams&&(this.options.ajaxParams.nonce=jQuery(".remodal-bg").data("nonce"),this.options.ajaxParams.columnKey=a.prop,this.options.ajaxParams.wpse_source="chosen_column",this.options.ajaxParams.post_type=vgse_editor_settings.post_type,void 0===window.wpseChosenTerms&&(window.wpseChosenTerms={}),this.$parent.find(".search-field").addClass("wpse-is-loading"),void 0===window.wpseChosenTerms[a.prop]?jQuery.ajax({url:vgse_editor_settings.ajax_url,dataType:"json",data:this.options.ajaxParams,success:function(e){window.wpseChosenTerms[a.prop]=e.data,a.processAjaxDropdownOptions(window.wpseChosenTerms[a.prop])}}):a.processAjaxDropdownOptions(window.wpseChosenTerms[a.prop])),setTimeout(function(){a.$select.on("change",t.bind(a)),a.$select.on("chosen:hiding_dropdown",n.bind(a)),a.$select.trigger("chosen:open"),jQuery(a.TEXTAREA_PARENT).find("input.chosen-search-input").on("keydown",function(e){if(e.keyCode===s.helper.KEY_CODES.ENTER&&(jQuery(this).val()?(e.preventDefault(),e.stopPropagation()):(e.preventDefault(),e.stopPropagation(),a.close(),a.finishEditing())),e.keyCode===s.helper.KEY_CODES.BACKSPACE){var t=jQuery(a.TEXTAREA_PARENT).find("input").val();jQuery(a.TEXTAREA_PARENT).find("input").val(t.substr(0,t.length-1)).trigger("keyup.chosen"),e.preventDefault(),e.stopPropagation()}e.keyCode!==s.helper.KEY_CODES.ARROW_DOWN&&e.keyCode!==s.helper.KEY_CODES.ARROW_UP||(e.preventDefault(),e.stopPropagation())}),setTimeout(function(){if(a.$select.trigger("chosen:activate").focus(),o&&o.keyCode&&113!=o.keyCode){var e=o.keyCode,t=String.fromCharCode(96<=e&&e<=105?e-48:e).toLowerCase();jQuery(a.TEXTAREA_PARENT).find("input").val(t).trigger("keyup.chosen"),a.$select.trigger("chosen:activate")}},1)},1)},e.prototype.processAjaxDropdownOptions=function(e){var t="object"==typeof e?e:[],o=this,a=this.originalValue;o.$select.empty(),t.forEach(function(e){var t=jQuery("<option/>").attr("value",vgseStripHtml(e)).text(vgseStripHtml(e));o.$select.append(t)}),o.$select.trigger("chosen:updated"),o.setValue(a),o.$parent.find(".search-field").removeClass("wpse-is-loading")};var t=function(e,t){var o=this.cellProperties.chosenOptions;t&&t.selected&&(this.$select.find("option").filter(function(){return jQuery(this).val()===t.selected}).appendTo(this.$select),this.$select.trigger("chosen:updated")),o.multiple||(this.close(),this.finishEditing())},n=function(){this.cellProperties.chosenOptions.multiple||(this.close(),this.finishEditing())},r=function(e){var t=this.getActiveEditor(),o=s.helper.KEY_CODES,a=(e.ctrlKey||e.metaKey)&&!e.altKey;if("INPUT"===e.target.tagName)if(17!==e.keyCode&&224!==e.keyCode&&91!==e.keyCode&&93!==e.keyCode){var n=e.target;switch(e.keyCode){case o.ARROW_RIGHT:s.dom.getCaretPosition(n)!==n.value.length?e.stopImmediatePropagation():t.$select.trigger("chosen:close");break;case o.ARROW_LEFT:0!==s.dom.getCaretPosition(n)?e.stopImmediatePropagation():t.$select.trigger("chosen:close");break;case o.ENTER:t.cellProperties.chosenOptions.multiple&&(e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation());break;case o.A:case o.X:case o.C:case o.V:a&&e.stopImmediatePropagation();break;case o.BACKSPACE:var r=jQuery(t.TEXTAREA_PARENT).find("input").val();jQuery(t.TEXTAREA_PARENT).find("input").val(r.substr(0,r.length-1)).trigger("keyup.chosen"),e.stopImmediatePropagation();break;case o.DELETE:case o.HOME:case o.END:e.stopImmediatePropagation()}}else e.stopImmediatePropagation()};e.prototype.close=function(){this.setValue(this.getValue()),s.editors.SelectEditor.prototype.close.apply(this,arguments),this.instance.removeHook("beforeKeyDown",r),this.$parent.hide(),this.$select.off(),this.$select.hide()},e.prototype.finishEditing=function(e,t){return s.editors.SelectEditor.prototype.finishEditing.apply(this,arguments)},e.prototype.beginEditing=function(e){var t=this.instance.getSettings().onBeginEditing;t&&!1===t()||s.editors.SelectEditor.prototype.beginEditing.apply(this,arguments)},e.prototype.getValue=function(){var e=function(e){for(var t,o=[],a=e&&e.options,n=0,r=a.length;n<r;n++){var s=(t=a[n]).value||t.text;t.selected&&s&&o.push(s)}return o}(this.select);return jQuery.unique(e).join(vgse_editor_settings.taxonomy_terms_separator+" ")},e.prototype.setValue=function(e){if("string"==typeof e)var t=(e+"").split(vgse_editor_settings.taxonomy_terms_separator).map(function(e){return e.trim()});else t=e;var o=this;(t=jQuery.unique(t)).forEach(function(e){var t=o.$select.find("option").filter(function(){return jQuery(this).val()===e}).first();t.prop("selected",!0),o.$select.append(t),window.wpseChosenTerms&&window.wpseChosenTerms[o.prop]&&window.wpseChosenTerms[o.prop].indexOf(e)<0&&window.wpseChosenTerms[o.prop].push(e)}),this.$select.trigger("change"),this.$select.trigger("chosen:updated");this.$select.val();this.$select.find("option").length&&(this.originalValue=t.join(vgse_editor_settings.taxonomy_terms_separator+" "))},s.editors.WPChosenEditor=e,s.editors.registerEditor("wp_chosen",e)}(Handsontable),function(s){"use strict";var e=s.editors.TextEditor.prototype.extend();e.prototype.prepare=function(e,t,o,a,n,r){s.editors.TextEditor.prototype.prepare.apply(this,arguments),this.options={},this.cellProperties.chosenOptions&&(this.options=jQuery.extend(this.options,r.chosenOptions)),r.chosenOptions=jQuery.extend({},r.chosenOptions)},e.prototype.createElements=function(){this.$body=jQuery(document.body),this.TEXTAREA=document.createElement("select"),this.TEXTAREA.select=function(){},this.$textarea=jQuery(this.TEXTAREA),s.dom.addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),s.dom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.textareaParentStyle.width="200px",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var e=this;this.instance._registerTimeout(setTimeout(function(){e.refreshDimensions()},0))};function i(e){var t=this.getActiveEditor(),o=s.helper.KEY_CODES,a=(e.ctrlKey||e.metaKey)&&!e.altKey;if("INPUT"===e.target.tagName)if(17!==e.keyCode&&224!==e.keyCode&&91!==e.keyCode&&93!==e.keyCode){var n=e.target;switch(e.keyCode){case o.ARROW_RIGHT:s.dom.getCaretPosition(n)!==n.value.length?e.stopImmediatePropagation():t.$textarea.trigger("chosen:close");break;case o.ARROW_LEFT:0!==s.dom.getCaretPosition(n)?e.stopImmediatePropagation():t.$textarea.trigger("chosen:close");break;case o.ENTER:t.cellProperties.chosenOptions.multiple&&(e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation());break;case o.A:case o.X:case o.C:case o.V:a&&e.stopImmediatePropagation();break;case o.BACKSPACE:var r=jQuery(t.TEXTAREA_PARENT).find("input").val();jQuery(t.TEXTAREA_PARENT).find("input").val(r.substr(0,r.length-1)).trigger("keyup.chosen"),e.stopImmediatePropagation();break;case o.DELETE:case o.HOME:case o.END:e.stopImmediatePropagation()}}else e.stopImmediatePropagation()}e.prototype.open=function(o){this.refreshDimensions(),this.textareaParentStyle.display="block",this.instance.addHook("beforeKeyDown",i),this.$textarea.css({height:jQuery(this.TD).height()+4,"min-width":jQuery(this.TD).outerWidth()-4}),this.$textarea.hide();var e=jQuery.extend({},this.options,{width:"100%",search_contains:!0});e.multiple?this.$textarea.attr("multiple",!0):this.$textarea.attr("multiple",!1),this.$textarea.empty(),this.$textarea.append("<option value=''></option>");var t=null,a=(this.originalValue+"").split(vgse_editor_settings.taxonomy_terms_separator).map(function(e){return e.trim()});if(e.data&&e.data.length)for(var n=0;n<e.data.length;n++)(t=jQuery("<option />")).attr("value",e.data[n].id),t.html(e.data[n].label),-1<a.indexOf(e.data[n].id+"")&&t.attr("selected",!0),this.$textarea.append(t);jQuery(this.TEXTAREA_PARENT).find(".chosen-container").length&&this.$textarea.chosen("destroy"),this.$textarea.chosen(e);var r=this;setTimeout(function(){r.$textarea.on("change",function(){this.cellProperties.chosenOptions.multiple||(this.close(),this.finishEditing())}.bind(r)),r.$textarea.on("chosen:hiding_dropdown",function(){this.cellProperties.chosenOptions.multiple||(this.close(),this.finishEditing())}.bind(r)),r.$textarea.trigger("chosen:open"),jQuery(r.TEXTAREA_PARENT).find("input").on("keydown",function(e){if(e.keyCode===s.helper.KEY_CODES.ENTER&&(jQuery(this).val()?(e.preventDefault(),e.stopPropagation()):(e.preventDefault(),e.stopPropagation(),r.close(),r.finishEditing())),e.keyCode===s.helper.KEY_CODES.BACKSPACE){var t=jQuery(r.TEXTAREA_PARENT).find("input").val();jQuery(r.TEXTAREA_PARENT).find("input").val(t.substr(0,t.length-1)).trigger("keyup.chosen"),e.preventDefault(),e.stopPropagation()}e.keyCode!==s.helper.KEY_CODES.ARROW_DOWN&&e.keyCode!==s.helper.KEY_CODES.ARROW_UP||(e.preventDefault(),e.stopPropagation())}),setTimeout(function(){if(r.$textarea.trigger("chosen:activate").focus(),o&&o.keyCode&&113!=o.keyCode){var e=o.keyCode,t=String.fromCharCode(96<=e&&e<=105?e-48:e).toLowerCase();jQuery(r.TEXTAREA_PARENT).find("input").val(t).trigger("keyup.chosen"),r.$textarea.trigger("chosen:activate")}},1)},1)},e.prototype.init=function(){s.editors.TextEditor.prototype.init.apply(this,arguments)},e.prototype.close=function(){this.instance.listen(),this.instance.removeHook("beforeKeyDown",i),this.$textarea.off(),this.$textarea.hide(),s.editors.TextEditor.prototype.close.apply(this,arguments)},e.prototype.getValue=function(){return this.$textarea.val()?"object"==typeof this.$textarea.val()?this.$textarea.val().join(vgse_editor_settings.taxonomy_terms_separator):this.$textarea.val():""},e.prototype.focus=function(){this.instance.listen()},e.prototype.beginEditing=function(e){var t=this.instance.getSettings().onBeginEditing;t&&!1===t()||s.editors.TextEditor.prototype.beginEditing.apply(this,arguments)},e.prototype.finishEditing=function(e,t){return this.instance.listen(),s.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},s.editors.ChosenEditor=e,s.editors.registerEditor("chosen",e)}(Handsontable),void 0===Array.prototype.chunk&&Object.defineProperty(Array.prototype,"chunk",{value:function(o){var a=this;return[].concat.apply([],a.map(function(e,t){return t%o?[]:[a.slice(t,t+o)]}))}}),jQuery(document).ajaxError(function(e,t,o,a){loading_ajax({estado:!1}),"boolean"==typeof window.vgseDontNotifyServerError&&window.vgseDontNotifyServerError?window.vgseDontNotifyServerError=!1:"abort"!==t.statusText&&(400==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_400,tipo:"error",tiempo:6e4}):403==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_403,tipo:"error",tiempo:6e4}):500==t.status||502==t.status||505==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_500_502_505,tipo:"error",tiempo:6e4}):503==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_503,tipo:"error",tiempo:6e4}):509==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_509,tipo:"error",tiempo:6e4}):504==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_504,tipo:"error",tiempo:6e4}):notification({mensaje:vgse_editor_settings.texts.http_error_default,tipo:"error",tiempo:6e4}))}),jQuery(document).ajaxComplete(function(e,t,o,a){setTimeout(function(){"abort"!==t.statusText&&window.vgse_editor_settings&&("0"!==t.responseText&&0!==t.responseText&&!a||(loading_ajax({estado:!1}),"boolean"==typeof window.vgseDontNotifyServerError&&window.vgseDontNotifyServerError?window.vgseDontNotifyServerError=!1:notification({mensaje:vgse_editor_settings.texts.http_error_500_502_505,tipo:"error",tiempo:6e4})))},500)}),void 0===window.$&&(window.$=jQuery),jQuery(document).ready(function(e){if(window.wpseHasInitialized)return!0;if(window.wpseHasInitialized=!0,jQuery("body").on("click",".wpse-toggle-head",function(){jQuery(this).next(".wpse-toggle-content").slideToggle()}),!jQuery(".be-spreadsheet-wrapper").length)return!0;var u,h,c,g,l,p,f;window.vgseFormulasBulkSelectorExists=jQuery(".modal-formula").length,function(e){"use strict";var t=e.editors.PasswordEditor.prototype.extend();t.prototype.createElements=function(){e.editors.PasswordEditor.prototype.createElements.apply(this,arguments),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","datetime-local"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,jQuery(this.TEXTAREA_PARENT).empty(),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)},t.prototype.focus=function(){this.TEXTAREA.select()},e.editors.WPDateTimeEditor=t,e.editors.registerEditor("wp_datetime",t)}(Handsontable),(u=Handsontable).renderers.registerRenderer("wp_chosen_dropdown",function(e,t,o,a,n,r,s){var i=s.chosenOptions.data;if(void 0===i||void 0===i.length||!i.length)return u.renderers.TextRenderer.apply(this,arguments),t;var d=(r+"").split(vgse_editor_settings.taxonomy_terms_separator).map(function(e){return e.trim()});r=[];for(var l=0;l<i.length;l++)-1<d.indexOf(i[l].id+"")&&(i[l].id,r.push(i[l].label));return r=r.join(vgse_editor_settings.taxonomy_terms_separator+" "),u.renderers.TextRenderer.apply(this,arguments),t}),(h=Handsontable).renderers.registerRenderer("wp_media_gallery",function(e,t,o,a,n,r,s){h.renderers.BaseRenderer.apply(this,arguments),jQuery("#post-data").data("post-type");var i=vgse_editor_settings.final_spreadsheet_columns_settings[n],d=void 0!==i.wp_media_multiple&&i.wp_media_multiple,l=parseInt(v.getDataAtRowProp(o,"ID")),u=h.helper.stringify(r),c=[],p=[];u.split(",").forEach(function(e){c.push(e.replace(/.+wpId=(\d+)$/,"$1").trim());var t=e.split("/");p.push(t[t.length-1].replace(/(.+)\?wpId=(\d+)$/,"$1").trim())});var g="";if(u&&u.indexOf(",")<0){var f=u.replace(/\?.+/,"").split("."),y=f[f.length-1].toLowerCase();-1<u.indexOf("http")&&-1<["png","jpg","jpeg","gif","webp"].indexOf(y)&&(g+=vgse_editor_settings.media_cell_preview_template.replace("{url}",u))}if(i.formatted.readOnly||(g+='<button class="set_custom_images ',d&&(g+="multiple"),g+=' button" data-type="'+i.data_type+'" data-file="'+c.join(",")+'" data-key="'+n+'" data-id="'+l+'"><i class="fa fa-upload"></i></button>',d&&u&&(g+=' <a href="#image" data-remodal-target="image" class="view_custom_images multiple button" data-type="'+i.data_type+'" data-key="'+n+'" data-id="'+l+'"><i class="fa fa-image"></i></a>')),!vgse_editor_settings.dont_display_file_names_image_columns)if(r){var m=p.join(", ");g+=vgseStripHtml(m.substring(0,40)),40<m.length&&(g+="...")}else g+="("+vgse_editor_settings.texts.empty+")";return i.formatted.readOnly&&(g=(g='<i class="fa fa-lock vg-cell-blocked"></i> '+g).replace(/set_custom_images|view_custom_images/g,"")),t.innerHTML=g,t}),(c=Handsontable).renderers.registerRenderer("wp_tinymce",function(e,t,o,a,n,r,s){c.renderers.BaseRenderer.apply(this,arguments),jQuery("#post-data").data("post-type");var i=vgse_editor_settings.final_spreadsheet_columns_settings[n];void 0===i.formatted.wpse_template_key&&(i.formatted.wpse_template_key="tinymce_cell_template");var d=vgse_editor_settings[i.formatted.wpse_template_key],l=parseInt(v.getDataAtRowProp(o,"ID")),u=vgseGetRowTitle(o)||String(l);return d=(d=(d=d.replace(/\{key\}/g,n)).replace(/\{type\}/g,i.data_type)).replace(/\{id\}/g,l),"string"==typeof u&&(d=d.replace(/\{post_title\}/g,u.replace(/"/g,""))),r?(d+=vgseStripHtml(r).substring(0,30),30<r.length&&(d+="...")):d+="("+vgse_editor_settings.texts.empty+")",i.formatted.readOnly&&(d=(d='<i class="fa fa-lock vg-cell-blocked"></i> '+d).replace(/btn-popup-content/g,"")),t.innerHTML=d,t}),(g=Handsontable).renderers.registerRenderer("wp_handsontable",function(e,t,o,a,n,r,s){g.renderers.BaseRenderer.apply(this,arguments),jQuery("#post-data").data("post-type");var i=vgse_editor_settings.final_spreadsheet_columns_settings[n],d=vgse_editor_settings.handsontable_cell_template,l=parseInt(v.getDataAtRowProp(o,"ID")),u=(d=(d=(d=d.replace(/\{key\}/g,n)).replace(/\{type\}/g,i.data_type)).replace(/\{id\}/g,l),vgseGetRowTitle(o)||String(l)),c=(d=d.replace(/\{post_title\}/g,u.replace(/"/g,"")),v.getSourceData()),p=jQuery.extend(!0,i,c[o]);return p.post_id=l,d=(d=(d=d.replace(/\{modal_settings\}/g,vgseEscapeHTML(JSON.stringify(p)))).replace(/\{value\}/g,vgseEscapeHTML(JSON.stringify(r)))).replace(/\{button_label\}/g,p.edit_button_label),d+=r&&"[]"!==r?" ...":" ("+vgse_editor_settings.texts.empty+")",i.formatted.readOnly&&(d=(d='<i class="fa fa-lock vg-cell-blocked"></i> '+d).replace(/(btn-popup-content|button-custom-modal-editor|button-handsontable)/g,"")),t.innerHTML=d,t}),(l=Handsontable).renderers.registerRenderer("wp_friendly_select",function(e,t,o,a,n,r,s){l.renderers.BaseRenderer.apply(this,arguments);var i=vgse_editor_settings.final_spreadsheet_columns_settings[n],d=r;return r&&void 0!==i.formatted.selectOptions[r]&&(d=i.formatted.selectOptions[r]),t.innerHTML=d,t}),(p=Handsontable).renderers.registerRenderer("wp_external_button",function(e,t,o,a,n,r,s){p.renderers.BaseRenderer.apply(this,arguments);var i=vgse_editor_settings.final_spreadsheet_columns_settings[n];if(r)var d='<a target="_blank" href="'+r+'" class="button"><i class="fa fa-external-link"></i> '+i.title+"</a>";else d="";return t.innerHTML=d,t}),(f=Handsontable).renderers.registerRenderer("wp_locked",function(e,t,o,a,n,r,s){f.renderers.BaseRenderer.apply(this,arguments);var i=jQuery("#post-data").data("post-type"),d=vgse_editor_settings.final_spreadsheet_columns_settings[n];if(d.lock_template_key||(d.lock_template_key="lock_cell_template"),"string"==typeof r){var l=vgse_editor_settings.max_value_length_locked_cells||55;(r=vgseStripHtml(r).substring(0,l)).length>l&&(r+="...")}if("string"==typeof r&&-1<r.indexOf("vg-cell-blocked"))var u=r;else u=(u=(u=(u=(u=vgse_editor_settings[d.lock_template_key]).replace(/\{key\}/g,n)).replace(/\{value\}/g,r)).replace(/\{post_type\}/g,i)).replace(/set_custom_images|view_custom_images|button-handsontable|button-custom-modal-editor|data-remodal-target="image"/g,"");return t.innerHTML=u,t}),jQuery(".wpse-full-screen-notice").length&&(vgseToggleFullScreen(parseInt(jQuery(".wpse-full-screen-notice").data("status"))),jQuery("body").on("click",".wpse-full-screen-toggle",function(e){e.preventDefault(),vgseToggleFullScreen()})),jQuery("body").on("click",".dismiss-review-tip",function(e){jQuery(this).attr("href")||e.preventDefault(),vgse_editor_settings.texts.ask_review="",jQuery(this).parent(".review-tip").remove();var t=jQuery(".remodal-bg").data("nonce");jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"vgse_dismiss_review_tip",nonce:t},dataType:"json"})}),jQuery(".wpse-stuck-loading").appendTo("body"),jQuery("body").on("click",".wpse-stuck-loading button",function(e){e.preventDefault(),loading_ajax(!1),window.beLastLoadRowsAjax&&window.beLastLoadRowsAjax.abort(),jQuery(".wpse-stuck-loading").hide()}),jQuery(".vi-preview-wrapper").appendTo("body"),jQuery("body").on("mouseleave",".vi-preview-img",function(e){jQuery(".vi-preview-wrapper").hide()}),jQuery("body").on("mouseenter",".vi-preview-img",function(e){var t=jQuery(this).first();if(jQuery(this)[0].outerHTML,-1<t.attr("src").indexOf("wpse_no_zoom"))return!0;var o='<img src="'+t.attr("src")+'" />',a=jQuery(".vi-preview-wrapper");jQuery(window).width()-a.width()<t.offset().left+t.width()-jQuery(document).scrollLeft()?a.css({right:"auto",left:"0px"}):a.css({right:"0px",left:"auto"}),a.empty(),a.show(),a.append(o)}),jQuery("#go-top").on("click",function(e){e.preventDefault(),jQuery("html, body").stop().animate({scrollTop:0},"300","swing",function(){})}),jQuery("body").append('<div id="ohsnap" style="z-index: -1"></div>');var t=jQuery("#vgse-wrapper");t.length&&t.find(".vg-toolbar input:checkbox").labelauty();var v,y=jQuery("#post-data"),o=(jQuery("#responseConsole"),jQuery("#vgse-wrapper"));format=!jQuery("#formato").is(":checked"),setTimeout(function(){vgseInitSelect2()},2e3);var a={comments:vgse_editor_settings.allow_cell_comments,colWidths:vgObjectToArray(vgse_editor_settings.colWidths),colHeaders:vgObjectToArray(vgse_editor_settings.colHeaders),columns:m(format),rowHeaders:!0,startRows:vgse_editor_settings.startRows,startCols:vgse_editor_settings.startCols,currentRowClassName:"currentRow",currentColClassName:"currentCol",fillHandle:!1,columnSorting:!0,manualColumnFreeze:!0,manualColumnMove:!0,contextMenu:{items:{undo:{},redo:{},separator1:{name:"---------"},copy:{},cut:{},how_to_paste:{name:vgse_editor_settings.texts.how_to_paste},separator2:{name:"---------"},make_read_only:{},freeze_column:{},unfreeze_column:{},delete_row:{name:vgse_editor_settings.texts.delete_row,hidden:function(){return!v.getSelected()||!vgse_editor_settings.can_delete_row},callback:function(e,t,o){var a=[],n=[];if(t.forEach(function(e){e.start.row<e.end.row?vgseRange(e.start.row,e.end.row).forEach(function(e){n.push(e)}):n.push(e.start.row)}),n.forEach(function(e){a.push(v.getDataAtRowProp(e,"ID"))}),5<a.length){var r=jQuery(".confirm-bulk-delete-rows-modal");r.data("rowIds",a),r.remodal().open()}else{if(!confirm(vgse_editor_settings.texts.confirm_delete_row.replace("{rows_number}",a.length)))return!0;vgseDeleteRowsById(a),v.deselectCell()}}},resize_columns:{name:vgse_editor_settings.texts.auto_resize_columns,callback:function(e,t,o){v.updateSettings({colWidths:null}),v.updateSettings({autoColumnSize:!0});var a=v.getPlugin("autoColumnSize");a.recalculateAllColumnsWidth(),a.widths;var n=[];a.widths.forEach(function(e){n.push(e+25)}),v.updateSettings({colWidths:n,autoColumnSize:!1}),v.runHooks("afterColumnResize")}}}},autoWrapRow:!0,autoRowSize:!1,autoColumnSize:!1,viewportRowRenderingOffset:20,viewportColumnRenderingOffset:22<vgse_editor_settings.media_cell_preview_max_height?500:4,wordWrap:!0,minSpareCols:0,minSpareRows:0,width:null,height:null,copyPaste:{rowsLimit:999999,columnsLimit:999999},afterChange:_throttle(function(e){var t=!1;e&&e.length&&e.forEach(function(e){return!(!window.vgseFormulasBulkSelectorExists||0!==e[1]&&"wpseBulkSelector"!==e[1])||(e[2]!==e[3]?t=!0:void 0)}),t&&beSetSaveButtonStatus(!0)},3e3,{leading:!0,trailing:!0}),beforeCopy:function(a,e){return a.forEach(function(e,o){e.forEach(function(e,t){"string"==typeof e&&-1<e.indexOf("vg-cell-blocked")&&(a[o][t]=vgseStripHtml(e).trim())})}),a},afterDocumentKeyDown:function(e){var t=!1;if("ArrowDown"===e.key){var o=v.getSelected(),a=v.countRows()-1;o&&o[0][0]===a&&o[0][2]===a&&(t=!0)}if("ArrowUp"===e.key&&(o=v.getSelected())&&0===o[0][0]&&0===o[0][2]&&(t=!0),"ArrowRight"===e.key){o=v.getSelected();var n=v.countCols()-1;o&&o[0][3]===n&&(t=!0)}if("ArrowLeft"===e.key&&(o=v.getSelected())&&0===o[0][1]&&(t=!0),t)return e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),e}};vgse_editor_settings.is_premium&&(a.contextMenu.items.show_column_key={name:vgse_editor_settings.texts.show_column_key,callback:function(e,t,o){var a=v.colToProp(t[0].start.col);alert(vgse_editor_settings.texts.column_key_description+": $"+a+"$")}}),vgse_editor_settings.debug&&(a.debug=vgse_editor_settings.debug);var n=vgse_editor_settings.custom_handsontable_args?JSON.parse(vgse_editor_settings.custom_handsontable_args):{},r=jQuery.extend(a,n);("ontouchstart"in window||0<navigator.msMaxTouchPoints)&&(r.width=jQuery(window).width(),r.height=jQuery(window).height(),jQuery(window).width()<600&&(r.fixedColumnsLeft=!1)),v=new Handsontable(y[0],r),beSetSaveButtonStatus(!1),window.hot=v,window.beFoundRows=0,jQuery(".confirm-bulk-delete-rows-modal input").on("keyup",function(e){e.preventDefault();var t=jQuery(this);13===e.keyCode&&t.val()&&"delete"===t.val().toLowerCase()&&jQuery(".confirm-bulk-delete-rows-modal").data("rowIds")&&(vgseDeleteRowsById(jQuery(".confirm-bulk-delete-rows-modal").data("rowIds")),t.val(""),jQuery(".confirm-bulk-delete-rows-modal").data("rowIds",!1),jQuery(".confirm-bulk-delete-rows-modal").remodal().close())}),jQuery(document).on("opened",".confirm-bulk-delete-rows-modal",function(e){var t=jQuery(this).data("rowIds");jQuery(this).find(".contains-variable span").text(t.length)}),o.find("button[name=load]").on("click",function(){var e=jQuery(".remodal-bg").data("nonce");beLoadPosts({post_type:y.data("post-type"),nonce:e})}),vgse_editor_settings.disable_automatic_loading_rows||setTimeout(function(){jQuery("body").trigger("vgSheetEditor/beforeIntialLoadingRows"),o.find("button[name=load]").click()},400),jQuery("body").on("vgSheetEditor:beforeRowsInsert",function(e,t){t.success||vgseCustomTooltip(jQuery(".sheet-header .add_rows-container"),vgse_editor_settings.texts.add_posts_here,null,!1,"success")}),vgse_editor_settings.enable_auto_saving&&setInterval(function(){if(jQuery(".wpse-save.disabled").length||window.wpseAutoSavingInProgress)return!0;var e=jQuery(".button-container.auto_saving_status-container a");e.text(e.data("saving-changes")),jQuery("body").find(".be-start-saving").click(),window.wpseAutoSavingInProgress=!0},12e4),jQuery(".bulk-save.remodal").find(".remodal-cancel").on("click",function(e){jQuery('[data-remodal-id="bulk-save"]').remodal().close(),jQuery("html,body").scrollLeft(0)}),jQuery(".bulk-save.remodal .bulk-saving-screen").find(".remodal-cancel").on("click",function(e){jQuery("html,body").scrollLeft(0);var t=jQuery(this),o=t.parents(".remodal");o.find(".be-saving-warning").show(),o.find(".bulk-saving-screen").hide(),o.find("#be-nanobar-container").empty(),t.addClass("hidden"),o.find(".response").empty()}),jQuery(document).on("opening",'[data-remodal-id="bulk-save"]',function(){vgse_editor_settings.user_has_saved_sheet&&jQuery("body").find(".be-start-saving").click()}),document.addEventListener("keydown",function(e){"s"===e.key.toLowerCase()&&e.ctrlKey&&!jQuery(".remodal-is-opened").length&&(e.preventDefault(),v.deselectCell(),jQuery(".wpse-save").trigger("click"))}),jQuery("body").on("click",".wpse-save.disabled, .wpse-save-later.disabled",function(e){e.preventDefault(),notification({mensaje:vgse_editor_settings.texts.no_changes_to_save,tipo:"info"})}),jQuery(".bulk-save.remodal").find(".remodal-confirm").on("click",function(e){var t=jQuery(this).parents(".remodal");t.find(".be-saving-warning").show(),t.find(".bulk-saving-screen").hide(),t.find("#be-nanobar-container").empty(),t.find(".response").empty()}),jQuery("body").find(".be-start-saving").on("click",function(e){e.preventDefault(),vgse_editor_settings.user_has_saved_sheet=1;var t=jQuery(this).parents(".be-saving-warning"),s=t.next();s.find(".be-loading-anim").show(),t.fadeOut(),s.fadeIn();var i=v.getSourceData();if(!(i=beGetModifiedItems(i,window.beOriginalData)).length)return jQuery(s).find(".response").append("<p>"+vgse_editor_settings.texts.no_changes_to_save+"</p>"),loading_ajax({estado:!1}),s.find(".remodal-cancel").removeClass("hidden"),s.find(".be-loading-anim").hide(),vgseAllowToClosePageWithoutWarning(!0),setTimeout(function(){beSetSaveButtonStatus(!1),s.find(".remodal-cancel").click()},500),notification({mensaje:vgse_editor_settings.texts.no_changes_to_save,tipo:"info"}),!0;var o=jQuery(".remodal-bg").data("nonce"),a={classname:"be-progress-bar",id:"be-progress-bar",target:document.getElementById("be-nanobar-container")},d=new Nanobar(a);d.go(1);var n=Math.ceil(i.length/parseInt(vgse_editor_settings.save_posts_per_page));jQuery(".saving-now-message").show(),1<n&&setTimeout(function(){jQuery(".saving-complete-message").length||jQuery(".tip-saving-speed-message").show()},5500);var r=jQuery(".button-container.auto_saving_status-container a");beAjaxLoop({totalCalls:n,url:vgse_editor_settings.ajax_url,dataType:"json",method:"POST",data:{data:[],post_type:y.data("post-type"),action:"vgse_save_data",nonce:o,filters:beGetRowsFilters(),wpse_source_suffix:vgse_editor_settings.wpse_source_suffix||""},prepareData:function(e,t){var o=i.chunk(parseInt(vgse_editor_settings.save_posts_per_page));return e.data=o[t.current-1],e},onSuccess:function(e,t){if(e&&(!0===e.success||e.data)||(e={data:{message:vgse_editor_settings.texts.http_error_try_now},success:!1,allowRetry:!0}),!e.success)return jQuery(".tip-saving-speed-message").hide(),jQuery(s).find(".response").append("<p>"+e.data.message+"</p>"),e.allowRetry&&confirm(e.data.message)?(t.current--,jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight),!0):(vgse_editor_settings.enable_auto_saving?jQuery(s).find(".response").append(vgse_editor_settings.texts.auto_saving_stop_error):jQuery(s).find(".response").append(vgse_editor_settings.texts.saving_stop_error),s.find(".remodal-cancel").removeClass("hidden"),s.find(".be-loading-anim").hide(),jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight),vgse_editor_settings.enable_auto_saving&&(r.text(r.data("unsaved-changes")),jQuery('[data-remodal-id="bulk-save"]').is(":visible")||jQuery('[data-remodal-id="bulk-save"]').remodal().open()),!1);d.go(t.current/t.totalCalls*100),e.data.deleted.length&&vgseRemoveRowFromSheetByID(e.data.deleted);var o=parseInt(vgse_editor_settings.save_posts_per_page)*t.current>i.length?i.length:parseInt(vgse_editor_settings.save_posts_per_page)*t.current,a=(a=vgse_editor_settings.texts.paged_batch_saved.replace("{updated}",o)).replace("{total}",i.length);if(jQuery(s).find(".response").append("<p>"+a+"</p>"),t.current===t.totalCalls){jQuery(".tip-saving-speed-message, .saving-now-message").hide();var n=vgse_editor_settings.texts.everything_saved;if(vgse_editor_settings.texts.ask_review&&(n+="<br>"+vgse_editor_settings.texts.ask_review),jQuery(s).find(".response").empty().append('<p class="saving-complete-message">'+n+"</p>"),loading_ajax({estado:!1}),notification({mensaje:vgse_editor_settings.texts.everything_saved}),s.find(".remodal-cancel").removeClass("hidden"),s.find(".be-loading-anim").hide(),jQuery("body").trigger("vgSheetEditor/afterSavingChanges"),vgseAllowToClosePageWithoutWarning(!0),beSetSaveButtonStatus(!1),window.beOriginalData=jQuery.extend(!0,[],v.getSourceData()),v.getSourceData().forEach(function(e,t){void 0!==e.post_status&&"delete"===e.post_status&&v.alter("remove_row",t)}),1===t.totalCalls&&setTimeout(function(){jQuery('[data-remodal-id="bulk-save"]').remodal().close()},500),vgse_editor_settings.enable_auto_saving){var r=jQuery(".button-container.auto_saving_status-container a");r.text(r.data("saved-changes"))}}return setTimeout(function(){jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight)},600),!0},onError:function(e,t,o){var a=vgse_editor_settings.enable_auto_saving?vgse_editor_settings.texts.auto_saving_http_error_try_now:vgse_editor_settings.texts.http_error_try_now,n=confirm(a);return s.find(".be-loading-anim").hide(),n?(window.vgseDontNotifyServerError=!0,o.current--,d.go(o.current/o.totalCalls*100),jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight),!0):(vgse_editor_settings.enable_auto_saving?jQuery(s).find(".response").append(vgse_editor_settings.texts.auto_saving_stop_error):jQuery(s).find(".response").append(vgse_editor_settings.texts.saving_stop_error),s.find(".remodal-cancel").removeClass("hidden"),jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight),vgse_editor_settings.enable_auto_saving&&r.text(r.data("unsaved-changes")),!1)}})}),"undefined"!=typeof wp&&wp.media&&jQuery("body").on("click",".set_custom_images:not(.multiple)",function(e){e.preventDefault(),loading_ajax({estado:!0});var a=jQuery(this),t=a.parent("td"),n=v.getCoords(t[0]),r=jQuery("html,body").scrollLeft(),o=(a.data("id"),a.data("key"),a.data("type"),a.data("file")),s=[],i=jQuery(document).scrollTop(),d=jQuery("#infinito").prop("checked");return jQuery("#infinito").prop("checked",!1),media_uploader=wp.media({frame:"post",state:"insert",multiple:!1}),media_uploader.state("embed").on("select",function(){var e=media_uploader.state(),t=e.get("type"),o=e.props.toJSON();o.url=o.url||"","image"===t&&o.url&&wpsePrepareGalleryFilesForCellFormat([{url:o.url,id:o.url}],n)}),media_uploader.on("open",function(){var e=media_uploader.state().get("selection");o&&e.add(wp.media.attachment(o))}),media_uploader.on("close",function(){jQuery("html,body").scrollLeft(r),jQuery(window).scrollTop(i),jQuery("#infinito").prop("checked",d)}),media_uploader.on("insert",function(){jQuery("html,body").scrollLeft(r);var e=media_uploader.state().get("selection").length,t=media_uploader.state().get("selection").models;if(!t.length)return!0;for(var o=0;o<e;o++)s.push({url:t[o].attributes.url,id:t[o].id});a.data("file",t[0].id),wpsePrepareGalleryFilesForCellFormat(s,n)}),media_uploader.open(),loading_ajax({estado:!1}),!1}),"undefined"!=typeof wp&&wp.media&&jQuery("body").on("click",".set_custom_images.multiple",function(e){e.preventDefault(),loading_ajax({estado:!0});var t=jQuery(this),o=t.parent("td"),a=v.getCoords(o[0]),n=jQuery("html,body").scrollLeft(),r=(t.data("id"),t.data("key"),t.data("type"),[]),s=jQuery(document).scrollTop(),i=jQuery("#infinito").prop("checked");return jQuery("#infinito").prop("checked",!1),media_uploader=wp.media({frame:"post",state:"insert",multiple:!0}),media_uploader.state("embed").on("select",function(){var e=media_uploader.state(),t=e.get("type"),o=e.props.toJSON();o.url=o.url||"","image"===t&&o.url&&wpsePrepareGalleryFilesForCellFormat([{url:o.url,id:o.url}],a)}),media_uploader.on("close",function(){jQuery("html,body").scrollLeft(n),jQuery(window).scrollTop(s),jQuery("#infinito").prop("checked",i)}),media_uploader.on("insert",function(){jQuery("html,body").scrollLeft(n);for(var e=media_uploader.state().get("selection").length,t=media_uploader.state().get("selection").models,o=0;o<e;o++)r.push({url:t[o].attributes.url,id:t[o].id});wpsePrepareGalleryFilesForCellFormat(r,a)}),media_uploader.open(),loading_ajax({estado:!1}),!1}),jQuery("body").on("click",".view_custom_images",function(){var e=jQuery(this).parent("td"),t=v.getCoords(e[0]),o=v.getDataAtCell(t.row,t.col),a="";o.split(",").forEach(function(e){a+='<div><img src="'+e.trim()+'" width="425px" /></div>'}),jQuery("div[data-remodal-id=image] .modal-content").html(a),jQuery("[data-remodal-id=image]").remodal()}),jQuery("button.siguiente").on("click",function(){var e=jQuery(this),t=e.data("pos"),o=e.parents(".remodal").data("column-key"),a=jQuery(v.getCell(t,v.propToCol(o)));e.data("delay")?setTimeout(function(){a.find(".button").click()},parseInt(e.data("delay"))):a.find(".button").trigger("click")}),jQuery("button.anterior").on("click",function(){var e=jQuery(this),t=e.data("pos"),o=e.parents(".remodal").data("column-key"),a=jQuery(v.getCell(t,v.propToCol(o)));e.data("delay")?setTimeout(function(){a.find(".button").trigger("click")},parseInt(e.data("delay"))):a.find(".button").trigger("click")}),jQuery("body").on("click",".btn-popup-content",function(){var e=jQuery(this),t=e.data("id"),o=e.data("key"),a=e.data("type"),n=v.countRows(),r=jQuery(this).parent("td"),s=v.getCoords(r[0]),i=v.getDataAtCell(s.row,s.col),d=vgseGetRowTitle(s.row),l=s.row;window.tinymceAutoResized||(window.tinymceAutoResized=!0,jQuery("#editpost_ifr").height(200));var u=jQuery(".modal-tinymce-editor");0===l?(u.find("button.anterior").hide(),u.find("button.anterior").next("[data-wpse-tooltip]").hide()):(u.find("button.anterior").show(),u.find("button.anterior").next("[data-wpse-tooltip]").show()),l===n-1?(u.find("button.siguiente").hide(),u.find("button.siguiente").next("[data-wpse-tooltip]").hide()):(u.find("button.siguiente").show(),u.find("button.siguiente").next("[data-wpse-tooltip]").show()),u.find("button.anterior").data("pos",l-1),u.find("button.siguiente").data("pos",l+1),d?jQuery(".modal-tinymce-editor .post-title-modal span").text(d).show():jQuery(".modal-tinymce-editor .post-title-modal").hide(),setTimeout(function(){jQuery("#editpost-html").click(),jQuery(".wp-editor-area").empty(),jQuery(".wp-editor-area").val(i),jQuery("#editpost-tmce").click(),window.originalTinyMCEData=beGetTinymceContent(),jQuery(".modal-tinymce-editor .remodal-confirm").data("post_id",t),jQuery(".modal-tinymce-editor").data("column-key",o),jQuery(".modal-tinymce-editor .remodal-confirm").data("type",a),jQuery(".modal-tinymce-editor .remodal-confirm").data("cellCoords",s),jQuery('[data-remodal-id="editor"]').remodal().open()},500)}),jQuery(".guardar-popup-tinymce").on("click",function(e){var t=jQuery(".modal-tinymce-editor .remodal-confirm").data("cellCoords"),o=beGetTinymceContent();v.setDataAtCell(t.row,t.col,o)}),jQuery("body").on("click",".wpse-disable-if-unsaved-changes.disabled",function(e){alert(vgse_editor_settings.texts.save_changes_before_using_tool)}),jQuery(".pagination-jump input").on("keyup",function(e){var t=parseInt(jQuery(this).val()),o=parseInt(jQuery(this).attr("max"));if(13==e.keyCode&&t!==window.beCurrentPage&&1<=t&&t<=o)return vgseReloadSpreadsheet(!0,null,t),jQuery(this).blur(),!0}),jQuery("body").on("click",".load-more",function(){format=!!jQuery("#formato").is(":checked");var e=jQuery(".remodal-bg").data("nonce");if(jQuery(this).data("pagination")){var t=parseInt(jQuery(this).data("pagination"));return t&&t!==window.beCurrentPage&&vgseReloadSpreadsheet(!0,null,t),!0}var o=window.beCurrentPage+1;beLoadPosts({post_type:y.data("post-type"),paged:o,nonce:e},function(e){if(e.success){vgseAddFoundRowsCount(e.data.total),vgAddRowsToSheet(e.data.rows),loading_ajax({estado:!1});var t=e.data.message||vgse_editor_settings.texts.posts_loaded;notification({mensaje:t}),window.scrroll=!0,e.data&&e.data.rows.length||(window.scrroll=!1)}else loading_ajax({estado:!1}),notification({mensaje:e.data.message,tipo:"info",time:3e4}),window.scrroll=!1})}),jQuery("#post-data").offset(),window.scrroll=!0,window.isAddColumnNotified=!1,v.countRows();var s=jQuery(".ht_clone_top").width()>jQuery(window).width(),i=jQuery(document).width()+200>jQuery(window).width(),d=jQuery("#infinito");function m(e){if(!0===e)var t=vgse_editor_settings.columnsFormat;else t=vgse_editor_settings.columnsUnformat;var a=vgObjectToArray(t);return a.forEach(function(o,e){"string"==typeof o.source&&("loadTaxonomyTerms"===o.source&&(a[e].source=_throttle(function(e,t){return o=t,a=jQuery(".remodal-bg").data("nonce"),n=jQuery("#post_type_new_row").val(),r=v.colToProp(v.getSelected()[0][1]),s=vgse_editor_settings.columnsFormat[r].taxonomy_key||r,void 0===window.wpseTaxonomyTerms&&(window.wpseTaxonomyTerms={}),void(void 0===window.wpseTaxonomyTerms[s]?(window.wpseTaxonomyTerms[s]=[],jQuery.ajax({url:vgse_editor_settings.ajax_url,dataType:"json",data:{action:"vgse_get_taxonomy_terms",taxonomy_key:s,nonce:a,post_type:n,wpse_source:"taxonomy_column"},success:function(e){window.wpseTaxonomyTerms[s]=e.data,o(e.data)}})):o(window.wpseTaxonomyTerms[s]));var o,a,n,r,s},1500,{leading:!0,trailing:!0})),"searchPostByKeyword"===o.source&&(a[e].source=_throttle(function(e,t){return function(e,o,t){if(!e)return o([]);var a=jQuery(".remodal-bg").data("nonce"),n=t||jQuery("#post_type_new_row").val();jQuery.ajax({url:vgse_editor_settings.ajax_url,dataType:"json",data:{action:"vgse_find_post_by_name",search:e,nonce:a,post_type:n,wpse_source:"post_dropdown_column"},success:function(e){var t=[];e.success&&e.data.data.forEach(function(e){t.push(e.title)}),o(t)}})}(e,t,o.searchPostType)},1500,{leading:!0,trailing:!0})),"searchUsers"===o.source&&(a[e].source=_throttle(function(e,t){return o=e,a=t,n=jQuery(".remodal-bg").data("nonce"),r=vgse_editor_settings.post_type,void jQuery.ajax({url:vgse_editor_settings.ajax_url,dataType:"json",data:{action:"vgse_find_users_by_keyword",search:o,nonce:n,post_type:r,wpse_source:"users_dropdown_column"},success:function(e){var t=[];e.success&&(t=e.data.data),a(t)}});var o,a,n,r},1500,{leading:!0,trailing:!0})))}),a}function _(e,t,o,a,n,r,s){var i=jQuery(window).scrollTop(),d=scrollDown(a+e),l=jQuery(window).scrollLeft();d&&"top"===e&&(n<i?(t.removeClass("sticky-left"),t.css({left:"",width:""}),t.removeClass("sticky-left"),t.css("top",""),t.addClass("sticky"),jQuery("#wpadminbar").hide(),o.height(r)):(jQuery("#wpadminbar").show(),t.removeClass("sticky"),o.height(0))),d||"top"===e||(0===i&&(jQuery("#wpadminbar").show(),t.removeClass("sticky"),o.height(0)),t.hasClass("sticky")?(t.css({left:"",width:""}),t.removeClass("sticky-left")):s+20<l?(o.height(r),t.addClass("sticky-left"),t.css({left:l-jQuery("#vgse-wrapper").offset().left,width:jQuery(window).width()})):(o.height(0),t.css({left:"",width:""}),t.removeClass("sticky-left")))}if(jQuery(window).on("scroll",_throttle(function(){var e=scrollDown("infiniteLoad");d.length&&d.is(":checked")&&jQuery(document).height()>jQuery(window).height()&&void 0!==window.beOriginalData&&parseInt(jQuery(window).scrollTop()+jQuery(window).height())==jQuery(document).height()&&!0===window.scrroll&&e&&(jQuery(".load-more").trigger("click"),window.scrroll=!1);var t=jQuery(window).scrollLeft()+jQuery(window).width()>=jQuery(document).width()-400;s&&vgse_editor_settings.texts.hint_missing_column_on_scroll&&i&&t&&!window.isAddColumnNotified&&!e&&(window.isAddColumnNotified=!0,notification({mensaje:vgse_editor_settings.texts.hint_missing_column_on_scroll,tipo:"info",time:8e4,position:"bottom"}))},500,{leading:!0,trailing:!0})),jQuery("body").on("click",".show-column-missing-tips",function(e){e.preventDefault(),setTimeout(function(){jQuery(".modal-columns-visibility").parent().scrollTop(jQuery(".missing-column-tips").offset().top)},250)}),jQuery("body").on("click",".wpse-enable-locked-cell",function(e){e.preventDefault();var t=v.colToProp(v.getSelected()[0][1]);vgse_editor_settings.lockedColumnsManuallyEnabled.push(t);var o=v.propToCol(t),a=v.getDataAtCell(1,o);v.setDataAtCell(1,o,a)}),jQuery("#formato").on("change",function(){format=!jQuery(this).is(":checked");var e=m(format);"function"==typeof vgseColumnsVisibilityUpdateHOT&&window.vgseColumnsVisibilityUsed?vgseColumnsVisibilityUpdateHOT(e,vgse_editor_settings.colHeaders,vgse_editor_settings.colWidth,"softUpdate"):v.updateSettings({columns:e})}),jQuery("#addrow").on("click",function(){var e=jQuery(".remodal-bg").data("nonce"),o=jQuery("#post_type_new_row").val(),a=jQuery(this).next(".number_rows").length&&jQuery(this).next(".number_rows").val()?parseInt(jQuery(this).next(".number_rows").val()):1,t=void 0!==window.wpseAddRowExtraData?window.wpseAddRowExtraData:null;loading_ajax({estado:!0}),jQuery.ajax({type:"POST",url:vgse_editor_settings.ajax_url,data:{action:"vgse_insert_individual_post",nonce:e,post_type:o,rows:a,extra_data:t},dataType:"json",success:function(e){if(e.success){vgseAddFoundRowsCount(window.beFoundRows+parseInt(a)),vgAddRowsToSheet(e.data.message,"prepend"),loading_ajax({estado:!1}),notification({mensaje:vgse_editor_settings.texts.new_rows_added});var t=jQuery(".be-spreadsheet-wrapper").offset().top-jQuery("#vg-header-toolbar").height()-20;vgseIsInViewport(jQuery(".be-spreadsheet-wrapper"))||jQuery(window).scrollTop(t)}else loading_ajax({estado:!1}),notification({mensaje:e.data.message,tipo:"error",tiempo:6e4});jQuery("body").trigger("vgSheetEditor:afterNewRowsInsert",[e,o,a])}})}),jQuery("#addrow2").on("click",function(){jQuery("#addrow").trigger("click")}),jQuery("#vg-header-toolbar").length&&window.location.href.indexOf("wpse_no_sticky_toolbar")<0){var w=jQuery("#vg-header-toolbar").outerHeight(),j=jQuery("#vg-header-toolbar").offset().left,b=jQuery("#vg-header-toolbar-placeholder").offset().top,Q=jQuery("#vg-header-toolbar.js-sticky-top"),x=jQuery("#vg-header-toolbar-placeholder");Q.hasClass("js-sticky-top")&&(jQuery(window).on("scroll",_throttle(function(){_("top",Q,x,"menu",b,w,j)},20)),_("top",Q,x,"menu",b,w,j)),Q.hasClass("js-sticky-left")&&(jQuery(window).on("scroll",_throttle(function(){_("left",Q,x,"menu",b,w,j)},5)),_("left",Q,x,"menu",b,w,j))}var k=jQuery("#vg-footer-toolbar.js-sticky");if(k.length){var C=k.outerHeight(),T=k.offset().left,E=k.offset().top,S=k,A=jQuery("#vg-footer-toolbar-placeholder");jQuery(window).on("scroll",_throttle(function(){_("left",S,A,"footer",E,C,T)},5)),_("left",S,A,"footer",E,C,T)}jQuery("body").trigger("vgSheetEditor:afterInit"),jQuery(window).width()<1200&&50<jQuery("#vg-header-toolbar > .vg-header-toolbar-inner").height()&&jQuery(".vg-secondary-toolbar .vg-header-toolbar-inner div.clear").before(jQuery("#vg-header-toolbar > .vg-header-toolbar-inner > .button-container:gt(-3)"))});lastScrollTop={};function scrollDown(e){lastScrollTop[e]||(lastScrollTop[e]=0);var t=jQuery(window).scrollTop();return down=t!==lastScrollTop[e],lastScrollTop[e]=t,down}vgseClosePageWithoutWarning=!1,vgseAllowToClosePageWithoutWarning=function(e){vgseClosePageWithoutWarning=e,window.wpseAutoSavingInProgress=!e};function initHandsontableForPopup(e,r){if("handsontable"===r.type){"string"==typeof e&&(e=JSON.parse(e)),e=e||[];var t,o=r.handsontable_column_widths[r.post_type],a=r.handsontable_column_names[r.post_type],n=r.handsontable_columns[r.post_type],s=document.getElementById("handsontable-in-modal");window.hotAttr&&!window.hotAttr.isDestroyed&&window.hotAttr.destroy(),!(t=e.custom_handsontable_args?e.data:e).length&&window.wpseCurrentPopupSourceCoords.cellValue&&(t=window.wpseCurrentPopupSourceCoords.cellValue);var i={data:t,minSpareRows:1,wordWrap:!0,colWidths:o,allowInsertRow:!0,columnSorting:!0,colHeaders:a,columns:n,afterColumnSort:function(e,t){if("_vgse_create_attribute"===r.key){var o=window.hotAttr.getSourceData(),a=window.hotAttr.getDataAtProp("name"),n=[];o.forEach(function(e){n[e.name]=e}),a.forEach(function(e,t){n[e].position=t})}}},d=jQuery.extend(i,e.custom_handsontable_args);window.hotAttr=new Handsontable(s,d)}else"metabox"===r.type&&initEditorIframe(r);loading_ajax({estado:!1})}function initEditorIframe(r){window.$iframeWrappers=jQuery(".vgca-iframe-wrapper");var e=window.$iframeWrappers;e.show(),e.find("iframe").remove();var t=e.find(".iframe-template").prop("outerHTML").replace(/div/g,"iframe"),o=jQuery(t);o.removeClass("iframe-template"),o.attr("src",o.data("src")+r.post_id+"&wpse_column="+r.key),e.append(o),jQuery(".custom-modal-editor").addClass("modal-editor-"+r.key),window.vgcaIsFrontendSession=[],$iframeWrappers.each(function(){var a=jQuery(this),n=a.find("iframe");window.location.hash,n.data("lastPage",n.contents().get(0).location.href),window.vgcaIsFrontendSession.push(setInterval(function(){var e=n.contents().get(0).location.href;e!==n.data("lastPage")&&($iframeWrappers.css("height",""),n.css("height",""),n.data("lastPage",e));var t=null;try{t=n.contents()}catch(e){}if(t){n.height(700),a.height(700);var o=t.find(r.metabox_show_selector);o.removeClass("acf-hidden").removeClass("hidden").attr("hidden","").attr("style","display: block !important; visibility: 1 !important; opacity: 1 !important;"),o.siblings().filter(function(){return!(jQuery(this).hasClass("mce-container")||jQuery(this).hasClass("ui-autocomplete")||jQuery(this).attr("id")&&-1<jQuery(this).attr("id").indexOf("__wp-uploader-id"))}).attr("style","display: none !important"),o.parents().each(function(){jQuery(this).siblings().filter(function(){return!(jQuery(this).hasClass("mce-container")||jQuery(this).hasClass("ui-autocomplete")||jQuery(this).attr("id")&&-1<jQuery(this).attr("id").indexOf("__wp-uploader-id"))}).attr("style","display: none !important")})}},1e3))})}function vgsePostTypeSaved(e){e.response.success&&(jQuery(".post-types-form .post-type-field").first().before('<div class="post-type-field"><input type="radio" name="post_types[]" value="'+e.response.data.slug+'" id="'+e.response.data.slug+'"> <label for="'+e.response.data.slug+'">'+e.response.data.label+"</label></div>"),jQuery(".post-types-form input:radio").first().prop("checked",!0),jQuery(".post-types-form .save-trigger").trigger("click"))}function vgsePostTypeSetupPostTypesSaved(e){var t=e.form.parents("li");t.hide();var o=t.next();o.show(),o.hasClass("setup_columns")&&jQuery.get(ajaxurl,{action:"vgse_post_type_setup_columns_visibility",nonce:jQuery(".post-type-setup-wizard").data("nonce"),post_type:jQuery(".post-types-form input:radio:checked").val()},function(e){o.append(e.data.html),o.find('[name="save_post_type_settings"]').prop("checked",!0),"undefined"!=typeof vgseColumnsVisibilityInit&&vgseColumnsVisibilityInit()})}function vgsePostTypeSetupColumnSaved(e){jQuery("#vgse-columns-enabled").append('<li><span class="handle">::</span> '+e.response.data.label+' <input type="hidden" name="columns[]" class="js-column-key" value="'+e.response.data.key+'"><input type="hidden" name="columns_names[]" class="js-column-title" value="'+e.response.data.label+'"></li>')}function vgsePostTypeSetupColumnsVisibilitySaved(e){window.location.href=e.response.data.post_type_editor_url}jQuery(window).on("beforeunload",function(){if(jQuery(".be-spreadsheet-wrapper").length)var e=beGetModifiedItems(hot.getSourceData(),window.beOriginalData);else e=[];if(jQuery(".be-spreadsheet-wrapper").length&&e.length&&!vgseClosePageWithoutWarning)return vgse_editor_settings.texts.save_changes_on_leave}),jQuery(document).ready(function(){var e=jQuery(".quick-setup-page-content");if(!e.length)return!0;function r(){jQuery(".setup-step.active").removeClass("active").next().addClass("active"),jQuery(" #vgse-wrapper .progressbar li.active").removeClass("active").next().addClass("active")}e.find(".step-back").on("click",function(e){e.preventDefault(),jQuery(".setup-step.active").removeClass("active").prev().addClass("active"),jQuery(" #vgse-wrapper .progressbar li.active").removeClass("active").prev().addClass("active")}),e.find(".save-all-trigger").on("click",function(e){e.preventDefault();var t=jQuery(this).parents(".setup-step"),o=t.find("form");if(loading_ajax({estado:!0}),!o.length)return r(),loading_ajax({estado:!1}),!0;t.find(".save-trigger").each(function(){jQuery(this).trigger("click")});var a=t.find(".save-trigger").length,n=setInterval(function(){t.find(".save-trigger").filter(function(){return"yes"===jQuery(this).data("saved")}).length===a&&(clearInterval(n),r(),loading_ajax({estado:!1}))},800)}),e.find(".save-trigger").on("click",function(e){e.preventDefault();var t=jQuery(this),o=t.parents("form"),a=o.data("callback");jQuery.post(o.attr("action"),o.serializeArray(),function(e){t.data("saved","yes"),a&&vgseExecuteFunctionByName(a,window,{response:e,form:o})})})}),jQuery(document).ready(function(){jQuery("body").on("click",".form-submit-outside",function(e){e.preventDefault(),jQuery(this).parents(".remodal").find("form .form-submit-inside").trigger("click")}),jQuery(document).on("opened",".remodal",function(e){var t=jQuery(document).scrollTop(),o=jQuery("#infinito").prop("checked");jQuery("#infinito").prop("checked",!1),jQuery("body").data("temp-status",o).data("temp-scrolltop",t);var a=jQuery("html,body").scrollLeft();jQuery("body").data("temp-scrollleft",a)}),jQuery(document).on("closed",".remodal",function(){var e=jQuery("body").data("temp-scrolltop"),t=jQuery("body").data("temp-scrollleft"),o=jQuery("body").data("temp-status");e&&jQuery(window).scrollTop(e),t&&jQuery("html,body").scrollLeft(t),o&&jQuery("#infinito").prop("checked",o)}),jQuery("body").on("click","[data-wpse-remodal-target]",function(){vgseGoToModal(jQuery(this).data("wpse-remodal-target"))})}),jQuery(document).ready(function(){jQuery("body").on("click",".button-custom-modal-editor",function(e){e.preventDefault();var t=jQuery(this),o=t.data(),a=t.parent("td");if(a.length){var n=hot.getCoords(a[0]);if(window.wpseCurrentPopupSourceCoords=n,o.modalSettings.use_new_handsontable_renderer){var r=hot.getDataAtCell(window.wpseCurrentPopupSourceCoords.row,window.wpseCurrentPopupSourceCoords.col);window.wpseCurrentPopupSourceCoords.cellValue=r?JSON.parse(r):{}}}window.hotModalCache||(window.hotModalCache={}),window.hotModalCache[o.modalSettings.post_id]||(window.hotModalCache[o.modalSettings.post_id]={});var s=jQuery(".custom-modal-editor");if(a.length){var i=hot.countRows(),d=n.row;0===d?s.find("button.anterior").hide():s.find("button.anterior").show(),d===i-1?s.find("button.siguiente").hide():s.find("button.siguiente").show(),s.find("button.anterior").data("pos",d-1),s.find("button.siguiente").data("pos",d+1)}if("metabox"===o.modalSettings.type)var l=null;else"string"==typeof(l=window.hotModalCache&&window.hotModalCache[o.modalSettings.post_id][o.modalSettings.edit_modal_save_action]?window.hotModalCache[o.modalSettings.post_id][o.modalSettings.edit_modal_save_action]:o.existing)&&(l=l||"{}",l=JSON.parse(l));var u={button:t,modalSettings:o.modalSettings,existing:l};window.vgseWCAttsCurrent=u,setTimeout(function(){s.remodal().open()},500),s.addClass("modal-editor-"+o.modalSettings.key)}),jQuery("body").on("click",".custom-modal-editor .remodal-cancel",function(e){var t=jQuery(this).parents(".custom-modal-editor"),o=window.vgseWCAttsCurrent;o.modalSettings.edit_modal_cancel_action&&(loading_ajax({estado:!0}),o.modalSettings.edit_modal_cancel_action.replace("js_function_name:","").split(",").forEach(function(e){vgseExecuteFunctionByName(e,t.find("iframe")[0].contentWindow)}),loading_ajax(!1))}),jQuery("body").on("click",".custom-modal-editor .save-changes-handsontable",function(e){var o=jQuery(this).parents(".custom-modal-editor"),a=jQuery(".remodal-bg").data("nonce"),n=window.vgseWCAttsCurrent;if(loading_ajax({estado:!0}),"handsontable"===n.modalSettings.type)var r=hotAttr.getSourceData();else if("metabox"===n.modalSettings.type)if(-1<n.modalSettings.metabox_value_selector.indexOf("js_function_name:")){var t=n.modalSettings.metabox_value_selector.replace("js_function_name:","");r=vgseExecuteFunctionByName(t,o.find("iframe")[0].contentWindow)}else{var s=o.find("iframe").contents().find(n.modalSettings.metabox_value_selector);r=1===s.length?s.val():beParseParams(s.serialize())}window.hotModalCache||(window.hotModalCache={}),window.hotModalCache[n.modalSettings.post_id]||(window.hotModalCache[n.modalSettings.post_id]={}),n.modalSettings.edit_modal_get_action||(n.button.data("existing",r),window.hotModalCache[n.modalSettings.post_id][n.modalSettings.edit_modal_save_action]=r),"handsontable"===n.modalSettings.type&&n.modalSettings.use_new_handsontable_renderer&&hot.setDataAtCell(window.wpseCurrentPopupSourceCoords.row,window.wpseCurrentPopupSourceCoords.col,JSON.stringify(r)),n.modalSettings.edit_modal_save_action.split(",").forEach(function(e){if(-1<e.indexOf("js_function_name:")){var t=e.replace("js_function_name:","");vgseExecuteFunctionByName(t,o.find("iframe")[0].contentWindow)}else jQuery.post(vgse_editor_settings.ajax_url,{action:e,nonce:a,postId:n.modalSettings.post_id,postType:n.modalSettings.post_type,modalSettings:n.modalSettings,data:r},function(e){})}),jQuery(".custom-modal-editor").remodal().close(),loading_ajax({estado:!1})}),jQuery(document).on("closed",".custom-modal-editor",function(){var e=window.vgseWCAttsCurrent,t=jQuery(".custom-modal-editor");"metabox"===e.modalSettings.type&&void 0!==window.vgcaIsFrontendSession&&window.vgcaIsFrontendSession.length&&(t.find("iframe").remove(),t.find(".vgca-iframe-wrapper ").hide(),window.vgcaIsFrontendSession.forEach(function(e,t){clearInterval(e)})),"handsontable"===e.modalSettings.type&&window.hotAttr&&!window.hotAttr.isDestroyed&&window.hotAttr.destroy(),t.find(".modal-general-title, .modal-description").hide(),jQuery(".custom-modal-editor").removeClass("modal-editor-"+e.modalSettings.key),loading_ajax({estado:!1})}),jQuery(document).on("opened",".custom-modal-editor",function(){var t=window.vgseWCAttsCurrent;if(!t)return!0;loading_ajax({estado:!0});var e=jQuery(".custom-modal-editor");if(e.data("column-key",t.modalSettings.key),e.find(".modal-post-title").length||e.find(".modal-general-title").after('<span class="modal-post-title"></span>'),e.find(".modal-post-title").html(t.modalSettings.post_title),t.modalSettings.edit_modal_title&&e.find(".modal-general-title").html(t.modalSettings.edit_modal_title+": "),t.modalSettings.edit_modal_description&&e.find(".modal-description").html(t.modalSettings.edit_modal_description),e.find(".modal-general-title, .modal-description").show(),window.hotModalCache||(window.hotModalCache={}),window.hotModalCache[t.modalSettings.post_id]||(window.hotModalCache[t.modalSettings.post_id]={}),t.modalSettings.edit_modal_get_action){var o=jQuery(".remodal-bg").data("nonce");jQuery.get(vgse_editor_settings.ajax_url,{action:t.modalSettings.edit_modal_get_action,nonce:o,postId:t.modalSettings.post_id}).done(function(e){initHandsontableForPopup(e.data,t.modalSettings)})}else{if(window.hotModalCache&&window.hotModalCache[t.modalSettings.post_id][t.modalSettings.edit_modal_save_action])var a=window.hotModalCache[t.modalSettings.post_id][t.modalSettings.edit_modal_save_action];else a=t.existing;initHandsontableForPopup(a,t.modalSettings)}}),jQuery("body").on("click","button.remodal-confirm, a.remodal-cancel, .media-button-insert",function(e){"submit"===jQuery(this).attr("type")||jQuery(this).hasClass("submit")||e.preventDefault()})}),jQuery(document).ready(function(){jQuery(".vgse-current-filters").on("click",".button",function(e){e.preventDefault();var t=jQuery(this),o=hot.getSourceData();if((o=beGetModifiedItems(o,window.beOriginalData)).length)return alert(vgse_editor_settings.texts.save_changes_before_remove_filter),!0;var a=[];t.hasClass("remove-all-filters")?(jQuery(".vgse-current-filters .button:not(.remove-all-filters)").each(function(){a.push(jQuery(this).data("filter-key"))}),jQuery(".vgse-current-filters .button").remove(),jQuery("body").data("be-filters",{})):(a.push(t.data("filter-key")),t.remove()),a.forEach(function(e){e&&(jQuery("#be-filters").find("input,select,textarea").filter(function(){return jQuery(this).attr("name")===e&&"checkbox"!==jQuery(this).attr("type")}).val("").trigger("change"),jQuery("#be-filters").find("input:checkbox").filter(function(){return jQuery(this).attr("name")===e}).prop("checked",!1).trigger("change"),beAddRowsFilter(e+"="))}),vgseReloadSpreadsheet()})}),jQuery(document).ready(function(){var o=jQuery(".post-type-setup-wizard");if(!o.length)return!1;o.find("form.inline-add").on("submit",function(e){var t=jQuery(this),o=t.data("callback");return jQuery.ajax({method:t.attr("method"),url:t.attr("action"),data:t.serialize()+"&current_post_type="+jQuery(".post-types-form input:radio:checked").val()}).done(function(e){t.find("input:text").val(""),t.find("input:text").first().focus(),vgseExecuteFunctionByName(o,window,{response:e,form:t})}),!1});var e=o.find(".post-types-form").data("custom-post-types").split(",");jQuery.each(e,function(e,t){o.find(".post-types-form .post-type-"+t).append('<button class="button vgse-delete-post-type" data-post-type="'+t+'"><i class="fa fa-remove"></i></button>')}),o.on("click",".vgse-delete-post-type",function(e){e.preventDefault();var t=jQuery(this).data("post-type");if(!confirm(o.find(".post-types-form").data("confirm-delete")))return!0;jQuery.post(ajaxurl,{post_type:t,action:"vgse_delete_post_type",nonce:jQuery(".post-type-setup-wizard").data("nonce")},function(e){e.success&&(notification({mensaje:e.data.message,tipo:"success",tiempo:3e3}),o.find(".post-types-form .post-type-"+t).remove())})})}),jQuery(document).ready(function(){var t=jQuery(".quick-setup-page-content .post-type-field input");if(!t.length)return!1;var a=jQuery(".quick-setup-page-content .post-types-enabled");t.on("change",function(e){a.empty(),t.each(function(){var e=jQuery(this).val();if(jQuery(this).is(":checked")){var t=jQuery(this).siblings("label").text(),o='<a class="button post-type-'+vgseStripHtml(e)+'" href="admin.php?page=vgse-bulk-edit-'+vgseStripHtml(e)+'">Edit '+vgseStripHtml(t)+"</a> - ";a.append(o)}})})}),jQuery(document).ready(function(){jQuery("body").on("change","input.wpse-set-settings, textarea.wpse-set-settings, select.wpse-set-settings",function(e){e.preventDefault();var t=jQuery(this).attr("name"),o=jQuery(this).val(),a=parseInt(jQuery(this).data("reload-after-success")),n=parseInt(jQuery(this).data("silent-action"));if(!t)return!0;vgseSetSettings([{name:"settings["+t+"]",value:o}],a,n)}),jQuery("body").on("click","a.wpse-set-settings",function(e){e.preventDefault();var t=jQuery(this).data("name"),o=jQuery(this).data("value"),a=parseInt(jQuery(this).data("reload-after-success")),n=parseInt(jQuery(this).data("silent-action"));if(!t)return!0;vgseSetSettings([{name:"settings["+t+"]",value:o}],a,n)}),jQuery("body").on("submit","form.wpse-set-settings",function(e){var t=parseInt(jQuery(this).data("reload-after-success")),o=parseInt(jQuery(this).data("silent-action"));return vgseSetSettings(jQuery(this).serializeArray(),t,o),!1}),jQuery(".tabs-links a").on("click",function(e){e.preventDefault(),jQuery(".tabs-links a").removeClass("tab-active"),jQuery(this).addClass("tab-active");var t=jQuery(this).attr("href").replace("#",""),o=jQuery(this).parents(".tabs-links"),a=o.next().find("."+t);o.next().find(".tab-content").hide(),a.show()}),jQuery(".tabs-links").each(function(){jQuery(this).find("a").first().click()})}),jQuery(document).ready(function(){jQuery(".toolbar-submenu [data-saved-item]").each(function(){jQuery(this).after('<button type="button" class="wpse-delete-saved-item wpse-delete-saved-search">x</button>')}),jQuery("body").on("click",".wpse-delete-saved-item",function(e){e.preventDefault();var t=jQuery(this),o="confirm_delete_"+t.prev().data("saved-type")+"_item";if(vgse_editor_settings.texts[o]&&!confirm(vgse_editor_settings.texts[o]))return!1;var a={nonce:jQuery("#vgse-wrapper").data("nonce"),post_type:jQuery("#post-data").data("post-type"),action:"vgse_delete_saved_"+t.prev().data("saved-type"),search_name:t.prev().data("item-name")},n=t.prev().data("reload");t.parent().remove(),jQuery.post(ajaxurl,a,function(e){n&&window.location.reload()})})}),jQuery(document).ready(function(){if(!jQuery(".vg-toolbar .button-container.require-click-to-expand").length)return!0;jQuery(".vg-toolbar .require-click-to-expand > button").on("click",function(e){var t=jQuery(this).parent();jQuery(".vg-toolbar .require-click-to-expand.expand-submenu").not(t).removeClass("expand-submenu"),t.toggleClass("expand-submenu")}),jQuery("body").on("click",function(e){var t=jQuery(e.target);!jQuery(".button-container.expand-submenu").length||t.parents(".require-click-to-expand").length||t.parents(".select2-container").length||jQuery(".vg-toolbar .button-container.require-click-to-expand.expand-submenu").removeClass("expand-submenu")})}),jQuery(document).ready(function(){vgseInitLazySelects()}),jQuery(document).ready(function(){if(jQuery(window).width()<768)return!0;var e=jQuery(".remodal.remodal-draggable");if(!e.length)return!0;e.each(function(){var e,t,o,a,n,r,s=jQuery(this);function i(e){(e=e||window.event).preventDefault(),n=e.clientX,r=e.clientY,document.onmouseup=l,document.onmousemove=d}function d(e){(e=e||window.event).preventDefault(),o=n-e.clientX,a=r-e.clientY,n=e.clientX,r=e.clientY,t.style.top=t.offsetTop-a+"px",t.style.left=t.offsetLeft-o+"px"}function l(){document.onmouseup=null,document.onmousemove=null}s.append('<i class="fa fa-arrows drag-modal"></i>'),e=s.find(".drag-modal")[0],t=s[0],r=n=a=o=0,document.getElementById(e.id+"header")?document.getElementById(e.id+"header").onmousedown=i:e.onmousedown=i}),jQuery(document).on("opened",".remodal",function(e){var t=jQuery(this);t.hasClass("remodal-draggable")&&t.css({left:t[0].offsetLeft,position:"absolute",top:t[0].offsetTop})}),jQuery(document).on("closed",".remodal",function(e){var t=jQuery(this);t.hasClass("remodal-draggable")&&t.css({left:"",position:"",top:""})})}),jQuery(document).ready(function(){var $=jQuery;function n(a){$.get(ajaxurl,{action:a.data("ajax-action"),nonce:jQuery(".remodal-bg").data("nonce"),postType:vgse_editor_settings.post_type,is_editor_page:!0},function(e){if(e.success){var t=jQuery(e.data.html);if(a.find(".modal-content").replaceWith(t.find(".modal-content")),a.removeClass("lazy-modal-content"),a.trigger("vgSheetEditor:remodal:ajaxContentInserted",e),$("body").trigger("vgSheetEditor:remodal:ajaxContentInserted",e),a.data("live-refresh")&&!a.data("intervalId")){var o=setInterval(function(){a.data("pauseAutoReload")||n(a)},1e3*parseInt(a.data("live-refresh")));a.data("intervalId",o)}}})}jQuery(document).on("opening",".remodal[data-ajax-action]",function(){n(jQuery(this))}),jQuery(document).on("closed",".remodal[data-ajax-action]",function(){var e=parseInt(jQuery(this).data("intervalId"));e&&(clearInterval(e),jQuery(this).data("intervalId",!1))}),jQuery(document).on("vgSheetEditor:refreshRemodalContent",".remodal[data-ajax-action]",function(){jQuery(this).is(":visible")&&n(jQuery(this))})}),jQuery(document).ready(function(){if("undefined"==typeof hot)return!0;hot.updateSettings({cells:function(e,t,o){var a=this.instance.toVisualRow(e),n={};"object"==typeof vgse_editor_settings.columnsBackgroundColors&&"string"==typeof vgse_editor_settings.columnsBackgroundColors[o]&&vgse_editor_settings.columnsBackgroundColors[o]?n.className="bg-"+vgse_editor_settings.columnsBackgroundColors[o].replace("#",""):n.className&&-1<n.className.indexOf("bg-")&&delete n.className;var r=vgse_editor_settings.final_spreadsheet_columns_settings[o];if(r&&(r.is_locked||!vgse_editor_settings.watch_cells_to_lock&&"post_status"!==o||(i=hot.getDataAtCell(a,t))&&"string"==typeof i&&-1<i.indexOf("vg-cell-blocked")&&(n.renderer="wp_locked",n.readOnly=!0,n.editor=!1,n.fillHandle=!1,vgse_editor_settings.allow_cell_comments&&("product_variation"===(s=hot.getDataAtRowProp(a,"post_type"))&&vgse_editor_settings.texts.column_for_parent_products_only?n.comment={value:vgse_editor_settings.texts.column_for_parent_products_only}:"product"===s&&vgse_editor_settings.texts.column_for_variations_only&&(n.comment={value:vgse_editor_settings.texts.column_for_variations_only}))),r.is_locked&&r.allow_to_save&&-1<vgse_editor_settings.lockedColumnsManuallyEnabled.indexOf(o)&&((n=r.formatted).readOnly=!1,n.fillHandle=!0,n.renderer=r.formatted.renderer||"text"),vgse_editor_settings.post_type===vgse_editor_settings.woocommerce_product_post_type_key&&"post_status"===o)){n.selectOptions=r.formatted.selectOptions;var s,i=hot.getDataAtCell(a,t);"product_variation"===(s=hot.getDataAtRowProp(a,"post_type"))&&(n.selectOptions={publish:n.selectOptions.publish,delete:n.selectOptions.delete})}return n}})}),function(s){"use strict";var e=s.editors.SelectEditor.prototype.extend();e.prototype.prepare=function(e,t,o,a,n,r){s.editors.SelectEditor.prototype.prepare.apply(this,arguments),this.options={},this.cellProperties.chosenOptions&&(this.options=jQuery.extend(this.options,r.chosenOptions)),r.chosenOptions=jQuery.extend({},r.chosenOptions)},e.prototype.init=function(){s.editors.SelectEditor.prototype.init.apply(this,arguments),this.createElements()},e.prototype.createElements=function(){this.$body=jQuery(document.body),this.select.setAttribute("multiple","multiple"),this.$select=jQuery(this.select),this.TEXTAREA_PARENT=document.createElement("DIV"),s.dom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.textareaParentStyle.width="200px",this.TEXTAREA_PARENT.appendChild(this.select),this.$parent=jQuery(this.TEXTAREA_PARENT),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var e=this;this.instance._registerTimeout(setTimeout(function(){e.refreshDimensions()},0))},e.prototype.open=function(o){this.instance.addHook("beforeKeyDown",r),s.editors.SelectEditor.prototype.open.apply(this,arguments),this.$parent.css({display:"block",top:this.$select.css("top"),left:this.$select.css("left"),margin:this.$select.css("margin")}),this.$select.css({height:jQuery(this.TD).height()+4,"min-width":jQuery(this.TD).outerWidth()-4}),this.$select.hide();var e=jQuery.extend({},this.options,{width:"100%",search_contains:!0});jQuery(this.TEXTAREA_PARENT).find(".chosen-container").length&&this.$select.chosen("destroy"),this.$select.chosen(e);var a=this;this.options.ajaxParams&&(this.options.ajaxParams.nonce=jQuery(".remodal-bg").data("nonce"),this.options.ajaxParams.columnKey=a.prop,this.options.ajaxParams.wpse_source="chosen_column",this.options.ajaxParams.post_type=vgse_editor_settings.post_type,void 0===window.wpseChosenTerms&&(window.wpseChosenTerms={}),this.$parent.find(".search-field").addClass("wpse-is-loading"),void 0===window.wpseChosenTerms[a.prop]?jQuery.ajax({url:vgse_editor_settings.ajax_url,dataType:"json",data:this.options.ajaxParams,success:function(e){window.wpseChosenTerms[a.prop]=e.data,a.processAjaxDropdownOptions(window.wpseChosenTerms[a.prop])}}):a.processAjaxDropdownOptions(window.wpseChosenTerms[a.prop])),setTimeout(function(){a.$select.on("change",t.bind(a)),a.$select.on("chosen:hiding_dropdown",n.bind(a)),a.$select.trigger("chosen:open"),jQuery(a.TEXTAREA_PARENT).find("input.chosen-search-input").on("keydown",function(e){if(e.keyCode===s.helper.KEY_CODES.ENTER&&(jQuery(this).val()?(e.preventDefault(),e.stopPropagation()):(e.preventDefault(),e.stopPropagation(),a.close(),a.finishEditing())),e.keyCode===s.helper.KEY_CODES.BACKSPACE){var t=jQuery(a.TEXTAREA_PARENT).find("input").val();jQuery(a.TEXTAREA_PARENT).find("input").val(t.substr(0,t.length-1)).trigger("keyup.chosen"),e.preventDefault(),e.stopPropagation()}e.keyCode!==s.helper.KEY_CODES.ARROW_DOWN&&e.keyCode!==s.helper.KEY_CODES.ARROW_UP||(e.preventDefault(),e.stopPropagation())}),setTimeout(function(){if(a.$select.trigger("chosen:activate").focus(),o&&o.keyCode&&113!=o.keyCode){var e=o.keyCode,t=String.fromCharCode(96<=e&&e<=105?e-48:e).toLowerCase();jQuery(a.TEXTAREA_PARENT).find("input").val(t).trigger("keyup.chosen"),a.$select.trigger("chosen:activate")}},1)},1)},e.prototype.processAjaxDropdownOptions=function(e){var t="object"==typeof e?e:[],o=this,a=this.originalValue;o.$select.empty(),t.forEach(function(e){var t=jQuery("<option/>").attr("value",vgseStripHtml(e)).text(vgseStripHtml(e));o.$select.append(t)}),o.$select.trigger("chosen:updated"),o.setValue(a),o.$parent.find(".search-field").removeClass("wpse-is-loading")};var t=function(e,t){var o=this.cellProperties.chosenOptions;t&&t.selected&&(this.$select.find("option").filter(function(){return jQuery(this).val()===t.selected}).appendTo(this.$select),this.$select.trigger("chosen:updated")),o.multiple||(this.close(),this.finishEditing())},n=function(){this.cellProperties.chosenOptions.multiple||(this.close(),this.finishEditing())},r=function(e){var t=this.getActiveEditor(),o=s.helper.KEY_CODES,a=(e.ctrlKey||e.metaKey)&&!e.altKey;if("INPUT"===e.target.tagName)if(17!==e.keyCode&&224!==e.keyCode&&91!==e.keyCode&&93!==e.keyCode){var n=e.target;switch(e.keyCode){case o.ARROW_RIGHT:s.dom.getCaretPosition(n)!==n.value.length?e.stopImmediatePropagation():t.$select.trigger("chosen:close");break;case o.ARROW_LEFT:0!==s.dom.getCaretPosition(n)?e.stopImmediatePropagation():t.$select.trigger("chosen:close");break;case o.ENTER:t.cellProperties.chosenOptions.multiple&&(e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation());break;case o.A:case o.X:case o.C:case o.V:a&&e.stopImmediatePropagation();break;case o.BACKSPACE:var r=jQuery(t.TEXTAREA_PARENT).find("input").val();jQuery(t.TEXTAREA_PARENT).find("input").val(r.substr(0,r.length-1)).trigger("keyup.chosen"),e.stopImmediatePropagation();break;case o.DELETE:case o.HOME:case o.END:e.stopImmediatePropagation()}}else e.stopImmediatePropagation()};e.prototype.close=function(){this.setValue(this.getValue()),s.editors.SelectEditor.prototype.close.apply(this,arguments),this.instance.removeHook("beforeKeyDown",r),this.$parent.hide(),this.$select.off(),this.$select.hide()},e.prototype.finishEditing=function(e,t){return s.editors.SelectEditor.prototype.finishEditing.apply(this,arguments)},e.prototype.beginEditing=function(e){var t=this.instance.getSettings().onBeginEditing;t&&!1===t()||s.editors.SelectEditor.prototype.beginEditing.apply(this,arguments)},e.prototype.getValue=function(){var e=function(e){for(var t,o=[],a=e&&e.options,n=0,r=a.length;n<r;n++){var s=(t=a[n]).value||t.text;t.selected&&s&&o.push(s)}return o}(this.select);return jQuery.unique(e).join(vgse_editor_settings.taxonomy_terms_separator+" ")},e.prototype.setValue=function(e){if("string"==typeof e)var t=(e+"").split(vgse_editor_settings.taxonomy_terms_separator).map(function(e){return e.trim()});else t=e;var o=this;(t=jQuery.unique(t)).forEach(function(e){var t=o.$select.find("option").filter(function(){return jQuery(this).val()===e}).first();t.prop("selected",!0),o.$select.append(t),window.wpseChosenTerms&&window.wpseChosenTerms[o.prop]&&window.wpseChosenTerms[o.prop].indexOf(e)<0&&window.wpseChosenTerms[o.prop].push(e)}),this.$select.trigger("change"),this.$select.trigger("chosen:updated"),this.$select.val(),this.$select.find("option").length&&(this.originalValue=t.join(vgse_editor_settings.taxonomy_terms_separator+" "))},s.editors.WPChosenEditor=e,s.editors.registerEditor("wp_chosen",e)}(Handsontable),function(s){"use strict";var e=s.editors.TextEditor.prototype.extend();function i(e){var t=this.getActiveEditor(),o=s.helper.KEY_CODES,a=(e.ctrlKey||e.metaKey)&&!e.altKey;if("INPUT"===e.target.tagName)if(17!==e.keyCode&&224!==e.keyCode&&91!==e.keyCode&&93!==e.keyCode){var n=e.target;switch(e.keyCode){case o.ARROW_RIGHT:s.dom.getCaretPosition(n)!==n.value.length?e.stopImmediatePropagation():t.$textarea.trigger("chosen:close");break;case o.ARROW_LEFT:0!==s.dom.getCaretPosition(n)?e.stopImmediatePropagation():t.$textarea.trigger("chosen:close");break;case o.ENTER:t.cellProperties.chosenOptions.multiple&&(e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation());break;case o.A:case o.X:case o.C:case o.V:a&&e.stopImmediatePropagation();break;case o.BACKSPACE:var r=jQuery(t.TEXTAREA_PARENT).find("input").val();jQuery(t.TEXTAREA_PARENT).find("input").val(r.substr(0,r.length-1)).trigger("keyup.chosen"),e.stopImmediatePropagation();break;case o.DELETE:case o.HOME:case o.END:e.stopImmediatePropagation()}}else e.stopImmediatePropagation()}e.prototype.prepare=function(e,t,o,a,n,r){s.editors.TextEditor.prototype.prepare.apply(this,arguments),this.options={},this.cellProperties.chosenOptions&&(this.options=jQuery.extend(this.options,r.chosenOptions)),r.chosenOptions=jQuery.extend({},r.chosenOptions)},e.prototype.createElements=function(){this.$body=jQuery(document.body),this.TEXTAREA=document.createElement("select"),this.TEXTAREA.select=function(){},this.$textarea=jQuery(this.TEXTAREA),s.dom.addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),s.dom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.textareaParentStyle.width="200px",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var e=this;this.instance._registerTimeout(setTimeout(function(){e.refreshDimensions()},0))},e.prototype.open=function(o){this.refreshDimensions(),this.textareaParentStyle.display="block",this.instance.addHook("beforeKeyDown",i),this.$textarea.css({height:jQuery(this.TD).height()+4,"min-width":jQuery(this.TD).outerWidth()-4}),this.$textarea.hide();var e=jQuery.extend({},this.options,{width:"100%",search_contains:!0});e.multiple?this.$textarea.attr("multiple",!0):this.$textarea.attr("multiple",!1),this.$textarea.empty(),this.$textarea.append("<option value=''></option>");var t=null,a=(this.originalValue+"").split(vgse_editor_settings.taxonomy_terms_separator).map(function(e){return e.trim()});if(e.data&&e.data.length)for(var n=0;n<e.data.length;n++)(t=jQuery("<option />")).attr("value",e.data[n].id),t.html(e.data[n].label),-1<a.indexOf(e.data[n].id+"")&&t.attr("selected",!0),this.$textarea.append(t);jQuery(this.TEXTAREA_PARENT).find(".chosen-container").length&&this.$textarea.chosen("destroy"),this.$textarea.chosen(e);var r=this;setTimeout(function(){r.$textarea.on("change",function(){this.cellProperties.chosenOptions.multiple||(this.close(),this.finishEditing())}.bind(r)),r.$textarea.on("chosen:hiding_dropdown",function(){this.cellProperties.chosenOptions.multiple||(this.close(),this.finishEditing())}.bind(r)),r.$textarea.trigger("chosen:open"),jQuery(r.TEXTAREA_PARENT).find("input").on("keydown",function(e){if(e.keyCode===s.helper.KEY_CODES.ENTER&&(jQuery(this).val()?(e.preventDefault(),e.stopPropagation()):(e.preventDefault(),e.stopPropagation(),r.close(),r.finishEditing())),e.keyCode===s.helper.KEY_CODES.BACKSPACE){var t=jQuery(r.TEXTAREA_PARENT).find("input").val();jQuery(r.TEXTAREA_PARENT).find("input").val(t.substr(0,t.length-1)).trigger("keyup.chosen"),e.preventDefault(),e.stopPropagation()}e.keyCode!==s.helper.KEY_CODES.ARROW_DOWN&&e.keyCode!==s.helper.KEY_CODES.ARROW_UP||(e.preventDefault(),e.stopPropagation())}),setTimeout(function(){if(r.$textarea.trigger("chosen:activate").focus(),o&&o.keyCode&&113!=o.keyCode){var e=o.keyCode,t=String.fromCharCode(96<=e&&e<=105?e-48:e).toLowerCase();jQuery(r.TEXTAREA_PARENT).find("input").val(t).trigger("keyup.chosen"),r.$textarea.trigger("chosen:activate")}},1)},1)},e.prototype.init=function(){s.editors.TextEditor.prototype.init.apply(this,arguments)},e.prototype.close=function(){this.instance.listen(),this.instance.removeHook("beforeKeyDown",i),this.$textarea.off(),this.$textarea.hide(),s.editors.TextEditor.prototype.close.apply(this,arguments)},e.prototype.getValue=function(){return this.$textarea.val()?"object"==typeof this.$textarea.val()?this.$textarea.val().join(vgse_editor_settings.taxonomy_terms_separator):this.$textarea.val():""},e.prototype.focus=function(){this.instance.listen()},e.prototype.beginEditing=function(e){var t=this.instance.getSettings().onBeginEditing;t&&!1===t()||s.editors.TextEditor.prototype.beginEditing.apply(this,arguments)},e.prototype.finishEditing=function(e,t){return this.instance.listen(),s.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},s.editors.ChosenEditor=e,s.editors.registerEditor("chosen",e)}(Handsontable);